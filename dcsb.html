<input class="tab-radio" type="radio" name="attr_sheet_tab" value="character" checked="checked" id="tab_character"/><input class="tab-radio" type="radio" name="attr_sheet_tab" value="crew" id="tab_crew"/><input class="tab-radio" type="radio" name="attr_sheet_tab" value="factions" id="tab_factions"/><div class="charsheet"><div class="header"><div class="title-banner"><div class="banner-frame"><div class="banner-content"><pre class="block-letters"><span class="accent">██████╗</span>  <span class="accent">██████╗</span>   <span class="comma">░░░</span>   <span class="accent">███████╗</span> <span class="accent">██████╗</span>
<span class="accent">██╔══██╗</span><span class="accent">██╔════╝</span>   <span class="comma">░░░</span>   <span class="accent">██╔════╝</span> <span class="accent">██╔══██╗</span>
<span class="accent">██║  ██║</span><span class="accent">██║</span>       <span class="comma">─────</span>  <span class="accent">███████╗</span> <span class="accent">██████╔╝</span>
<span class="accent">██║  ██║</span><span class="accent">██║</span>        <span class="comma">░░░</span>   <span class="accent">╚════██║</span> <span class="accent">██╔══██╗</span>
<span class="accent">██████╔╝</span> <span class="accent">╚██████╗</span>  <span class="comma">░░░</span>   <span class="accent">███████║</span> <span class="accent">██████╔╝</span>
<span class="accent">╚═════╝</span>   <span class="accent">╚═════╝</span>  <span class="comma">░░░</span>   <span class="accent">╚══════╝</span> <span class="accent">╚═════╝</span></pre><div class="title-text"><span class="decoration">░▒▓█</span><span class="title">DARK CITY</span><span class="comma">,</span><span class="title">SHINING BABEL</span><span class="decoration">█▓▒░</span></div></div><div class="status-bar"><span class="system-text">> SYSTEM://BABEL/RUNNER_DOSSIER.SYS</span><span class="status">■ CONNECTED</span></div></div></div><div class="tab-nav"><label class="tab-button" for="tab_character"><span class="tab-text" data-i18n="CHARACTER">CHARACTER</span></label><label class="tab-button" for="tab_crew"><span class="tab-text" data-i18n="CREW">CREW</span></label><label class="tab-button" for="tab_factions"><span class="tab-text" data-i18n="FACTIONS">FACTIONS</span></label></div><div class="roll-context-row"><div class="context-group position-group"><span class="context-label">POS</span><div class="context-options"><input class="fakeradio" type="radio" name="attr_roll_position" value="controlled" id="pos_controlled"/><label class="context-btn pos-controlled" for="pos_controlled">C</label><input class="fakeradio" type="radio" name="attr_roll_position" value="risky" checked="checked" id="pos_risky"/><label class="context-btn pos-risky" for="pos_risky">R</label><input class="fakeradio" type="radio" name="attr_roll_position" value="desperate" id="pos_desperate"/><label class="context-btn pos-desperate" for="pos_desperate">D</label></div></div><div class="context-group effect-group"><span class="context-label">EFF</span><div class="context-options"><input class="fakeradio" type="radio" name="attr_roll_effect" value="limited" id="eff_limited"/><label class="context-btn eff-limited" for="eff_limited">L</label><input class="fakeradio" type="radio" name="attr_roll_effect" value="standard" checked="checked" id="eff_standard"/><label class="context-btn eff-standard" for="eff_standard">S</label><input class="fakeradio" type="radio" name="attr_roll_effect" value="great" id="eff_great"/><label class="context-btn eff-great" for="eff_great">G</label></div></div><div class="context-group modifier-group"><span class="context-label">DICE</span><div class="context-options"><input class="fakeradio" type="radio" name="attr_roll_modifier" value="-1" id="mod_neg1"/><label class="context-btn mod-btn" for="mod_neg1">-1</label><input class="fakeradio" type="radio" name="attr_roll_modifier" value="0" checked="checked" id="mod_0"/><label class="context-btn mod-btn mod-zero" for="mod_0">0</label><input class="fakeradio" type="radio" name="attr_roll_modifier" value="1" id="mod_1"/><label class="context-btn mod-btn" for="mod_1">+1</label><input class="fakeradio" type="radio" name="attr_roll_modifier" value="2" id="mod_2"/><label class="context-btn mod-btn" for="mod_2">+2</label><input class="fakeradio" type="radio" name="attr_roll_modifier" value="3" id="mod_3"/><label class="context-btn mod-btn" for="mod_3">+3</label><input class="fakeradio" type="radio" name="attr_roll_modifier" value="4" id="mod_4"/><label class="context-btn mod-btn" for="mod_4">+4</label><input class="fakeradio" type="radio" name="attr_roll_modifier" value="5" id="mod_5"/><label class="context-btn mod-btn" for="mod_5">+5</label></div></div><div class="context-group fortune-group"><button class="fortune-btn" type="action" name="act_fortune_roll"><span>FORTUNE</span></button></div></div></div><div class="tab-content character-content"><div class="sheet-columns"><div class="left-column"><div class="section identity"><input class="section-edit-toggle" type="checkbox" name="attr_edit_identity" id="edit_identity"/><div class="section-header"><div class="section-stamp">SUBJECT IDENTIFICATION</div><div class="section-number-group"><div class="section-number">01</div><label class="section-edit-btn" for="edit_identity" title="Edit this section">✎</label></div></div><div class="display identity-display"><div class="identity-name-line"><span class="char-name" name="attr_character_name"></span><span class="alias-wrapper"><span class="quote">"</span><span class="alias-value" name="attr_alias"></span><span class="quote">"</span></span></div><span class="identity-look" name="attr_look"></span><div class="identity-classification"><span class="playbook-value" name="attr_playbook"></span><span class="sep">|</span><div class="classification-item"><span class="heritage-value" name="attr_heritage"></span><span class="item-detail" name="attr_heritage_detail"></span></div><span class="sep">|</span><div class="classification-item"><span class="background-value" name="attr_background"></span><span class="item-detail" name="attr_background_detail"></span></div></div><div class="identity-vice"><div class="vice-header"><span class="vice-label">VICE:</span><span class="vice-type-value" name="attr_vice_type"></span></div><div class="vice-body"><span class="vice-purveyor-value" name="attr_vice_purveyor"></span><span class="vice-details-value" name="attr_vice_details"></span></div></div></div><div class="edit identity-grid"><div class="identity-row primary"><label class="text-input"><input type="text" name="attr_character_name"/><div class="label" data-i18n="LEGAL_NAME"></div></label><label class="text-input"><input type="text" name="attr_alias"/><div class="label" data-i18n="ALIAS"></div></label></div><div class="identity-row secondary"><label class="text-input"><input type="text" name="attr_look"/><div class="label" data-i18n="PHYSICAL_DESCRIPTION"></div></label></div><div class="identity-row classification"><div class="select-field"><label><span class="field-label" data-i18n="PLAYBOOK">Playbook</span><select name="attr_playbook"><option value="">--</option><option value="face" data-i18n="FACE">Face</option><option value="fixer" data-i18n="FIXER">Fixer</option><option value="hacker" data-i18n="HACKER">Hacker</option><option value="midnighter" data-i18n="MIDNIGHTER">MidNighter</option><option value="murk" data-i18n="MURK">Murk</option><option value="street_warrior" data-i18n="STREET_WARRIOR">Street Warrior</option></select></label></div><div class="select-field with-detail"><label><span class="field-label" data-i18n="HERITAGE">Heritage</span><select name="attr_heritage"><option value="">--</option><option value="babel" data-i18n="BABEL">Babel</option><option value="sub_cities" data-i18n="SUB_CITIES">Sub Cities</option><option value="the_well" data-i18n="THE_WELL">The Well</option><option value="the_jungle" data-i18n="THE_JUNGLE">The Jungle</option><option value="the_syndicate" data-i18n="THE_SYNDICATE">The Syndicate</option><option value="labor_colonies" data-i18n="LABOR_COLONIES">Labor Colonies</option></select></label><input class="detail-input" type="text" name="attr_heritage_detail" placeholder="e.g. political dissident"/></div><div class="select-field with-detail"><label><span class="field-label" data-i18n="BACKGROUND">Background</span><select name="attr_background"><option value="">--</option><option value="entertainment" data-i18n="ENTERTAINMENT">Entertainment</option><option value="law" data-i18n="LAW">Law</option><option value="labor" data-i18n="LABOR">Labor</option><option value="corporate" data-i18n="CORPORATE">Corporate</option><option value="underworld" data-i18n="UNDERWORLD">Underworld</option><option value="fringe" data-i18n="FRINGE">Fringe</option></select></label><input class="detail-input" type="text" name="attr_background_detail" placeholder="e.g. hydroponics farmer"/></div></div><div class="identity-row vice-row"><div class="select-field vice-type-field"><label><span class="field-label">Vice</span><select name="attr_vice_type"><option value="">--</option><option value="Faith">Faith</option><option value="Gambling">Gambling</option><option value="Luxury">Luxury</option><option value="Obligation">Obligation</option><option value="Pleasure">Pleasure</option><option value="Stupor">Stupor</option><option value="Weird">Weird</option></select></label></div><label class="text-input"><input type="text" name="attr_vice_purveyor"/><div class="label" data-i18n="PURVEYOR"></div></label><label class="text-input"><input type="text" name="attr_vice_details"/><div class="label" data-i18n="DETAILS"></div></label></div><div class="identity-row reset-row"><button class="reset-btn" type="action" name="act_reset_to_playbook">Reset to Playbook Defaults</button><span class="reset-hint">Clears items, abilities, and actions</span></div></div><div class="vice-action"><button class="vice-roll-btn" type="action" name="act_indulge_vice">Indulge Vice</button><span class="vice-hint">Clears mental harm</span></div></div><div class="section condition"><div class="section-header"><div class="section-stamp">CONDITION REPORT</div><div class="section-number">03</div></div><div class="condition-tracks"><div class="stress-block"><div class="track-label" data-i18n="STRESS">STRESS</div><div class="stress-track"><input class="fakeradio zero" type="checkbox" name="attr_stress" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_stress" value="1" id="stress_1"/><label class="stress-box" for="stress_1"></label><input class="fakeradio" type="checkbox" name="attr_stress" value="2" id="stress_2"/><label class="stress-box" for="stress_2"></label><input class="fakeradio" type="checkbox" name="attr_stress" value="3" id="stress_3"/><label class="stress-box" for="stress_3"></label><input class="fakeradio" type="checkbox" name="attr_stress" value="4" id="stress_4"/><label class="stress-box" for="stress_4"></label><input class="fakeradio" type="checkbox" name="attr_stress" value="5" id="stress_5"/><label class="stress-box" for="stress_5"></label><input class="fakeradio" type="checkbox" name="attr_stress" value="6" id="stress_6"/><label class="stress-box" for="stress_6"></label><input class="fakeradio" type="checkbox" name="attr_stress" value="7" id="stress_7"/><label class="stress-box" for="stress_7"></label><input class="fakeradio" type="checkbox" name="attr_stress" value="8" id="stress_8"/><label class="stress-box" for="stress_8"></label><input class="fakeradio" type="checkbox" name="attr_stress" value="9" id="stress_9"/><label class="stress-box" for="stress_9"></label></div></div><div class="trauma-block"><div class="track-label" data-i18n="TRAUMA">TRAUMA</div><div class="trauma-track"><input class="fakeradio zero" type="checkbox" name="attr_trauma" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_trauma" value="1" id="trauma_1"/><label class="trauma-box" for="trauma_1"></label><input class="fakeradio" type="checkbox" name="attr_trauma" value="2" id="trauma_2"/><label class="trauma-box" for="trauma_2"></label><input class="fakeradio" type="checkbox" name="attr_trauma" value="3" id="trauma_3"/><label class="trauma-box" for="trauma_3"></label><input class="fakeradio" type="checkbox" name="attr_trauma" value="4" id="trauma_4"/><label class="trauma-box" for="trauma_4"></label></div></div></div><div class="trauma-conditions-row"><input class="trauma-conditions-input" type="text" name="attr_trauma_conditions" placeholder="Trauma conditions..."/></div><div class="harm-section"><div class="harm-header"><div class="track-label" data-i18n="HARM">HARM</div><div class="healing-gauge-group"><button class="healing-label" type="action" name="act_roll_healing" title="Roll healing">RECOVERY</button><div class="healing-gauge"><input class="fakeradio zero" type="checkbox" name="attr_healing" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_healing" value="1" id="healing_1"/><label class="healing-segment" for="healing_1"></label><input class="fakeradio" type="checkbox" name="attr_healing" value="2" id="healing_2"/><label class="healing-segment" for="healing_2"></label><input class="fakeradio" type="checkbox" name="attr_healing" value="3" id="healing_3"/><label class="healing-segment" for="healing_3"></label><input class="fakeradio" type="checkbox" name="attr_healing" value="4" id="healing_4"/><label class="healing-segment" for="healing_4"></label></div></div></div><div class="harm-track"><div class="harm-level severe"><div class="level-indicator"><span class="level-num">3</span><span class="level-label">SEVERE</span></div><input class="harm-input" type="text" name="attr_harm_3" placeholder="Need Help"/></div><div class="harm-level moderate"><div class="level-indicator"><span class="level-num">2</span><span class="level-label">MODERATE</span></div><div class="harm-inputs"><input class="harm-input" type="text" name="attr_harm_2a" placeholder="-1d"/><input class="harm-input" type="text" name="attr_harm_2b" placeholder="-1d"/></div></div><div class="harm-level lesser"><div class="level-indicator"><span class="level-num">1</span><span class="level-label">LESSER</span></div><div class="harm-inputs"><input class="harm-input" type="text" name="attr_harm_1a" placeholder="Less Effect"/><input class="harm-input" type="text" name="attr_harm_1b" placeholder="Less Effect"/></div></div></div></div><div class="armor-row"><div class="track-label" data-i18n="ARMOR">ARMOR</div><div class="armor-track"><label class="armor-checkbox"><input type="checkbox" name="attr_armor" value="1"/><span class="armor-box"></span><span>Armor</span></label><label class="armor-checkbox"><input type="checkbox" name="attr_heavy_armor" value="1"/><span class="armor-box"></span><span>+Heavy</span></label><label class="armor-checkbox"><input type="checkbox" name="attr_special_armor" value="1"/><span class="armor-box"></span><span>Special</span></label></div></div><div class="finances-row"><div class="coin-block"><div class="track-label">COIN</div><div class="coin-track"><input class="fakeradio zero" type="checkbox" name="attr_coin" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_coin" value="1" id="coin_1"/><label class="coin-box" for="coin_1"></label><input class="fakeradio" type="checkbox" name="attr_coin" value="2" id="coin_2"/><label class="coin-box" for="coin_2"></label><input class="fakeradio" type="checkbox" name="attr_coin" value="3" id="coin_3"/><label class="coin-box" for="coin_3"></label><input class="fakeradio" type="checkbox" name="attr_coin" value="4" id="coin_4"/><label class="coin-box" for="coin_4"></label></div><span class="coin-warning" title="&gt;4 coin = +1 heat at end of downtime">⚠</span></div><div class="stash-block"><div class="track-label">STASH</div><div class="stash-track"><input class="fakeradio zero" type="checkbox" name="attr_stash" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_stash" value="1" id="stash_1"/><label class="stash-box" for="stash_1"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="2" id="stash_2"/><label class="stash-box" for="stash_2"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="3" id="stash_3"/><label class="stash-box" for="stash_3"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="4" id="stash_4"/><label class="stash-box" for="stash_4"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="5" id="stash_5"/><label class="stash-box" for="stash_5"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="6" id="stash_6"/><label class="stash-box" for="stash_6"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="7" id="stash_7"/><label class="stash-box" for="stash_7"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="8" id="stash_8"/><label class="stash-box" for="stash_8"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="9" id="stash_9"/><label class="stash-box" for="stash_9"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="10" id="stash_10"/><label class="stash-box" for="stash_10"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="11" id="stash_11"/><label class="stash-box" for="stash_11"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="12" id="stash_12"/><label class="stash-box" for="stash_12"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="13" id="stash_13"/><label class="stash-box" for="stash_13"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="14" id="stash_14"/><label class="stash-box" for="stash_14"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="15" id="stash_15"/><label class="stash-box" for="stash_15"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="16" id="stash_16"/><label class="stash-box" for="stash_16"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="17" id="stash_17"/><label class="stash-box" for="stash_17"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="18" id="stash_18"/><label class="stash-box" for="stash_18"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="19" id="stash_19"/><label class="stash-box" for="stash_19"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="20" id="stash_20"/><label class="stash-box" for="stash_20"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="21" id="stash_21"/><label class="stash-box" for="stash_21"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="22" id="stash_22"/><label class="stash-box" for="stash_22"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="23" id="stash_23"/><label class="stash-box" for="stash_23"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="24" id="stash_24"/><label class="stash-box" for="stash_24"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="25" id="stash_25"/><label class="stash-box" for="stash_25"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="26" id="stash_26"/><label class="stash-box" for="stash_26"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="27" id="stash_27"/><label class="stash-box" for="stash_27"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="28" id="stash_28"/><label class="stash-box" for="stash_28"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="29" id="stash_29"/><label class="stash-box" for="stash_29"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="30" id="stash_30"/><label class="stash-box" for="stash_30"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="31" id="stash_31"/><label class="stash-box" for="stash_31"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="32" id="stash_32"/><label class="stash-box" for="stash_32"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="33" id="stash_33"/><label class="stash-box" for="stash_33"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="34" id="stash_34"/><label class="stash-box" for="stash_34"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="35" id="stash_35"/><label class="stash-box" for="stash_35"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="36" id="stash_36"/><label class="stash-box" for="stash_36"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="37" id="stash_37"/><label class="stash-box" for="stash_37"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="38" id="stash_38"/><label class="stash-box" for="stash_38"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="39" id="stash_39"/><label class="stash-box" for="stash_39"></label><input class="fakeradio" type="checkbox" name="attr_stash" value="40" id="stash_40"/><label class="stash-box" for="stash_40"></label></div><div class="lifestyle-markers"><span class="marker" data-tier="0">Gutter</span><span class="marker" data-tier="1">Meager</span><span class="marker" data-tier="2">Modest</span><span class="marker" data-tier="3">Fine</span></div></div></div></div><div class="section augments"><input class="section-edit-toggle" type="checkbox" name="attr_edit_augment" id="edit_augment"/><div class="section-header"><div class="section-stamp">AUGMENTATION RECORD</div><div class="section-number-group"><div class="section-number">04</div><label class="section-edit-btn" for="edit_augment" title="Edit this section">✎</label></div></div><div class="augment-maintenance"><div class="maintenance-header"><button class="maintenance-label" type="action" name="act_roll_maintenance" title="Roll maintenance failure">MAINTENANCE</button><span class="bc-owed"><span class="bc-value" name="attr_maintenance_clocks">0</span><span> BC</span></span></div><div class="maintenance-gauge"><input class="fakeradio zero" type="checkbox" name="attr_maintenance_ticks" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="1" id="maintenance_ticks_1"/><label class="maint-segment" for="maintenance_ticks_1"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="2" id="maintenance_ticks_2"/><label class="maint-segment" for="maintenance_ticks_2"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="3" id="maintenance_ticks_3"/><label class="maint-segment" for="maintenance_ticks_3"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="4" id="maintenance_ticks_4"/><label class="maint-segment" for="maintenance_ticks_4"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="5" id="maintenance_ticks_5"/><label class="maint-segment" for="maintenance_ticks_5"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="6" id="maintenance_ticks_6"/><label class="maint-segment" for="maintenance_ticks_6"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="7" id="maintenance_ticks_7"/><label class="maint-segment" for="maintenance_ticks_7"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="8" id="maintenance_ticks_8"/><label class="maint-segment" for="maintenance_ticks_8"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="9" id="maintenance_ticks_9"/><label class="maint-segment" for="maintenance_ticks_9"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="10" id="maintenance_ticks_10"/><label class="maint-segment" for="maintenance_ticks_10"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="11" id="maintenance_ticks_11"/><label class="maint-segment" for="maintenance_ticks_11"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="12" id="maintenance_ticks_12"/><label class="maint-segment" for="maintenance_ticks_12"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="13" id="maintenance_ticks_13"/><label class="maint-segment" for="maintenance_ticks_13"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="14" id="maintenance_ticks_14"/><label class="maint-segment" for="maintenance_ticks_14"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="15" id="maintenance_ticks_15"/><label class="maint-segment" for="maintenance_ticks_15"></label><input class="fakeradio" type="checkbox" name="attr_maintenance_ticks" value="16" id="maintenance_ticks_16"/><label class="maint-segment" for="maintenance_ticks_16"></label></div></div><fieldset class="repeating_augments"><div class="augment-entry"><label class="augment-installed"><input class="augment-check" type="checkbox" name="attr_augment_installed" value="1"/><span class="installed-box"></span></label><div class="augment-content"><div class="display augment-display"><div class="augment-header-display"><span class="augment-tier-badge"><span>T</span><span class="augment-tier-value" name="attr_augment_tier"></span></span><span class="augment-name-display" name="attr_augment_name"></span></div><span class="augment-desc-display" name="attr_augment_desc"></span></div><div class="edit augment-edit"><div class="augment-header-edit"><div class="augment-tier-select"><select name="attr_augment_tier"><option value="2">T2</option><option value="3">T3</option><option value="4">T4</option><option value="5">T5</option></select></div><input class="augment-name" type="text" name="attr_augment_name" placeholder="Augment Name"/></div><textarea class="augment-desc" name="attr_augment_desc" placeholder="Description &amp; effects - what does this augment let you do?"></textarea></div></div></div></fieldset></div><div class="section friends"><input class="section-edit-toggle" type="checkbox" name="attr_edit_friends" id="edit_friends"/><div class="section-header"><div class="section-stamp">FRIENDS &amp; RIVALS</div><div class="section-number-group"><div class="section-number">06</div><label class="section-edit-btn" for="edit_friends" title="Edit this section">✎</label></div></div><div class="friends-intro">Mark one ↑ as your Friend, one ↓ as your Rival</div><div class="friends-list"><div class="friend-card"><div class="friend-relation"><label class="relation-option relation-friend" title="Friend"><input type="radio" name="attr_friend_1_relation" value="friend"/><span class="relation-badge">↑</span></label><label class="relation-option relation-neutral" title="Neutral"><input type="radio" name="attr_friend_1_relation" value="neutral" checked="checked"/><span class="relation-badge">○</span></label><label class="relation-option relation-rival" title="Rival"><input type="radio" name="attr_friend_1_relation" value="rival"/><span class="relation-badge">↓</span></label></div><div class="friend-display display"><span class="friend-name" name="attr_friend_1_name"></span><span class="friend-desc" name="attr_friend_1_desc"></span></div><div class="friend-edit edit"><input class="friend-name-input" type="text" name="attr_friend_1_name" placeholder="Contact name"/><input class="friend-desc-input" type="text" name="attr_friend_1_desc" placeholder="Role / description"/></div></div><div class="friend-card"><div class="friend-relation"><label class="relation-option relation-friend" title="Friend"><input type="radio" name="attr_friend_2_relation" value="friend"/><span class="relation-badge">↑</span></label><label class="relation-option relation-neutral" title="Neutral"><input type="radio" name="attr_friend_2_relation" value="neutral" checked="checked"/><span class="relation-badge">○</span></label><label class="relation-option relation-rival" title="Rival"><input type="radio" name="attr_friend_2_relation" value="rival"/><span class="relation-badge">↓</span></label></div><div class="friend-display display"><span class="friend-name" name="attr_friend_2_name"></span><span class="friend-desc" name="attr_friend_2_desc"></span></div><div class="friend-edit edit"><input class="friend-name-input" type="text" name="attr_friend_2_name" placeholder="Contact name"/><input class="friend-desc-input" type="text" name="attr_friend_2_desc" placeholder="Role / description"/></div></div><div class="friend-card"><div class="friend-relation"><label class="relation-option relation-friend" title="Friend"><input type="radio" name="attr_friend_3_relation" value="friend"/><span class="relation-badge">↑</span></label><label class="relation-option relation-neutral" title="Neutral"><input type="radio" name="attr_friend_3_relation" value="neutral" checked="checked"/><span class="relation-badge">○</span></label><label class="relation-option relation-rival" title="Rival"><input type="radio" name="attr_friend_3_relation" value="rival"/><span class="relation-badge">↓</span></label></div><div class="friend-display display"><span class="friend-name" name="attr_friend_3_name"></span><span class="friend-desc" name="attr_friend_3_desc"></span></div><div class="friend-edit edit"><input class="friend-name-input" type="text" name="attr_friend_3_name" placeholder="Contact name"/><input class="friend-desc-input" type="text" name="attr_friend_3_desc" placeholder="Role / description"/></div></div><div class="friend-card"><div class="friend-relation"><label class="relation-option relation-friend" title="Friend"><input type="radio" name="attr_friend_4_relation" value="friend"/><span class="relation-badge">↑</span></label><label class="relation-option relation-neutral" title="Neutral"><input type="radio" name="attr_friend_4_relation" value="neutral" checked="checked"/><span class="relation-badge">○</span></label><label class="relation-option relation-rival" title="Rival"><input type="radio" name="attr_friend_4_relation" value="rival"/><span class="relation-badge">↓</span></label></div><div class="friend-display display"><span class="friend-name" name="attr_friend_4_name"></span><span class="friend-desc" name="attr_friend_4_desc"></span></div><div class="friend-edit edit"><input class="friend-name-input" type="text" name="attr_friend_4_name" placeholder="Contact name"/><input class="friend-desc-input" type="text" name="attr_friend_4_desc" placeholder="Role / description"/></div></div><div class="friend-card"><div class="friend-relation"><label class="relation-option relation-friend" title="Friend"><input type="radio" name="attr_friend_5_relation" value="friend"/><span class="relation-badge">↑</span></label><label class="relation-option relation-neutral" title="Neutral"><input type="radio" name="attr_friend_5_relation" value="neutral" checked="checked"/><span class="relation-badge">○</span></label><label class="relation-option relation-rival" title="Rival"><input type="radio" name="attr_friend_5_relation" value="rival"/><span class="relation-badge">↓</span></label></div><div class="friend-display display"><span class="friend-name" name="attr_friend_5_name"></span><span class="friend-desc" name="attr_friend_5_desc"></span></div><div class="friend-edit edit"><input class="friend-name-input" type="text" name="attr_friend_5_name" placeholder="Contact name"/><input class="friend-desc-input" type="text" name="attr_friend_5_desc" placeholder="Role / description"/></div></div></div></div></div><div class="right-column"><div class="section actions"><div class="section-header"><div class="section-stamp">CAPABILITY ASSESSMENT</div><div class="section-number">02</div></div><div class="attribute-block acuity"><div class="attribute-header-row"><button class="attr-name" type="action" name="act_roll_acuity_resist" data-i18n="ACUITY">ACUITY</button><div class="attribute-track"><input class="fakeradio zero" type="checkbox" name="attr_acuity_rating" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_acuity_rating" value="1" id="acuity_rating_1"/><label class="attr-dot" for="acuity_rating_1"></label><input class="fakeradio" type="checkbox" name="attr_acuity_rating" value="2" id="acuity_rating_2"/><label class="attr-dot" for="acuity_rating_2"></label><input class="fakeradio" type="checkbox" name="attr_acuity_rating" value="3" id="acuity_rating_3"/><label class="attr-dot" for="acuity_rating_3"></label><input class="fakeradio" type="checkbox" name="attr_acuity_rating" value="4" id="acuity_rating_4"/><label class="attr-dot" for="acuity_rating_4"></label></div></div><div class="action-list"><div class="action-row"><button class="action-name" type="action" name="act_roll_hack" data-i18n="HACK"></button><div class="action-dots"><input class="fakeradio zero" type="checkbox" name="attr_hack" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_hack" value="1" id="hack_1"/><label class="dot" for="hack_1"></label><input class="fakeradio" type="checkbox" name="attr_hack" value="2" id="hack_2"/><label class="dot" for="hack_2"></label><input class="fakeradio" type="checkbox" name="attr_hack" value="3" id="hack_3"/><label class="dot" for="hack_3"></label><input class="fakeradio" type="checkbox" name="attr_hack" value="4" id="hack_4"/><label class="dot" for="hack_4"></label></div></div><div class="action-row"><button class="action-name" type="action" name="act_roll_recon" data-i18n="RECON"></button><div class="action-dots"><input class="fakeradio zero" type="checkbox" name="attr_recon" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_recon" value="1" id="recon_1"/><label class="dot" for="recon_1"></label><input class="fakeradio" type="checkbox" name="attr_recon" value="2" id="recon_2"/><label class="dot" for="recon_2"></label><input class="fakeradio" type="checkbox" name="attr_recon" value="3" id="recon_3"/><label class="dot" for="recon_3"></label><input class="fakeradio" type="checkbox" name="attr_recon" value="4" id="recon_4"/><label class="dot" for="recon_4"></label></div></div><div class="action-row"><button class="action-name" type="action" name="act_roll_scrutinize" data-i18n="SCRUTINIZE"></button><div class="action-dots"><input class="fakeradio zero" type="checkbox" name="attr_scrutinize" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_scrutinize" value="1" id="scrutinize_1"/><label class="dot" for="scrutinize_1"></label><input class="fakeradio" type="checkbox" name="attr_scrutinize" value="2" id="scrutinize_2"/><label class="dot" for="scrutinize_2"></label><input class="fakeradio" type="checkbox" name="attr_scrutinize" value="3" id="scrutinize_3"/><label class="dot" for="scrutinize_3"></label><input class="fakeradio" type="checkbox" name="attr_scrutinize" value="4" id="scrutinize_4"/><label class="dot" for="scrutinize_4"></label></div></div><div class="action-row"><button class="action-name" type="action" name="act_roll_tamper" data-i18n="TAMPER"></button><div class="action-dots"><input class="fakeradio zero" type="checkbox" name="attr_tamper" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_tamper" value="1" id="tamper_1"/><label class="dot" for="tamper_1"></label><input class="fakeradio" type="checkbox" name="attr_tamper" value="2" id="tamper_2"/><label class="dot" for="tamper_2"></label><input class="fakeradio" type="checkbox" name="attr_tamper" value="3" id="tamper_3"/><label class="dot" for="tamper_3"></label><input class="fakeradio" type="checkbox" name="attr_tamper" value="4" id="tamper_4"/><label class="dot" for="tamper_4"></label></div></div></div></div><div class="attribute-block grit"><div class="attribute-header-row"><button class="attr-name" type="action" name="act_roll_grit_resist" data-i18n="GRIT">GRIT</button><div class="attribute-track"><input class="fakeradio zero" type="checkbox" name="attr_grit_rating" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_grit_rating" value="1" id="grit_rating_1"/><label class="attr-dot" for="grit_rating_1"></label><input class="fakeradio" type="checkbox" name="attr_grit_rating" value="2" id="grit_rating_2"/><label class="attr-dot" for="grit_rating_2"></label><input class="fakeradio" type="checkbox" name="attr_grit_rating" value="3" id="grit_rating_3"/><label class="attr-dot" for="grit_rating_3"></label><input class="fakeradio" type="checkbox" name="attr_grit_rating" value="4" id="grit_rating_4"/><label class="attr-dot" for="grit_rating_4"></label></div></div><div class="action-list"><div class="action-row"><button class="action-name" type="action" name="act_roll_brawl" data-i18n="BRAWL"></button><div class="action-dots"><input class="fakeradio zero" type="checkbox" name="attr_brawl" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_brawl" value="1" id="brawl_1"/><label class="dot" for="brawl_1"></label><input class="fakeradio" type="checkbox" name="attr_brawl" value="2" id="brawl_2"/><label class="dot" for="brawl_2"></label><input class="fakeradio" type="checkbox" name="attr_brawl" value="3" id="brawl_3"/><label class="dot" for="brawl_3"></label><input class="fakeradio" type="checkbox" name="attr_brawl" value="4" id="brawl_4"/><label class="dot" for="brawl_4"></label></div></div><div class="action-row"><button class="action-name" type="action" name="act_roll_hunt" data-i18n="HUNT"></button><div class="action-dots"><input class="fakeradio zero" type="checkbox" name="attr_hunt" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_hunt" value="1" id="hunt_1"/><label class="dot" for="hunt_1"></label><input class="fakeradio" type="checkbox" name="attr_hunt" value="2" id="hunt_2"/><label class="dot" for="hunt_2"></label><input class="fakeradio" type="checkbox" name="attr_hunt" value="3" id="hunt_3"/><label class="dot" for="hunt_3"></label><input class="fakeradio" type="checkbox" name="attr_hunt" value="4" id="hunt_4"/><label class="dot" for="hunt_4"></label></div></div><div class="action-row"><button class="action-name" type="action" name="act_roll_skulk" data-i18n="SKULK"></button><div class="action-dots"><input class="fakeradio zero" type="checkbox" name="attr_skulk" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_skulk" value="1" id="skulk_1"/><label class="dot" for="skulk_1"></label><input class="fakeradio" type="checkbox" name="attr_skulk" value="2" id="skulk_2"/><label class="dot" for="skulk_2"></label><input class="fakeradio" type="checkbox" name="attr_skulk" value="3" id="skulk_3"/><label class="dot" for="skulk_3"></label><input class="fakeradio" type="checkbox" name="attr_skulk" value="4" id="skulk_4"/><label class="dot" for="skulk_4"></label></div></div><div class="action-row"><button class="action-name" type="action" name="act_roll_vandalize" data-i18n="VANDALIZE"></button><div class="action-dots"><input class="fakeradio zero" type="checkbox" name="attr_vandalize" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_vandalize" value="1" id="vandalize_1"/><label class="dot" for="vandalize_1"></label><input class="fakeradio" type="checkbox" name="attr_vandalize" value="2" id="vandalize_2"/><label class="dot" for="vandalize_2"></label><input class="fakeradio" type="checkbox" name="attr_vandalize" value="3" id="vandalize_3"/><label class="dot" for="vandalize_3"></label><input class="fakeradio" type="checkbox" name="attr_vandalize" value="4" id="vandalize_4"/><label class="dot" for="vandalize_4"></label></div></div></div></div><div class="attribute-block resolve"><div class="attribute-header-row"><button class="attr-name" type="action" name="act_roll_resolve_resist" data-i18n="RESOLVE">RESOLVE</button><div class="attribute-track"><input class="fakeradio zero" type="checkbox" name="attr_resolve_rating" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_resolve_rating" value="1" id="resolve_rating_1"/><label class="attr-dot" for="resolve_rating_1"></label><input class="fakeradio" type="checkbox" name="attr_resolve_rating" value="2" id="resolve_rating_2"/><label class="attr-dot" for="resolve_rating_2"></label><input class="fakeradio" type="checkbox" name="attr_resolve_rating" value="3" id="resolve_rating_3"/><label class="attr-dot" for="resolve_rating_3"></label><input class="fakeradio" type="checkbox" name="attr_resolve_rating" value="4" id="resolve_rating_4"/><label class="attr-dot" for="resolve_rating_4"></label></div></div><div class="action-list"><div class="action-row"><button class="action-name" type="action" name="act_roll_consort" data-i18n="CONSORT"></button><div class="action-dots"><input class="fakeradio zero" type="checkbox" name="attr_consort" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_consort" value="1" id="consort_1"/><label class="dot" for="consort_1"></label><input class="fakeradio" type="checkbox" name="attr_consort" value="2" id="consort_2"/><label class="dot" for="consort_2"></label><input class="fakeradio" type="checkbox" name="attr_consort" value="3" id="consort_3"/><label class="dot" for="consort_3"></label><input class="fakeradio" type="checkbox" name="attr_consort" value="4" id="consort_4"/><label class="dot" for="consort_4"></label></div></div><div class="action-row"><button class="action-name" type="action" name="act_roll_dominate" data-i18n="DOMINATE"></button><div class="action-dots"><input class="fakeradio zero" type="checkbox" name="attr_dominate" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_dominate" value="1" id="dominate_1"/><label class="dot" for="dominate_1"></label><input class="fakeradio" type="checkbox" name="attr_dominate" value="2" id="dominate_2"/><label class="dot" for="dominate_2"></label><input class="fakeradio" type="checkbox" name="attr_dominate" value="3" id="dominate_3"/><label class="dot" for="dominate_3"></label><input class="fakeradio" type="checkbox" name="attr_dominate" value="4" id="dominate_4"/><label class="dot" for="dominate_4"></label></div></div><div class="action-row"><button class="action-name" type="action" name="act_roll_finesse" data-i18n="FINESSE"></button><div class="action-dots"><input class="fakeradio zero" type="checkbox" name="attr_finesse" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_finesse" value="1" id="finesse_1"/><label class="dot" for="finesse_1"></label><input class="fakeradio" type="checkbox" name="attr_finesse" value="2" id="finesse_2"/><label class="dot" for="finesse_2"></label><input class="fakeradio" type="checkbox" name="attr_finesse" value="3" id="finesse_3"/><label class="dot" for="finesse_3"></label><input class="fakeradio" type="checkbox" name="attr_finesse" value="4" id="finesse_4"/><label class="dot" for="finesse_4"></label></div></div><div class="action-row"><button class="action-name" type="action" name="act_roll_sway" data-i18n="SWAY"></button><div class="action-dots"><input class="fakeradio zero" type="checkbox" name="attr_sway" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_sway" value="1" id="sway_1"/><label class="dot" for="sway_1"></label><input class="fakeradio" type="checkbox" name="attr_sway" value="2" id="sway_2"/><label class="dot" for="sway_2"></label><input class="fakeradio" type="checkbox" name="attr_sway" value="3" id="sway_3"/><label class="dot" for="sway_3"></label><input class="fakeradio" type="checkbox" name="attr_sway" value="4" id="sway_4"/><label class="dot" for="sway_4"></label></div></div></div></div><div class="advancement-block"><div class="advancement-header"><span class="advancement-label">ADVANCEMENT</span><span class="advancement-hint">(1 XP each, or 2 if a lot)</span></div><div class="xp-triggers-list"><div class="xp-trigger-item"><span class="xp-trigger-bullet">▸</span><span class="xp-trigger-text" name="attr_xp_trigger"></span></div><div class="xp-trigger-item"><span class="xp-trigger-bullet">▸</span><span class="xp-trigger-static">You expressed your beliefs, drives, heritage, or background</span></div><div class="xp-trigger-item"><span class="xp-trigger-bullet">▸</span><span class="xp-trigger-static">You struggled with issues from your vice or traumas</span></div></div><div class="advancement-clocks"><div class="adv-row"><div class="adv-clock"><input class="fakeradio zero" type="checkbox" name="attr_adv_clock_1" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_adv_clock_1" value="1" id="adv_clock_1_1"/><label class="adv-segment" for="adv_clock_1_1"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_1" value="2" id="adv_clock_1_2"/><label class="adv-segment" for="adv_clock_1_2"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_1" value="3" id="adv_clock_1_3"/><label class="adv-segment" for="adv_clock_1_3"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_1" value="4" id="adv_clock_1_4"/><label class="adv-segment" for="adv_clock_1_4"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_1" value="5" id="adv_clock_1_5"/><label class="adv-segment" for="adv_clock_1_5"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_1" value="6" id="adv_clock_1_6"/><label class="adv-segment" for="adv_clock_1_6"></label></div><div class="adv-clock"><input class="fakeradio zero" type="checkbox" name="attr_adv_clock_2" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_adv_clock_2" value="1" id="adv_clock_2_1"/><label class="adv-segment" for="adv_clock_2_1"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_2" value="2" id="adv_clock_2_2"/><label class="adv-segment" for="adv_clock_2_2"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_2" value="3" id="adv_clock_2_3"/><label class="adv-segment" for="adv_clock_2_3"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_2" value="4" id="adv_clock_2_4"/><label class="adv-segment" for="adv_clock_2_4"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_2" value="5" id="adv_clock_2_5"/><label class="adv-segment" for="adv_clock_2_5"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_2" value="6" id="adv_clock_2_6"/><label class="adv-segment" for="adv_clock_2_6"></label></div></div><div class="adv-row"><div class="adv-clock"><input class="fakeradio zero" type="checkbox" name="attr_adv_clock_3" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_adv_clock_3" value="1" id="adv_clock_3_1"/><label class="adv-segment" for="adv_clock_3_1"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_3" value="2" id="adv_clock_3_2"/><label class="adv-segment" for="adv_clock_3_2"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_3" value="3" id="adv_clock_3_3"/><label class="adv-segment" for="adv_clock_3_3"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_3" value="4" id="adv_clock_3_4"/><label class="adv-segment" for="adv_clock_3_4"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_3" value="5" id="adv_clock_3_5"/><label class="adv-segment" for="adv_clock_3_5"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_3" value="6" id="adv_clock_3_6"/><label class="adv-segment" for="adv_clock_3_6"></label></div><div class="adv-clock"><input class="fakeradio zero" type="checkbox" name="attr_adv_clock_4" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_adv_clock_4" value="1" id="adv_clock_4_1"/><label class="adv-segment" for="adv_clock_4_1"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_4" value="2" id="adv_clock_4_2"/><label class="adv-segment" for="adv_clock_4_2"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_4" value="3" id="adv_clock_4_3"/><label class="adv-segment" for="adv_clock_4_3"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_4" value="4" id="adv_clock_4_4"/><label class="adv-segment" for="adv_clock_4_4"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_4" value="5" id="adv_clock_4_5"/><label class="adv-segment" for="adv_clock_4_5"></label><input class="fakeradio" type="checkbox" name="attr_adv_clock_4" value="6" id="adv_clock_4_6"/><label class="adv-segment" for="adv_clock_4_6"></label></div></div></div><div class="advancement-costs"><div class="cost-row"><span class="cost-label">Augment/Ability</span><span class="cost-value">2</span></div><div class="cost-row"><span class="cost-label">Veteran</span><span class="cost-value">3</span></div><div class="cost-row"><span class="cost-label">Action Dot</span><span class="cost-value">= new rating</span></div></div></div></div><div class="section equipment"><input class="section-edit-toggle" type="checkbox" name="attr_edit_equipment" id="edit_equipment"/><div class="section-header"><div class="section-stamp">EQUIPMENT MANIFEST</div><div class="section-number-group"><div class="section-number">05</div><label class="section-edit-btn" for="edit_equipment" title="Edit this section">✎</label></div></div><div class="load-selector"><div class="load-label" data-i18n="LOAD">LOAD</div><div class="load-options"><label class="load-option"><input type="radio" name="attr_load" value="3"/><span class="load-box"></span><span data-i18n="LIGHT">Light (3)</span></label><label class="load-option"><input type="radio" name="attr_load" value="5" checked="checked"/><span class="load-box"></span><span data-i18n="NORMAL">Normal (5)</span></label><label class="load-option"><input type="radio" name="attr_load" value="6"/><span class="load-box"></span><span data-i18n="HEAVY">Heavy (6)</span></label></div></div><div class="load-tracker"><span class="load-current" data-i18n="CURRENT">Current:</span><input class="load-num" type="number" name="attr_load_current" value="0" readonly="readonly"/><span>/</span><input class="load-num" type="number" name="attr_load_max" value="5" readonly="readonly"/></div><div class="equipment-columns"><div class="equipment-column standard"><h4 data-i18n="STANDARD_ITEMS">Standard Items</h4><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_knife_1" value="1" id="item_knife_1"/><label class="load-box" for="item_knife_1"></label></div><span class="item-name">A knife or two</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_large_weapon_1" value="1" id="item_large_weapon_1"/><label class="load-box" for="item_large_weapon_1"></label><input type="checkbox" name="attr_item_large_weapon_2" value="1" id="item_large_weapon_2"/><label class="load-box" for="item_large_weapon_2"></label></div><span class="item-name">A large weapon</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_reload_1" value="1" id="item_reload_1"/><label class="load-box" for="item_reload_1"></label></div><span class="item-name">Reload</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_unusual_weapon_1" value="1" id="item_unusual_weapon_1"/><label class="load-box" for="item_unusual_weapon_1"></label></div><span class="item-name">An unusual weapon</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_datapad_1" value="1" id="item_datapad_1"/><label class="load-box" for="item_datapad_1"></label></div><span class="item-name">Data Pad</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_armor_1" value="1" id="item_armor_1"/><label class="load-box" for="item_armor_1"></label><input type="checkbox" name="attr_item_armor_2" value="1" id="item_armor_2"/><label class="load-box" for="item_armor_2"></label></div><span class="item-name">Armor</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_heavy_1" value="1" id="item_heavy_1"/><label class="load-box" for="item_heavy_1"></label></div><span class="item-name">+Heavy</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_infiltration_1" value="1" id="item_infiltration_1"/><label class="load-box" for="item_infiltration_1"></label></div><span class="item-name">Infiltration Gear</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_hacking_1" value="1" id="item_hacking_1"/><label class="load-box" for="item_hacking_1"></label><input type="checkbox" name="attr_item_hacking_2" value="1" id="item_hacking_2"/><label class="load-box" for="item_hacking_2"></label></div><span class="item-name">Hacking Gear</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_climbing_1" value="1" id="item_climbing_1"/><label class="load-box" for="item_climbing_1"></label><input type="checkbox" name="attr_item_climbing_2" value="1" id="item_climbing_2"/><label class="load-box" for="item_climbing_2"></label></div><span class="item-name">Climbing Gear</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_demolition_1" value="1" id="item_demolition_1"/><label class="load-box" for="item_demolition_1"></label><input type="checkbox" name="attr_item_demolition_2" value="1" id="item_demolition_2"/><label class="load-box" for="item_demolition_2"></label></div><span class="item-name">Demolition Tools</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_tampering_1" value="1" id="item_tampering_1"/><label class="load-box" for="item_tampering_1"></label></div><span class="item-name">Tampering Tools</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_subterfuge_1" value="1" id="item_subterfuge_1"/><label class="load-box" for="item_subterfuge_1"></label></div><span class="item-name">Subterfuge Supplies</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_documents_1" value="1" id="item_documents_1"/><label class="load-box" for="item_documents_1"></label></div><span class="item-name">Documents</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_flashlight_1" value="1" id="item_flashlight_1"/><label class="load-box" for="item_flashlight_1"></label></div><span class="item-name">A flashlight</span></div><div class="item-row"><div class="item-load-boxes"><input type="checkbox" name="attr_item_modification_1" value="1" id="item_modification_1"/><label class="load-box" for="item_modification_1"></label></div><span class="item-name">Modification Tools</span></div></div><div class="equipment-column playbook"><h4 data-i18n="PLAYBOOK_ITEMS">Playbook Items</h4><fieldset class="repeating_items"><div class="item-row playbook-item"><input class="item-show-load2" type="checkbox" name="attr_item_show_load_2" value="1"/><input class="item-special-flag" type="checkbox" name="attr_item_special" value="1"/><div class="item-load-boxes"><label class="load-box-label load-1"><input type="checkbox" name="attr_item_load_1" value="1"/><span class="load-box"></span></label><label class="load-box-label load-2"><input type="checkbox" name="attr_item_load_2" value="1"/><span class="load-box"></span></label></div><span class="display item-name" name="attr_item_name"></span><div class="edit item-edit"><input type="text" name="attr_item_name" placeholder="Item name"/></div></div></fieldset><input class="chipsets-toggle" type="checkbox" name="attr_show_chipsets" value="1"/><div class="chipsets-section"><h5 class="chipsets-header">Specialty Chipsets</h5><span class="chipsets-hint">Choose 3 (or 5 with Extra Chipsets)</span><div class="chipsets-list"><label class="chipset-item"><input type="checkbox" name="attr_chipset_possession" value="1"/><span class="chipset-box"></span><span class="chipset-name">Remote Possession</span><span class="chipset-desc">Take control of a machine</span></label><label class="chipset-item"><input type="checkbox" name="attr_chipset_eyes" value="1"/><span class="chipset-box"></span><span class="chipset-name">Eye Tap</span><span class="chipset-desc">See through someone else's eyes</span></label><label class="chipset-item"><input type="checkbox" name="attr_chipset_augkill" value="1"/><span class="chipset-box"></span><span class="chipset-name">Aug Killer</span><span class="chipset-desc">Disable all augments (limited range)</span></label><label class="chipset-item"><input type="checkbox" name="attr_chipset_comms" value="1"/><span class="chipset-box"></span><span class="chipset-name">Comm Tap</span><span class="chipset-desc">Monitor network communications</span></label><label class="chipset-item"><input type="checkbox" name="attr_chipset_overload" value="1"/><span class="chipset-box"></span><span class="chipset-name">Overload</span><span class="chipset-desc">Overheat or short circuit tech</span></label></div></div></div></div></div><div class="section notes"><input class="section-edit-toggle" type="checkbox" name="attr_edit_notes" id="edit_notes"/><div class="section-header"><div class="section-stamp">NOTES</div><div class="section-number-group"><div class="section-number">07</div><label class="section-edit-btn" for="edit_notes" title="Edit this section">✎</label></div></div><span class="display notes-display" name="attr_notes"></span><textarea class="edit notes-area" name="attr_notes" placeholder="Personal notes, background details, mission logs..."></textarea></div><div class="section clocks"><input class="section-edit-toggle" type="checkbox" name="attr_edit_clocks" id="edit_clocks"/><div class="section-header"><div class="section-stamp">CLOCKS</div><div class="section-number-group"><div class="section-number">08</div><label class="section-edit-btn" for="edit_clocks" title="Edit this section">✎</label></div></div><fieldset class="repeating_clocks"><div class="clock-entry"><input class="clock-show-5-6" type="checkbox" name="attr_clock_show_5_6" value="1" checked="checked"/><input class="clock-show-7-8" type="checkbox" name="attr_clock_show_7_8" value="1"/><input class="clock-show-9-10" type="checkbox" name="attr_clock_show_9_10" value="1"/><input class="clock-show-11-12" type="checkbox" name="attr_clock_show_11_12" value="1"/><div class="clock-header"><span class="display clock-name-display" name="attr_clock_name"></span><div class="edit"><input class="clock-name-input" type="text" name="attr_clock_name" placeholder="Clock name"/></div><div class="clock-size-badge"><span>[</span><span class="clock-size-value" name="attr_clock_size"></span><span>]</span></div><div class="edit clock-size-select"><select name="attr_clock_size"><option value="4">4</option><option value="6" selected="selected">6</option><option value="8">8</option><option value="10">10</option><option value="12">12</option></select></div></div><div class="clock-track"><input class="fakeradio zero" type="checkbox" name="attr_clock_value" value="0" checked="checked"/><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="1"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="2"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="3"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="4"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="5"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="6"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="7"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="8"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="9"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="10"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="11"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="12"/></label></div><span class="display clock-notes-display" name="attr_clock_notes"></span><div class="edit"><textarea class="clock-notes-input" name="attr_clock_notes" placeholder="Notes..."></textarea></div></div></fieldset></div></div></div></div><div class="tab-content crew-content"><div class="sheet-columns"><div class="left-column"><div class="section crew-identity"><div class="section-header"><div class="section-stamp">CREW IDENTIFICATION</div><div class="section-number">01</div></div><div class="crew-id-grid"><div class="crew-primary"><label class="text-input"><input type="text" name="attr_crew_name"/><div class="label" data-i18n="CREW_NAME"></div></label></div><div class="crew-classification"><div class="select-field"><label><span class="field-label" data-i18n="CREW_TYPE">Crew Type</span><select name="attr_crew_type"><option value="">--</option><option value="firebrands" data-i18n="FIREBRANDS">Firebrands</option><option value="leeches" data-i18n="LEECHES">Leeches</option><option value="runners" data-i18n="RUNNERS">Runners</option><option value="zokus" data-i18n="ZOKUS">Zokus</option></select></label></div><div class="text-field"><label><span class="field-label" data-i18n="REPUTATION">Reputation</span><input type="text" name="attr_reputation" list="reputation_list" placeholder="Ambitious, Brutal, etc."/><datalist id="reputation_list"><option value="Ambitious"></option><option value="Brutal"></option><option value="Flashy"></option><option value="Mercenary"></option><option value="Savvy"></option><option value="Strange"></option></datalist></label></div></div><div class="crew-location"><label class="text-input"><input type="text" name="attr_hunting_grounds"/><div class="label" data-i18n="HUNTING_GROUNDS"></div></label><label class="text-input"><input type="text" name="attr_lair"/><div class="label" data-i18n="LAIR"></div></label></div></div></div><div class="section crew-stats"><div class="section-header"><div class="section-stamp">CREW STATS</div><div class="section-number">02</div></div><div class="stats-grid"><div class="stats-row tier-hold-row"><div class="tier-block"><div class="stat-label" data-i18n="TIER">TIER</div><div class="tier-selector"><input type="radio" name="attr_crew_tier" value="0" checked="checked" id="tier_0"/><label class="tier-box" for="tier_0">0</label><input type="radio" name="attr_crew_tier" value="1" id="tier_1"/><label class="tier-box" for="tier_1">1</label><input type="radio" name="attr_crew_tier" value="2" id="tier_2"/><label class="tier-box" for="tier_2">2</label><input type="radio" name="attr_crew_tier" value="3" id="tier_3"/><label class="tier-box" for="tier_3">3</label><input type="radio" name="attr_crew_tier" value="4" id="tier_4"/><label class="tier-box" for="tier_4">4</label></div></div><div class="hold-block"><div class="stat-label" data-i18n="HOLD">HOLD</div><div class="hold-selector"><input type="radio" name="attr_hold" value="weak" id="hold_weak"/><label class="hold-option" for="hold_weak" data-i18n="WEAK">Weak</label><input type="radio" name="attr_hold" value="strong" checked="checked" id="hold_strong"/><label class="hold-option" for="hold_strong" data-i18n="STRONG">Strong</label></div></div></div><div class="stats-row rep-row"><div class="rep-block"><div class="stat-label" data-i18n="REP">REP</div><div class="rep-track"><input class="fakeradio zero" type="checkbox" name="attr_rep" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_rep" value="1" id="rep_1"/><label class="rep-box" for="rep_1"></label><input class="fakeradio" type="checkbox" name="attr_rep" value="2" id="rep_2"/><label class="rep-box" for="rep_2"></label><input class="fakeradio" type="checkbox" name="attr_rep" value="3" id="rep_3"/><label class="rep-box" for="rep_3"></label><input class="fakeradio" type="checkbox" name="attr_rep" value="4" id="rep_4"/><label class="rep-box" for="rep_4"></label><input class="fakeradio" type="checkbox" name="attr_rep" value="5" id="rep_5"/><label class="rep-box" for="rep_5"></label><input class="fakeradio" type="checkbox" name="attr_rep" value="6" id="rep_6"/><label class="rep-box" for="rep_6"></label><input class="fakeradio" type="checkbox" name="attr_rep" value="7" id="rep_7"/><label class="rep-box" for="rep_7"></label><input class="fakeradio" type="checkbox" name="attr_rep" value="8" id="rep_8"/><label class="rep-box" for="rep_8"></label><input class="fakeradio" type="checkbox" name="attr_rep" value="9" id="rep_9"/><label class="rep-box" for="rep_9"></label><input class="fakeradio" type="checkbox" name="attr_rep" value="10" id="rep_10"/><label class="rep-box" for="rep_10"></label><input class="fakeradio" type="checkbox" name="attr_rep" value="11" id="rep_11"/><label class="rep-box" for="rep_11"></label><input class="fakeradio" type="checkbox" name="attr_rep" value="12" id="rep_12"/><label class="rep-box" for="rep_12"></label></div></div></div><div class="stats-row heat-wanted-row"><div class="heat-block"><div class="stat-label" data-i18n="HEAT">HEAT</div><div class="heat-track"><input class="fakeradio zero" type="checkbox" name="attr_heat" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_heat" value="1" id="heat_1"/><label class="heat-box" for="heat_1"></label><input class="fakeradio" type="checkbox" name="attr_heat" value="2" id="heat_2"/><label class="heat-box" for="heat_2"></label><input class="fakeradio" type="checkbox" name="attr_heat" value="3" id="heat_3"/><label class="heat-box" for="heat_3"></label><input class="fakeradio" type="checkbox" name="attr_heat" value="4" id="heat_4"/><label class="heat-box" for="heat_4"></label><input class="fakeradio" type="checkbox" name="attr_heat" value="5" id="heat_5"/><label class="heat-box" for="heat_5"></label><input class="fakeradio" type="checkbox" name="attr_heat" value="6" id="heat_6"/><label class="heat-box" for="heat_6"></label><input class="fakeradio" type="checkbox" name="attr_heat" value="7" id="heat_7"/><label class="heat-box" for="heat_7"></label><input class="fakeradio" type="checkbox" name="attr_heat" value="8" id="heat_8"/><label class="heat-box" for="heat_8"></label><input class="fakeradio" type="checkbox" name="attr_heat" value="9" id="heat_9"/><label class="heat-box" for="heat_9"></label></div></div><div class="wanted-block"><div class="stat-label" data-i18n="WANTED">WANTED</div><div class="wanted-track"><input class="fakeradio zero" type="checkbox" name="attr_wanted" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_wanted" value="1" id="wanted_1"/><label class="wanted-box" for="wanted_1"></label><input class="fakeradio" type="checkbox" name="attr_wanted" value="2" id="wanted_2"/><label class="wanted-box" for="wanted_2"></label><input class="fakeradio" type="checkbox" name="attr_wanted" value="3" id="wanted_3"/><label class="wanted-box" for="wanted_3"></label><input class="fakeradio" type="checkbox" name="attr_wanted" value="4" id="wanted_4"/><label class="wanted-box" for="wanted_4"></label></div></div></div><div class="stats-row vault-row"><div class="vault-block"><div class="stat-label" data-i18n="VAULT">VAULT</div><div class="vault-track"><input class="fakeradio zero" type="checkbox" name="attr_vault" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_vault" value="1" id="vault_1"/><label class="vault-box" for="vault_1"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="2" id="vault_2"/><label class="vault-box" for="vault_2"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="3" id="vault_3"/><label class="vault-box" for="vault_3"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="4" id="vault_4"/><label class="vault-box" for="vault_4"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="5" id="vault_5"/><label class="vault-box" for="vault_5"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="6" id="vault_6"/><label class="vault-box" for="vault_6"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="7" id="vault_7"/><label class="vault-box" for="vault_7"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="8" id="vault_8"/><label class="vault-box" for="vault_8"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="9" id="vault_9"/><label class="vault-box" for="vault_9"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="10" id="vault_10"/><label class="vault-box" for="vault_10"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="11" id="vault_11"/><label class="vault-box" for="vault_11"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="12" id="vault_12"/><label class="vault-box" for="vault_12"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="13" id="vault_13"/><label class="vault-box" for="vault_13"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="14" id="vault_14"/><label class="vault-box" for="vault_14"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="15" id="vault_15"/><label class="vault-box" for="vault_15"></label><input class="fakeradio" type="checkbox" name="attr_vault" value="16" id="vault_16"/><label class="vault-box" for="vault_16"></label></div></div></div><div class="stats-row advancement-row"><div class="crew-advancement-block"><div class="stat-label crew-adv-label">ADVANCEMENT<span class="crew-adv-hint">(1 XP each, or 2 if major)</span></div><div class="crew-xp-triggers-list"><div class="crew-xp-trigger-item"><span class="crew-xp-bullet">▸</span><span class="crew-xp-trigger-text" name="attr_crew_xp_trigger"></span></div><div class="crew-xp-trigger-item"><span class="crew-xp-bullet">▸</span><span class="crew-xp-static">You contended with challenges above your station</span></div><div class="crew-xp-trigger-item"><span class="crew-xp-bullet">▸</span><span class="crew-xp-static">You bolstered your crew's reputation</span></div><div class="crew-xp-trigger-item"><span class="crew-xp-bullet">▸</span><span class="crew-xp-static">You expressed the goals, drives, or nature of the crew</span></div></div><div class="crew-advancement-clocks"><div class="adv-row"><div class="adv-clock"><input class="fakeradio zero" type="checkbox" name="attr_crew_adv_clock_1" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_1" value="1" id="crew_adv_clock_1_1"/><label class="crew-adv-segment" for="crew_adv_clock_1_1"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_1" value="2" id="crew_adv_clock_1_2"/><label class="crew-adv-segment" for="crew_adv_clock_1_2"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_1" value="3" id="crew_adv_clock_1_3"/><label class="crew-adv-segment" for="crew_adv_clock_1_3"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_1" value="4" id="crew_adv_clock_1_4"/><label class="crew-adv-segment" for="crew_adv_clock_1_4"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_1" value="5" id="crew_adv_clock_1_5"/><label class="crew-adv-segment" for="crew_adv_clock_1_5"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_1" value="6" id="crew_adv_clock_1_6"/><label class="crew-adv-segment" for="crew_adv_clock_1_6"></label></div><div class="adv-clock"><input class="fakeradio zero" type="checkbox" name="attr_crew_adv_clock_2" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_2" value="1" id="crew_adv_clock_2_1"/><label class="crew-adv-segment" for="crew_adv_clock_2_1"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_2" value="2" id="crew_adv_clock_2_2"/><label class="crew-adv-segment" for="crew_adv_clock_2_2"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_2" value="3" id="crew_adv_clock_2_3"/><label class="crew-adv-segment" for="crew_adv_clock_2_3"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_2" value="4" id="crew_adv_clock_2_4"/><label class="crew-adv-segment" for="crew_adv_clock_2_4"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_2" value="5" id="crew_adv_clock_2_5"/><label class="crew-adv-segment" for="crew_adv_clock_2_5"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_2" value="6" id="crew_adv_clock_2_6"/><label class="crew-adv-segment" for="crew_adv_clock_2_6"></label></div></div><div class="adv-row"><div class="adv-clock"><input class="fakeradio zero" type="checkbox" name="attr_crew_adv_clock_3" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_3" value="1" id="crew_adv_clock_3_1"/><label class="crew-adv-segment" for="crew_adv_clock_3_1"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_3" value="2" id="crew_adv_clock_3_2"/><label class="crew-adv-segment" for="crew_adv_clock_3_2"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_3" value="3" id="crew_adv_clock_3_3"/><label class="crew-adv-segment" for="crew_adv_clock_3_3"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_3" value="4" id="crew_adv_clock_3_4"/><label class="crew-adv-segment" for="crew_adv_clock_3_4"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_3" value="5" id="crew_adv_clock_3_5"/><label class="crew-adv-segment" for="crew_adv_clock_3_5"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_3" value="6" id="crew_adv_clock_3_6"/><label class="crew-adv-segment" for="crew_adv_clock_3_6"></label></div><div class="adv-clock"><input class="fakeradio zero" type="checkbox" name="attr_crew_adv_clock_4" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_4" value="1" id="crew_adv_clock_4_1"/><label class="crew-adv-segment" for="crew_adv_clock_4_1"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_4" value="2" id="crew_adv_clock_4_2"/><label class="crew-adv-segment" for="crew_adv_clock_4_2"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_4" value="3" id="crew_adv_clock_4_3"/><label class="crew-adv-segment" for="crew_adv_clock_4_3"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_4" value="4" id="crew_adv_clock_4_4"/><label class="crew-adv-segment" for="crew_adv_clock_4_4"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_4" value="5" id="crew_adv_clock_4_5"/><label class="crew-adv-segment" for="crew_adv_clock_4_5"></label><input class="fakeradio" type="checkbox" name="attr_crew_adv_clock_4" value="6" id="crew_adv_clock_4_6"/><label class="crew-adv-segment" for="crew_adv_clock_4_6"></label></div></div></div><div class="crew-advancement-costs"><div class="cost-row"><span class="cost-label">Crew Upgrade</span><span class="cost-value">1</span></div><div class="cost-row"><span class="cost-label">Crew Ability</span><span class="cost-value">2</span></div></div></div></div></div></div><div class="section score-tracker"><div class="section-header"><div class="section-stamp">SCORE TRACKER</div><div class="section-number">03</div></div><div class="score-grid"><div class="arc-heat-gauge"><div class="gauge-header"><div class="gauge-label" data-i18n="HEAT_GAUGE">HEAT GAUGE</div><div class="gauge-dice"><span class="dice-label">Disengage:</span><span class="dice-count" name="attr_score_heat_dice">8</span><span>d6</span></div></div><div class="arc-track"><input class="fakeradio zero" type="checkbox" name="attr_score_heat" value="0" checked="checked"/><input class="fakeradio" type="checkbox" name="attr_score_heat" value="1" id="score_heat_1"/><label class="arc-segment" for="score_heat_1" data-segment="1"></label><input class="fakeradio" type="checkbox" name="attr_score_heat" value="2" id="score_heat_2"/><label class="arc-segment" for="score_heat_2" data-segment="2"></label><input class="fakeradio" type="checkbox" name="attr_score_heat" value="3" id="score_heat_3"/><label class="arc-segment" for="score_heat_3" data-segment="3"></label><input class="fakeradio" type="checkbox" name="attr_score_heat" value="4" id="score_heat_4"/><label class="arc-segment" for="score_heat_4" data-segment="4"></label><input class="fakeradio" type="checkbox" name="attr_score_heat" value="5" id="score_heat_5"/><label class="arc-segment" for="score_heat_5" data-segment="5"></label><input class="fakeradio" type="checkbox" name="attr_score_heat" value="6" id="score_heat_6"/><label class="arc-segment" for="score_heat_6" data-segment="6"></label><input class="fakeradio" type="checkbox" name="attr_score_heat" value="7" id="score_heat_7"/><label class="arc-segment" for="score_heat_7" data-segment="7"></label><input class="fakeradio" type="checkbox" name="attr_score_heat" value="8" id="score_heat_8"/><label class="arc-segment" for="score_heat_8" data-segment="8"></label></div></div><div class="score-buttons"><button class="score-btn" type="action" name="act_engagement_roll"><span data-i18n="ROLL_ENGAGEMENT">Roll Engagement</span></button><button class="score-btn" type="action" name="act_disengage_roll"><span data-i18n="ROLL_DISENGAGEMENT">Roll Disengagement</span></button></div></div></div><div class="section claims"><input class="section-edit-toggle" type="checkbox" name="attr_edit_claims" id="edit_claims"/><div class="section-header"><div class="section-stamp">TERRITORY CONTROL</div><div class="section-number-group"><div class="section-number">04</div><label class="section-edit-btn" for="edit_claims" title="Edit this section">✎</label></div></div><div class="claims-manifest"><div class="manifest-header"><span class="manifest-title">SECTOR MAP</span><span class="manifest-classification">[CLASSIFIED]</span></div><div class="claims-grid"><div class="claim-cell" data-position="1"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_1_conn_right" value="1"/><div class="claim-conn conn-right"></div><input class="conn-check conn-bottom-check" type="checkbox" name="attr_claim_1_conn_bottom" value="1"/><div class="claim-conn conn-bottom"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_1_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_1_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_1_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_1_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_1_benefit" placeholder="Benefit"/></div></div><div class="claim-cell" data-position="2"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_2_conn_right" value="1"/><div class="claim-conn conn-right"></div><input class="conn-check conn-bottom-check" type="checkbox" name="attr_claim_2_conn_bottom" value="1"/><div class="claim-conn conn-bottom"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_2_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_2_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_2_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_2_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_2_benefit" placeholder="Benefit"/></div></div><div class="claim-cell" data-position="3"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_3_conn_right" value="1"/><div class="claim-conn conn-right"></div><input class="conn-check conn-bottom-check" type="checkbox" name="attr_claim_3_conn_bottom" value="1"/><div class="claim-conn conn-bottom"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_3_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_3_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_3_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_3_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_3_benefit" placeholder="Benefit"/></div></div><div class="claim-cell" data-position="4"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_4_conn_right" value="1"/><div class="claim-conn conn-right"></div><input class="conn-check conn-bottom-check" type="checkbox" name="attr_claim_4_conn_bottom" value="1"/><div class="claim-conn conn-bottom"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_4_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_4_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_4_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_4_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_4_benefit" placeholder="Benefit"/></div></div><div class="claim-cell" data-position="5"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_5_conn_right" value="1"/><div class="claim-conn conn-right"></div><input class="conn-check conn-bottom-check" type="checkbox" name="attr_claim_5_conn_bottom" value="1"/><div class="claim-conn conn-bottom"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_5_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_5_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_5_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_5_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_5_benefit" placeholder="Benefit"/></div></div><div class="claim-cell" data-position="6"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_6_conn_right" value="1"/><div class="claim-conn conn-right"></div><input class="conn-check conn-bottom-check" type="checkbox" name="attr_claim_6_conn_bottom" value="1"/><div class="claim-conn conn-bottom"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_6_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_6_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_6_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_6_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_6_benefit" placeholder="Benefit"/></div></div><div class="claim-cell" data-position="7"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_7_conn_right" value="1"/><div class="claim-conn conn-right"></div><input class="conn-check conn-bottom-check" type="checkbox" name="attr_claim_7_conn_bottom" value="1"/><div class="claim-conn conn-bottom"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_7_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_7_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_7_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_7_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_7_benefit" placeholder="Benefit"/></div></div><div class="claim-cell lair-cell" data-position="8"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_8_conn_right" value="1"/><div class="claim-conn conn-right"></div><input class="conn-check conn-bottom-check" type="checkbox" name="attr_claim_8_conn_bottom" value="1"/><div class="claim-conn conn-bottom"></div><div class="lair-marker">◆</div><div class="lair-label">LAIR</div></div><div class="claim-cell" data-position="9"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_9_conn_right" value="1"/><div class="claim-conn conn-right"></div><input class="conn-check conn-bottom-check" type="checkbox" name="attr_claim_9_conn_bottom" value="1"/><div class="claim-conn conn-bottom"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_9_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_9_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_9_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_9_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_9_benefit" placeholder="Benefit"/></div></div><div class="claim-cell" data-position="10"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_10_conn_right" value="1"/><div class="claim-conn conn-right"></div><input class="conn-check conn-bottom-check" type="checkbox" name="attr_claim_10_conn_bottom" value="1"/><div class="claim-conn conn-bottom"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_10_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_10_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_10_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_10_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_10_benefit" placeholder="Benefit"/></div></div><div class="claim-cell" data-position="11"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_11_conn_right" value="1"/><div class="claim-conn conn-right"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_11_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_11_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_11_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_11_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_11_benefit" placeholder="Benefit"/></div></div><div class="claim-cell" data-position="12"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_12_conn_right" value="1"/><div class="claim-conn conn-right"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_12_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_12_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_12_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_12_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_12_benefit" placeholder="Benefit"/></div></div><div class="claim-cell" data-position="13"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_13_conn_right" value="1"/><div class="claim-conn conn-right"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_13_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_13_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_13_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_13_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_13_benefit" placeholder="Benefit"/></div></div><div class="claim-cell" data-position="14"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_14_conn_right" value="1"/><div class="claim-conn conn-right"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_14_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_14_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_14_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_14_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_14_benefit" placeholder="Benefit"/></div></div><div class="claim-cell" data-position="15"><input class="conn-check conn-right-check" type="checkbox" name="attr_claim_15_conn_right" value="1"/><div class="claim-conn conn-right"></div><label class="claim-held-label"><input class="claim-held-check" type="checkbox" name="attr_claim_15_held" value="1"/><span class="claim-held-box"></span></label><div class="claim-content display"><div class="claim-name-display"><span name="attr_claim_15_name"></span></div><div class="claim-benefit-display"><span name="attr_claim_15_benefit"></span></div></div><div class="claim-content edit"><input class="claim-name-input" type="text" name="attr_claim_15_name" placeholder="Claim"/><input class="claim-benefit-input" type="text" name="attr_claim_15_benefit" placeholder="Benefit"/></div></div></div><div class="claims-legend"><span class="legend-item"><span class="legend-box legend-held">■</span>CONTROLLED</span><span class="legend-item"><span class="legend-box">□</span>AVAILABLE</span><span class="legend-item"><span class="legend-marker">◆</span>PRIMARY OPS</span></div></div></div><div class="section crew-clocks"><input class="section-edit-toggle" type="checkbox" name="attr_edit_crewclocks" id="edit_crewclocks"/><div class="section-header"><div class="section-stamp">CLOCKS</div><div class="section-number-group"><div class="section-number">05</div><label class="section-edit-btn" for="edit_crewclocks" title="Edit this section">✎</label></div></div><fieldset class="repeating_crewclocks"><div class="clock-entry"><input class="clock-show-5-6" type="checkbox" name="attr_clock_show_5_6" value="1" checked="checked"/><input class="clock-show-7-8" type="checkbox" name="attr_clock_show_7_8" value="1"/><input class="clock-show-9-10" type="checkbox" name="attr_clock_show_9_10" value="1"/><input class="clock-show-11-12" type="checkbox" name="attr_clock_show_11_12" value="1"/><div class="clock-header"><span class="display clock-name-display" name="attr_clock_name"></span><div class="edit"><input class="clock-name-input" type="text" name="attr_clock_name" placeholder="Clock name"/></div><div class="clock-size-badge"><span>[</span><span class="clock-size-value" name="attr_clock_size"></span><span>]</span></div><div class="edit clock-size-select"><select name="attr_clock_size"><option value="4">4</option><option value="6" selected="selected">6</option><option value="8">8</option><option value="10">10</option><option value="12">12</option></select></div></div><div class="clock-track"><input class="fakeradio zero" type="checkbox" name="attr_clock_value" value="0" checked="checked"/><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="1"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="2"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="3"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="4"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="5"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="6"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="7"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="8"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="9"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="10"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="11"/></label><label class="clock-segment"><input class="fakeradio" type="checkbox" name="attr_clock_value" value="12"/></label></div><span class="display clock-notes-display" name="attr_clock_notes"></span><div class="edit"><textarea class="clock-notes-input" name="attr_clock_notes" placeholder="Notes..."></textarea></div></div></fieldset></div><div class="section crew-notes"><div class="section-header"><div class="section-stamp">CREW NOTES</div><div class="section-number">06</div></div><textarea class="notes-area" name="attr_crew_notes" placeholder="Mission logs, ongoing operations, crew history..."></textarea></div></div><div class="right-column"><div class="section crew-upgrades"><div class="section-header"><div class="section-stamp">CREW UPGRADES</div><div class="section-number">07</div></div><div class="upgrades-grid"><div class="upgrade-category lair"><h4 data-i18n="LAIR">Lair</h4><div class="upgrade-list"><div class="upgrade-checkbox upgrade-multi"><input type="checkbox" name="attr_lair_rides_1" value="1" id="lair_rides_1"/><label class="upgrade-box" for="lair_rides_1"></label><input type="checkbox" name="attr_lair_rides_2" value="1" id="lair_rides_2"/><label class="upgrade-box" for="lair_rides_2"></label><span class="upgrade-name">Rides</span></div><div class="upgrade-checkbox upgrade-multi"><input type="checkbox" name="attr_lair_specialty_1" value="1" id="lair_specialty_1"/><label class="upgrade-box" for="lair_specialty_1"></label><input type="checkbox" name="attr_lair_specialty_2" value="1" id="lair_specialty_2"/><label class="upgrade-box" for="lair_specialty_2"></label><span class="upgrade-name">Specialty Transport</span></div><label class="upgrade-checkbox"><input type="checkbox" name="attr_lair_hidden" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Hidden</span></label><label class="upgrade-checkbox"><input type="checkbox" name="attr_lair_quarters" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Quarters</span></label><div class="upgrade-checkbox upgrade-multi"><input type="checkbox" name="attr_lair_secure_1" value="1" id="lair_secure_1"/><label class="upgrade-box" for="lair_secure_1"></label><input type="checkbox" name="attr_lair_secure_2" value="1" id="lair_secure_2"/><label class="upgrade-box" for="lair_secure_2"></label><span class="upgrade-name">Secure</span></div><div class="upgrade-checkbox upgrade-multi"><input type="checkbox" name="attr_lair_encryption_1" value="1" id="lair_encryption_1"/><label class="upgrade-box" for="lair_encryption_1"></label><input type="checkbox" name="attr_lair_encryption_2" value="1" id="lair_encryption_2"/><label class="upgrade-box" for="lair_encryption_2"></label><span class="upgrade-name">BC Encryption</span></div><label class="upgrade-checkbox"><input type="checkbox" name="attr_lair_workshop" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Workshop</span></label></div></div><div class="upgrade-category training"><h4 data-i18n="TRAINING">Training</h4><div class="upgrade-list"><label class="upgrade-checkbox"><input type="checkbox" name="attr_train_acuity" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Acuity</span></label><label class="upgrade-checkbox"><input type="checkbox" name="attr_train_grit" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Grit</span></label><label class="upgrade-checkbox"><input type="checkbox" name="attr_train_resolve" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Resolve</span></label><label class="upgrade-checkbox"><input type="checkbox" name="attr_train_personal" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Personal</span></label><div class="upgrade-checkbox upgrade-multi"><input type="checkbox" name="attr_train_mastery_1" value="1" id="train_mastery_1"/><label class="upgrade-box" for="train_mastery_1"></label><input type="checkbox" name="attr_train_mastery_2" value="1" id="train_mastery_2"/><label class="upgrade-box" for="train_mastery_2"></label><input type="checkbox" name="attr_train_mastery_3" value="1" id="train_mastery_3"/><label class="upgrade-box" for="train_mastery_3"></label><input type="checkbox" name="attr_train_mastery_4" value="1" id="train_mastery_4"/><label class="upgrade-box" for="train_mastery_4"></label><span class="upgrade-name">Mastery</span></div></div></div><div class="upgrade-category quality"><h4 data-i18n="QUALITY">Quality</h4><div class="upgrade-list"><label class="upgrade-checkbox"><input type="checkbox" name="attr_qual_documents" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Documents</span></label><label class="upgrade-checkbox"><input type="checkbox" name="attr_qual_gear" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Gear</span></label><label class="upgrade-checkbox"><input type="checkbox" name="attr_qual_implements" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Implements</span></label><label class="upgrade-checkbox"><input type="checkbox" name="attr_qual_supplies" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Supplies</span></label><label class="upgrade-checkbox"><input type="checkbox" name="attr_qual_tools" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Tools</span></label><label class="upgrade-checkbox"><input type="checkbox" name="attr_qual_weapons" value="1"/><span class="upgrade-box"></span><span class="upgrade-name">Weapons</span></label></div></div><div class="upgrade-category cohorts"><h4>Cohorts</h4><div class="upgrade-list"><div class="upgrade-checkbox upgrade-multi"><input type="checkbox" name="attr_cohort_new_1" value="1" id="cohort_new_1"/><label class="upgrade-box" for="cohort_new_1"></label><input type="checkbox" name="attr_cohort_new_2" value="1" id="cohort_new_2"/><label class="upgrade-box" for="cohort_new_2"></label><input type="checkbox" name="attr_cohort_new_3" value="1" id="cohort_new_3"/><label class="upgrade-box" for="cohort_new_3"></label><input type="checkbox" name="attr_cohort_new_4" value="1" id="cohort_new_4"/><label class="upgrade-box" for="cohort_new_4"></label><span class="upgrade-name">New Cohort</span></div><div class="upgrade-checkbox upgrade-multi"><input type="checkbox" name="attr_cohort_type_1" value="1" id="cohort_type_1"/><label class="upgrade-box" for="cohort_type_1"></label><input type="checkbox" name="attr_cohort_type_2" value="1" id="cohort_type_2"/><label class="upgrade-box" for="cohort_type_2"></label><input type="checkbox" name="attr_cohort_type_3" value="1" id="cohort_type_3"/><label class="upgrade-box" for="cohort_type_3"></label><input type="checkbox" name="attr_cohort_type_4" value="1" id="cohort_type_4"/><label class="upgrade-box" for="cohort_type_4"></label><span class="upgrade-name">Add Type</span></div></div></div></div></div><div class="section crew-type-upgrades"><input class="section-edit-toggle" type="checkbox" name="attr_edit_crewtypeupgrades" id="edit_crewtypeupgrades"/><div class="section-header"><div class="section-stamp">CREW TYPE UPGRADES</div><div class="section-number-group"><div class="section-number">08</div><label class="section-edit-btn" for="edit_crewtypeupgrades" title="Edit this section">✎</label></div></div><fieldset class="repeating_crewtypeupgrades"><div class="upgrade-entry"><input class="upgrade-show-lvl2" type="checkbox" name="attr_upgrade_show_2" value="1"/><input class="upgrade-show-lvl3" type="checkbox" name="attr_upgrade_show_3" value="1"/><div class="upgrade-track"><label class="upgrade-box-label level-1"><input type="checkbox" name="attr_upgrade_level_1" value="1"/><span class="upgrade-box"></span></label><label class="upgrade-box-label level-2"><input type="checkbox" name="attr_upgrade_level_2" value="1"/><span class="upgrade-box"></span></label><label class="upgrade-box-label level-3"><input type="checkbox" name="attr_upgrade_level_3" value="1"/><span class="upgrade-box"></span></label></div><div class="upgrade-content"><div class="display upgrade-display"><span class="upgrade-name-display" name="attr_upgrade_name"></span><span class="upgrade-desc-display" name="attr_upgrade_desc"></span></div><div class="edit upgrade-edit"><input class="upgrade-name-input" type="text" name="attr_upgrade_name" placeholder="Upgrade name"/><input class="upgrade-desc-input" type="text" name="attr_upgrade_desc" placeholder="Description"/></div></div></div></fieldset></div><div class="section crew-abilities"><input class="section-edit-toggle" type="checkbox" name="attr_edit_crewabilities" id="edit_crewabilities"/><div class="section-header"><div class="section-stamp">CREW ABILITIES</div><div class="section-number-group"><div class="section-number">09</div><label class="section-edit-btn" for="edit_crewabilities" title="Edit this section">✎</label></div></div><fieldset class="repeating_crewabilities"><div class="ability-entry"><label class="ability-taken"><input class="ability-check" type="checkbox" name="attr_crew_ability_taken" value="1"/><span class="taken-box"></span></label><div class="ability-content"><div class="display ability-display"><div class="ability-header-display"><span class="ability-name-display" name="attr_crew_ability_name"></span></div><span class="ability-desc-display" name="attr_crew_ability_desc"></span></div><div class="edit ability-edit"><input class="ability-name-input" type="text" name="attr_crew_ability_name" placeholder="Ability name"/><textarea class="ability-desc-input" name="attr_crew_ability_desc" placeholder="Description &amp; effects"></textarea></div></div></div></fieldset></div><div class="section cohorts"><input class="section-edit-toggle" type="checkbox" name="attr_edit_cohorts" id="edit_cohorts"/><div class="section-header"><div class="section-stamp">COHORTS</div><div class="section-number-group"><div class="section-number">10</div><label class="section-edit-btn" for="edit_cohorts" title="Edit this section">✎</label></div></div><fieldset class="repeating_cohorts"><div class="cohort-entry"><div class="cohort-header-row"><div class="display cohort-header-display"><span class="cohort-name-display" name="attr_cohort_name"></span><span class="cohort-type-display">(</span><span class="cohort-type-value" name="attr_cohort_type"></span><span class="cohort-type-display">)</span></div><div class="edit cohort-header-edit"><input class="cohort-name-input" type="text" name="attr_cohort_name" placeholder="Cohort name"/><select class="cohort-type-select" name="attr_cohort_type"><option value="">--</option><optgroup label="Gangs"><option value="talent">Talent (Techies, Chemists, Hackers)</option><option value="suits">Suits (Con Artists, Spies)</option><option value="couriers">Couriers (Drivers, Deliverers)</option><option value="catches">Catches (Scouts, Infiltrators, Thieves)</option><option value="clubs">Clubs (Killers, Brawlers)</option></optgroup><optgroup label="Expert"><option value="expert">Expert (specify below)</option></optgroup></select></div><label class="cohort-elite-label"><input class="cohort-elite-check" type="checkbox" name="attr_cohort_elite" value="1"/><span class="elite-box"></span><span class="elite-label">ELITE</span></label></div><div class="display cohort-info-display"><div class="info-row"><span class="info-label">Tags:</span><span class="info-value" name="attr_cohort_tags"></span></div><div class="info-row"><span class="info-label">Edges:</span><span class="info-value" name="attr_cohort_edges"></span></div><div class="info-row"><span class="info-label">Flaws:</span><span class="info-value" name="attr_cohort_flaws"></span></div></div><div class="edit cohort-info-edit"><label class="text-input"><input type="text" name="attr_cohort_tags"/><div class="label" data-i18n="TAGS"></div></label><label class="text-input"><input type="text" name="attr_cohort_edges"/><div class="label" data-i18n="EDGES"></div></label><label class="text-input"><input type="text" name="attr_cohort_flaws"/><div class="label" data-i18n="FLAWS"></div></label></div><div class="cohort-harm"><span class="harm-label">Harm:</span><div class="harm-track"><label class="harm-option"><input type="radio" name="attr_cohort_harm" value="0" checked="checked"/><span class="harm-text">None</span></label><label class="harm-option"><input type="radio" name="attr_cohort_harm" value="1"/><span class="harm-text">Weak</span></label><label class="harm-option"><input type="radio" name="attr_cohort_harm" value="2"/><span class="harm-text">Impaired</span></label><label class="harm-option"><input type="radio" name="attr_cohort_harm" value="3"/><span class="harm-text">Broken</span></label><label class="harm-option"><input type="radio" name="attr_cohort_harm" value="4"/><span class="harm-text">Dead</span></label></div></div><button class="cohort-roll-btn" type="action" name="act_cohortroll">Roll</button></div></fieldset></div><div class="section crew-contacts"><input class="section-edit-toggle" type="checkbox" name="attr_edit_crewcontacts" id="edit_crewcontacts"/><div class="section-header"><div class="section-stamp">CREW CONTACTS</div><div class="section-number-group"><div class="section-number">11</div><label class="section-edit-btn" for="edit_crewcontacts" title="Edit this section">✎</label></div></div><div class="contacts-intro">Select a Favored Contact</div><div class="contacts-list"><div class="contact-card"><div class="contact-relation"><label class="relation-option relation-favored" title="Favored"><input type="radio" name="attr_crew_contact_1_relation" value="favored"/><span class="relation-badge">★</span></label><label class="relation-option relation-neutral" title="Neutral"><input type="radio" name="attr_crew_contact_1_relation" value="neutral" checked="checked"/><span class="relation-badge">○</span></label></div><div class="contact-display display"><span class="contact-name" name="attr_crew_contact_1_name"></span><span class="contact-desc" name="attr_crew_contact_1_desc"></span></div><div class="contact-edit edit"><input class="contact-name-input" type="text" name="attr_crew_contact_1_name" placeholder="Contact name"/><input class="contact-desc-input" type="text" name="attr_crew_contact_1_desc" placeholder="Role / description"/></div></div><div class="contact-card"><div class="contact-relation"><label class="relation-option relation-favored" title="Favored"><input type="radio" name="attr_crew_contact_2_relation" value="favored"/><span class="relation-badge">★</span></label><label class="relation-option relation-neutral" title="Neutral"><input type="radio" name="attr_crew_contact_2_relation" value="neutral" checked="checked"/><span class="relation-badge">○</span></label></div><div class="contact-display display"><span class="contact-name" name="attr_crew_contact_2_name"></span><span class="contact-desc" name="attr_crew_contact_2_desc"></span></div><div class="contact-edit edit"><input class="contact-name-input" type="text" name="attr_crew_contact_2_name" placeholder="Contact name"/><input class="contact-desc-input" type="text" name="attr_crew_contact_2_desc" placeholder="Role / description"/></div></div><div class="contact-card"><div class="contact-relation"><label class="relation-option relation-favored" title="Favored"><input type="radio" name="attr_crew_contact_3_relation" value="favored"/><span class="relation-badge">★</span></label><label class="relation-option relation-neutral" title="Neutral"><input type="radio" name="attr_crew_contact_3_relation" value="neutral" checked="checked"/><span class="relation-badge">○</span></label></div><div class="contact-display display"><span class="contact-name" name="attr_crew_contact_3_name"></span><span class="contact-desc" name="attr_crew_contact_3_desc"></span></div><div class="contact-edit edit"><input class="contact-name-input" type="text" name="attr_crew_contact_3_name" placeholder="Contact name"/><input class="contact-desc-input" type="text" name="attr_crew_contact_3_desc" placeholder="Role / description"/></div></div><div class="contact-card"><div class="contact-relation"><label class="relation-option relation-favored" title="Favored"><input type="radio" name="attr_crew_contact_4_relation" value="favored"/><span class="relation-badge">★</span></label><label class="relation-option relation-neutral" title="Neutral"><input type="radio" name="attr_crew_contact_4_relation" value="neutral" checked="checked"/><span class="relation-badge">○</span></label></div><div class="contact-display display"><span class="contact-name" name="attr_crew_contact_4_name"></span><span class="contact-desc" name="attr_crew_contact_4_desc"></span></div><div class="contact-edit edit"><input class="contact-name-input" type="text" name="attr_crew_contact_4_name" placeholder="Contact name"/><input class="contact-desc-input" type="text" name="attr_crew_contact_4_desc" placeholder="Role / description"/></div></div><div class="contact-card"><div class="contact-relation"><label class="relation-option relation-favored" title="Favored"><input type="radio" name="attr_crew_contact_5_relation" value="favored"/><span class="relation-badge">★</span></label><label class="relation-option relation-neutral" title="Neutral"><input type="radio" name="attr_crew_contact_5_relation" value="neutral" checked="checked"/><span class="relation-badge">○</span></label></div><div class="contact-display display"><span class="contact-name" name="attr_crew_contact_5_name"></span><span class="contact-desc" name="attr_crew_contact_5_desc"></span></div><div class="contact-edit edit"><input class="contact-name-input" type="text" name="attr_crew_contact_5_name" placeholder="Contact name"/><input class="contact-desc-input" type="text" name="attr_crew_contact_5_desc" placeholder="Role / description"/></div></div><div class="contact-card"><div class="contact-relation"><label class="relation-option relation-favored" title="Favored"><input type="radio" name="attr_crew_contact_6_relation" value="favored"/><span class="relation-badge">★</span></label><label class="relation-option relation-neutral" title="Neutral"><input type="radio" name="attr_crew_contact_6_relation" value="neutral" checked="checked"/><span class="relation-badge">○</span></label></div><div class="contact-display display"><span class="contact-name" name="attr_crew_contact_6_name"></span><span class="contact-desc" name="attr_crew_contact_6_desc"></span></div><div class="contact-edit edit"><input class="contact-name-input" type="text" name="attr_crew_contact_6_name" placeholder="Contact name"/><input class="contact-desc-input" type="text" name="attr_crew_contact_6_desc" placeholder="Role / description"/></div></div></div></div></div></div></div><div class="tab-content factions-content"><input class="section-edit-toggle" type="checkbox" name="attr_edit_factions" id="edit_factions"/><div class="section-header"><div class="section-stamp">FACTION RELATIONS</div><div class="section-number-group"><div class="section-number">01</div><label class="section-edit-btn" for="edit_factions" title="Edit this section">✎</label></div></div><div class="factions-section"><div class="factions-controls"><button class="populate-btn" type="action" name="act_populate_factions">Populate Default Factions</button><button class="populate-btn" type="action" name="act_clear_factions" style="margin-left: 8px;">Clear All Factions</button></div><div class="status-legend"><span class="legend-item war">⚔ WAR</span><span class="legend-item hostile">-2</span><span class="legend-item interfering">-1</span><span class="legend-item neutral">0</span><span class="legend-item helpful">+1</span><span class="legend-item friendly">+2</span><span class="legend-item allied">★ ALLY</span></div><div class="faction-columns"><div class="faction-column"><div class="faction-category-header">CORPS (MAJOR)</div><fieldset class="repeating_factionscorpsmajor"><div class="faction-entry"><div class="faction-header-row"><div class="display faction-tier-badge"><span name="attr_faction_tier_display"></span></div><div class="edit faction-tier-edit"><select name="attr_faction_tier"><option value="1">I</option><option value="2">II</option><option value="3">III</option><option value="4">IV</option><option value="5">V</option><option value="6">VI</option></select></div><span class="display faction-name-display" name="attr_faction_name"></span><input class="edit faction-name-input" type="text" name="attr_faction_name" placeholder="Faction name"/></div><span class="display faction-desc-display" name="attr_faction_desc"></span><textarea class="edit faction-desc-input" name="attr_faction_desc" placeholder="Notes..."></textarea><div class="faction-status-track"><label class="status-pip" data-value="-3"><input type="radio" name="attr_faction_status" value="-3"/><span>⚔</span></label><label class="status-pip" data-value="-2"><input type="radio" name="attr_faction_status" value="-2"/><span>-2</span></label><label class="status-pip" data-value="-1"><input type="radio" name="attr_faction_status" value="-1"/><span>-1</span></label><label class="status-pip" data-value="0"><input type="radio" name="attr_faction_status" value="0" checked="checked"/><span>0</span></label><label class="status-pip" data-value="1"><input type="radio" name="attr_faction_status" value="1"/><span>+1</span></label><label class="status-pip" data-value="2"><input type="radio" name="attr_faction_status" value="2"/><span>+2</span></label><label class="status-pip" data-value="3"><input type="radio" name="attr_faction_status" value="3"/><span>★</span></label></div><input type="hidden" name="attr_faction_tier_display"/><input type="hidden" name="attr_faction_category"/><input type="hidden" name="attr_autogen"/></div></fieldset></div><div class="faction-column"><div class="faction-category-header">CORPS (MINOR)</div><fieldset class="repeating_factionscorpsminor"><div class="faction-entry"><div class="faction-header-row"><div class="display faction-tier-badge"><span name="attr_faction_tier_display"></span></div><div class="edit faction-tier-edit"><select name="attr_faction_tier"><option value="1">I</option><option value="2">II</option><option value="3">III</option><option value="4">IV</option><option value="5">V</option><option value="6">VI</option></select></div><span class="display faction-name-display" name="attr_faction_name"></span><input class="edit faction-name-input" type="text" name="attr_faction_name" placeholder="Faction name"/></div><span class="display faction-desc-display" name="attr_faction_desc"></span><textarea class="edit faction-desc-input" name="attr_faction_desc" placeholder="Notes..."></textarea><div class="faction-status-track"><label class="status-pip" data-value="-3"><input type="radio" name="attr_faction_status" value="-3"/><span>⚔</span></label><label class="status-pip" data-value="-2"><input type="radio" name="attr_faction_status" value="-2"/><span>-2</span></label><label class="status-pip" data-value="-1"><input type="radio" name="attr_faction_status" value="-1"/><span>-1</span></label><label class="status-pip" data-value="0"><input type="radio" name="attr_faction_status" value="0" checked="checked"/><span>0</span></label><label class="status-pip" data-value="1"><input type="radio" name="attr_faction_status" value="1"/><span>+1</span></label><label class="status-pip" data-value="2"><input type="radio" name="attr_faction_status" value="2"/><span>+2</span></label><label class="status-pip" data-value="3"><input type="radio" name="attr_faction_status" value="3"/><span>★</span></label></div><input type="hidden" name="attr_faction_tier_display"/><input type="hidden" name="attr_faction_category"/><input type="hidden" name="attr_autogen"/></div></fieldset></div><div class="faction-column"><div class="faction-category-header">THE UNDERWORLD</div><fieldset class="repeating_factionsunderworld"><div class="faction-entry"><div class="faction-header-row"><div class="display faction-tier-badge"><span name="attr_faction_tier_display"></span></div><div class="edit faction-tier-edit"><select name="attr_faction_tier"><option value="1">I</option><option value="2">II</option><option value="3">III</option><option value="4">IV</option><option value="5">V</option><option value="6">VI</option></select></div><span class="display faction-name-display" name="attr_faction_name"></span><input class="edit faction-name-input" type="text" name="attr_faction_name" placeholder="Faction name"/></div><span class="display faction-desc-display" name="attr_faction_desc"></span><textarea class="edit faction-desc-input" name="attr_faction_desc" placeholder="Notes..."></textarea><div class="faction-status-track"><label class="status-pip" data-value="-3"><input type="radio" name="attr_faction_status" value="-3"/><span>⚔</span></label><label class="status-pip" data-value="-2"><input type="radio" name="attr_faction_status" value="-2"/><span>-2</span></label><label class="status-pip" data-value="-1"><input type="radio" name="attr_faction_status" value="-1"/><span>-1</span></label><label class="status-pip" data-value="0"><input type="radio" name="attr_faction_status" value="0" checked="checked"/><span>0</span></label><label class="status-pip" data-value="1"><input type="radio" name="attr_faction_status" value="1"/><span>+1</span></label><label class="status-pip" data-value="2"><input type="radio" name="attr_faction_status" value="2"/><span>+2</span></label><label class="status-pip" data-value="3"><input type="radio" name="attr_faction_status" value="3"/><span>★</span></label></div><input type="hidden" name="attr_faction_tier_display"/><input type="hidden" name="attr_faction_category"/><input type="hidden" name="attr_autogen"/></div></fieldset></div><div class="faction-column"><div class="faction-category-header">FRINGE & LABOR</div><fieldset class="repeating_factionsfringe"><div class="faction-entry"><div class="faction-header-row"><div class="display faction-tier-badge"><span name="attr_faction_tier_display"></span></div><div class="edit faction-tier-edit"><select name="attr_faction_tier"><option value="1">I</option><option value="2">II</option><option value="3">III</option><option value="4">IV</option><option value="5">V</option><option value="6">VI</option></select></div><span class="display faction-name-display" name="attr_faction_name"></span><input class="edit faction-name-input" type="text" name="attr_faction_name" placeholder="Faction name"/></div><span class="display faction-desc-display" name="attr_faction_desc"></span><textarea class="edit faction-desc-input" name="attr_faction_desc" placeholder="Notes..."></textarea><div class="faction-status-track"><label class="status-pip" data-value="-3"><input type="radio" name="attr_faction_status" value="-3"/><span>⚔</span></label><label class="status-pip" data-value="-2"><input type="radio" name="attr_faction_status" value="-2"/><span>-2</span></label><label class="status-pip" data-value="-1"><input type="radio" name="attr_faction_status" value="-1"/><span>-1</span></label><label class="status-pip" data-value="0"><input type="radio" name="attr_faction_status" value="0" checked="checked"/><span>0</span></label><label class="status-pip" data-value="1"><input type="radio" name="attr_faction_status" value="1"/><span>+1</span></label><label class="status-pip" data-value="2"><input type="radio" name="attr_faction_status" value="2"/><span>+2</span></label><label class="status-pip" data-value="3"><input type="radio" name="attr_faction_status" value="3"/><span>★</span></label></div><input type="hidden" name="attr_faction_tier_display"/><input type="hidden" name="attr_faction_category"/><input type="hidden" name="attr_autogen"/></div></fieldset></div><div class="faction-column"><div class="faction-category-header">CITIZENS</div><fieldset class="repeating_factionscitizens"><div class="faction-entry"><div class="faction-header-row"><div class="display faction-tier-badge"><span name="attr_faction_tier_display"></span></div><div class="edit faction-tier-edit"><select name="attr_faction_tier"><option value="1">I</option><option value="2">II</option><option value="3">III</option><option value="4">IV</option><option value="5">V</option><option value="6">VI</option></select></div><span class="display faction-name-display" name="attr_faction_name"></span><input class="edit faction-name-input" type="text" name="attr_faction_name" placeholder="Faction name"/></div><span class="display faction-desc-display" name="attr_faction_desc"></span><textarea class="edit faction-desc-input" name="attr_faction_desc" placeholder="Notes..."></textarea><div class="faction-status-track"><label class="status-pip" data-value="-3"><input type="radio" name="attr_faction_status" value="-3"/><span>⚔</span></label><label class="status-pip" data-value="-2"><input type="radio" name="attr_faction_status" value="-2"/><span>-2</span></label><label class="status-pip" data-value="-1"><input type="radio" name="attr_faction_status" value="-1"/><span>-1</span></label><label class="status-pip" data-value="0"><input type="radio" name="attr_faction_status" value="0" checked="checked"/><span>0</span></label><label class="status-pip" data-value="1"><input type="radio" name="attr_faction_status" value="1"/><span>+1</span></label><label class="status-pip" data-value="2"><input type="radio" name="attr_faction_status" value="2"/><span>+2</span></label><label class="status-pip" data-value="3"><input type="radio" name="attr_faction_status" value="3"/><span>★</span></label></div><input type="hidden" name="attr_faction_tier_display"/><input type="hidden" name="attr_faction_category"/><input type="hidden" name="attr_autogen"/></div></fieldset></div></div></div></div><rolltemplate class="sheet-rolltemplate-dcsb-action"><div class="rt-container"><div class="rt-header"><div class="rt-header-border">┌──────────────────────────────────────────────────┐</div><div class="rt-header-content"><span class="rt-charname">{{charname}}</span><span class="rt-action">{{title}}</span></div><div class="rt-header-border">└──────────────────────────────────────────────────┘</div></div><div class="rt-body"><div class="rt-result"><div class="rt-result-label">{{computed::label}}</div><div class="rt-result-value">{{roll}}</div></div>{{#position}}<div class="rt-context"><span class="rt-context-label">POSITION:</span><span class="rt-context-value">{{position}}</span></div>{{/position}}
{{#effect}}<div class="rt-context"><span class="rt-context-label">EFFECT:</span><span class="rt-context-value">{{effect}}</span></div>{{/effect}}</div>{{#notes}}<div class="rt-footer"><span class="rt-notes">{{notes}}</span></div>{{/notes}}</div></rolltemplate><rolltemplate class="sheet-rolltemplate-dcsb-fortune"><div class="rt-container"><div class="rt-header"><div class="rt-header-border">┌──────────────────────────────────────────────────┐</div><div class="rt-header-content"><span class="rt-charname">{{charname}}</span><span class="rt-action">{{title}}</span></div><div class="rt-header-border">└──────────────────────────────────────────────────┘</div></div><div class="rt-body"><div class="rt-result"><div class="rt-result-label">{{computed::label}}</div><div class="rt-result-value">{{roll}}</div></div>{{#position}}<div class="rt-context"><span class="rt-context-label">POSITION:</span><span class="rt-context-value">{{position}}</span></div>{{/position}}
{{#effect}}<div class="rt-context"><span class="rt-context-label">EFFECT:</span><span class="rt-context-value">{{effect}}</span></div>{{/effect}}</div>{{#notes}}<div class="rt-footer"><span class="rt-notes">{{notes}}</span></div>{{/notes}}</div></rolltemplate><rolltemplate class="sheet-rolltemplate-dcsb-resistance"><div class="rt-container rt-resist"><div class="rt-header"><div class="rt-header-border">┌──────────────────────────────────────────────────┐</div><div class="rt-header-content"><span class="rt-charname">{{charname}}</span><span class="rt-action">RESIST</span></div><div class="rt-header-border">└──────────────────────────────────────────────────┘</div></div><div class="rt-body"><div class="rt-result rt-resist-result"><div class="rt-result-label">{{attribute}}</div><div class="rt-result-value">{{roll}}</div></div><div class="rt-stress-result"><span class="rt-stress-text">{{computed::stressmsg}}</span></div></div>{{#notes}}<div class="rt-footer"><span class="rt-notes">{{notes}}</span></div>{{/notes}}</div></rolltemplate><rolltemplate class="sheet-rolltemplate-dcsb-vice"><div class="rt-container"><div class="rt-header"><div class="rt-header-border">┌──────────────────────────────────────────────────┐</div><div class="rt-header-content"><span class="rt-charname">{{charname}}</span><span class="rt-action">INDULGE VICE</span></div><div class="rt-header-border">└──────────────────────────────────────────────────┘</div></div><div class="rt-body"><div class="rt-result rt-vice-result"><div class="rt-result-label">{{computed::label}}</div><div class="rt-result-value">{{roll}}</div></div>{{#rollGreater() roll 5}}<div class="rt-vice-warning"><span class="rt-warning-icon">!</span><span class="rt-warning-text">Overindulgence? (6+)</span></div>{{/rollGreater() roll 5}}</div>{{#notes}}<div class="rt-footer"><span class="rt-notes">{{notes}}</span></div>{{/notes}}</div></rolltemplate></div><script type="text/worker">(function () {
  "use strict";"use strict";
// Dark City, Shining Babel - Playbook Data
// All playbook-specific items, actions, augments
// NOTE: Data originally from Mini Rulebook, being updated to match The New Babel
const PLAYBOOK_DATA = {
    face: {
        title: "Face",
        xpTrigger: "You addressed a challenge with deception or influence",
        actions: { sway: 2, consort: 1 },
        items: [
            { name: "Fine Fashion and Jewelry", load: 1 },
            { name: "Fine Disguise Kit", load: 1 },
            { name: "Fine Gossip", load: 1, special: true },
            { name: "Powdered Psychedelics", load: 1, special: true },
            { name: "A luxury weapon", load: 1 }
        ],
        augments: [
            { tier: 2, name: "Kodama Command Link", description: "When you Command a cohort in combat, they continue to fight when they would otherwise break (they're not taken out when they suffer level 3 harm). They gain +1 effect and 1 armor." },
            { tier: 2, name: "Cerebral BC Farming", description: "At the end of each downtime phase, you earn +2 stash." },
            { tier: 2, name: "Augmented Projection", description: "You gain effect when speaking to a crowd." },
            { tier: 3, name: "Human, After All", description: "You know the specific intonations and phrases to gain higher trust from AI systems, as advanced or primitive as they may seem. You have potency when communicating by speaking with Artificial Intelligences." },
            { tier: 3, name: "Hippocampus Inceptor", description: "A retractable cord at the base of your skull can connect to standard ports on an augmented person. You can see their memories. Gain effect when trying to convince someone's unconscious." },
            { tier: 3, name: "Social Enhancer", description: "Mental implant that allows you to pick up on human pheromones and perceive minor body language. Always know when someone is lying to you." },
            { tier: 3, name: "Hypnotic Gaze", description: "When you Sway someone, you may cause them to forget that it's happened until they next interact with you." },
            { tier: 4, name: "FoRK Rewire", description: "Take 2 stress to roll your best action rating while performing a different action. Say how you adapt your skill to this use." },
            { tier: 5, name: "Faceless", description: "If just using it for yourself, your disguise kit becomes zero load. You have a synthetic skin mask that can be changed between scores. You get +1d to rolls attempting to remain disguised or deflect suspicion. Throwing off your disguise surprises people, giving you initiative in the situation." }
        ],
        friends: [
            { name: "Kala", description: "a Vice Dealer" },
            { name: "Yuda", description: "a Gang Leader" },
            { name: "Notah", description: "a Corp Recruiter" },
            { name: "Velle", description: "a Prostitute" },
            { name: "Vanuza", description: "a Slab Regular" }
        ]
    },
    fixer: {
        title: "Fixer",
        xpTrigger: "You addressed a challenge with connections and calculation",
        actions: { consort: 2, scrutinize: 1 },
        items: [
            { name: "Fine Cover Identity", load: 1, special: true },
            { name: "Fine Bottle of Real Liquor", load: 1 },
            { name: "Blueprints", load: 1 },
            { name: "Toxic Vial", load: 1, special: true },
            { name: "Foldable Pistol", load: 1, special: true }
        ],
        augments: [
            { tier: 2, name: "Tapped Lines", description: "During downtime, you get +1 result level when you acquire an asset or reduce heat." },
            { tier: 2, name: "Camera Feed", description: "You have a tight hold on someone's life. When rolling to influence someone you have blackmail on, take +1d and +effect. When you take this ability, gain blackmail on one NPC." },
            { tier: 2, name: "Data-Vaults", description: "You gain +1d to Consort when you gather information on a target for a score. You get +1d to the engagement roll for that operation." },
            { tier: 2, name: "Future Projections", description: "You may expend your special armor to protect a teammate, or to push yourself when you gather information or work on a long-term project." },
            { tier: 3, name: "Mentat Cerebrum Implant", description: "Due to your careful planning, during downtime, you may give yourself or another crew member +1 downtime action." },
            { tier: 4, name: "Programmed Receptors", description: "When you indulge your vice, you may adjust the dice outcome by 1 or 2 (up or down). An ally who joins in your vice may do the same." }
        ],
        friends: [
            { name: "Yandi", description: "a White Hat" },
            { name: "Arsene", description: "a Bounty Hunter" },
            { name: "Starlight", description: "a Pop Star" },
            { name: "Antosha", description: "a Slab Boss" },
            { name: "Siza", description: "a City Planner" }
        ]
    },
    hacker: {
        title: "Hacker",
        xpTrigger: "You addressed a challenge with knowledge or technological prowess",
        actions: { hack: 2, scrutinize: 1 },
        items: [
            { name: "Fine Hacking Deck", load: 2 },
            { name: "Electro-Goggles", load: 1 },
            { name: "Stimulants", load: 1, special: true },
            { name: "Specialty Chipsets", load: 1 },
            { name: "Extra Chipsets", load: 1 },
            { name: "Subtle Surveillance Equipment", load: 1 }
        ],
        augments: [
            { tier: 2, name: "Electrochemistry", description: "You can use an internal battery to briefly emit a local current of power." },
            { tier: 2, name: "Overflow Blockage", description: "You may expend your special armor to resist a wired-in consequence or push yourself when Hacking." },
            { tier: 2, name: "Chipset Storage", description: "Choose 1 chipset that you will always have access to regardless of the deck or situation." },
            { tier: 3, name: "Rage Against the Machine", description: "You won't let a goon tell you what to do or when to do it. Take +1d to resistance rolls when opposing Corporate authority." },
            { tier: 3, name: "Built-In Hacking Deck", description: "Zero load Fine Deck that you will always have on you." },
            { tier: 3, name: "Bugs in the Code", description: "You can push yourself for one of the following additional effects while hacking: Reduce payoff heat by 1, provide increased effect to another Runner dealing with electronic security measures, or gather information." },
            { tier: 3, name: "Recurring ICE", description: "Done it once, done it a thousand times. Once you have hacked into a system, you get +1d on subsequent rolls on that score to dig deeper into it or change it." },
            { tier: 4, name: "Maim-frame", description: "When you hack into a system, you can overclock equipment to make actions normally outside their operational ability. I.e. A normal camera can now detect specific people, a killer robot can now be used to project a voice, or a stun barrier can be set to kill." },
            { tier: 5, name: "Grok 2.0", description: "You have an AI assistant stored in your brain. Increases potency for all Hacking and most investigative rolls. Not always right." }
        ],
        friends: [
            { name: "Kapik", description: "a Deck Designer" },
            { name: "Rabbit Foot", description: "a Stim-Head" },
            { name: "Wonderland", description: "a Hacker" },
            { name: "Pi", description: "an AI" },
            { name: "Sua", description: "an Anarchist" }
        ]
    },
    midnighter: {
        title: "MidNighter",
        xpTrigger: "You addressed a challenge with stealth or evasion",
        actions: { skulk: 2, finesse: 1 },
        items: [
            { name: "Fine Lockpicks", load: 1, special: true },
            { name: "Fine Digitized Camo", load: 1 },
            { name: "Light Climbing Gear", load: 1 },
            { name: "Adaptable Silencer", load: 1, special: true },
            { name: "Night Vision Goggles", load: 1, special: true }
        ],
        augments: [
            { tier: 2, name: "Loaded Targeting", description: "When you attack from hiding or spring a trap, you get +1d." },
            { tier: 3, name: "Accelerated Nerves", description: "When there's a question about who acts first, the answer is you (two characters with Accelerated Nerves act simultaneously)." },
            { tier: 4, name: "Split Fingers", description: "You are not affected by quality or Tier when you bypass security measures." },
            { tier: 4, name: "Shimmering Skin", description: "You may expend your special armor to resist a consequence from detection or security measures, or to push yourself for a feat of athletics or stealth." },
            { tier: 4, name: "Adaptive Camo Skin", description: "Blend into your environment seamlessly. People not looking can't see you, take +1d when hiding against characters who are looking for you." },
            { tier: 5, name: "Mental Link", description: "Choose one of your action ratings. When you lead a group action using that action, you can suffer only 1 stress at most regardless of the number of failed rolls." },
            { tier: 5, name: "Frayed Receptors", description: "When you roll a desperate action, you get +1d to your roll if you also take -1d to any resistance rolls against consequences from your action." }
        ],
        friends: [
            { name: "Tabby", description: "a Young Looter" },
            { name: "Desta", description: "a Private Enforcer" },
            { name: "Alexei", description: "a Key-Jammer" },
            { name: "Camilla", description: "a rising Corp Exec" },
            { name: "Lyric", description: "an Info-Fence" }
        ]
    },
    murk: {
        title: "Murk",
        xpTrigger: "You addressed a challenge with perception and precise violence",
        actions: { hunt: 2, recon: 1 },
        items: [
            { name: "Fine Pair of Pistols", load: 1 },
            { name: "Fine Long Rifle", load: 2 },
            { name: "AP Ammo", load: 1 },
            { name: "Lite AI Drone", load: 1, special: true },
            { name: "Drone-Marked Binoculars", load: 1 }
        ],
        augments: [
            { tier: 2, name: "Projected Maps", description: "When you gather info to locate a target, you get +1 effect. When you hide in a prepared position or use camouflage, you get +1d to rolls to avoid detection." },
            { tier: 3, name: "Ruiner Programming", description: "You gain an additional xp trigger: You destroyed someone the voice in your head told you to. If your crew helped you follow directions, also mark crew xp." },
            { tier: 3, name: "Tele-scoped Eyes", description: "You can push yourself to do one of the following: make a ranged attack at extreme distance beyond what's normal for the weapon - unleash a barrage of rapid fire to suppress the enemy." },
            { tier: 3, name: "AI-Link", description: "You can direct your drone with your unconscious mind. Your AI Drone has had some extra attachments added to it. Gain one of the following Edges: swift-flyer, armed, armored, tooled." },
            { tier: 4, name: "Encrypted Lower-Networks", description: "You know what it's like in the deepest recesses of the city. Roll your stash and Acquire Asset rolls get +1d when you are in an impoverished district of the city. You get +1 stress box." },
            { tier: 5, name: "Pain Inhibitors", description: "Penalties from harm are one level less severe (though level 4 harm is still fatal)." }
        ],
        friends: [
            { name: "Mongoose", description: "a CorpWar Veteran" },
            { name: "Jag", description: "a Bouncer" },
            { name: "Subi", description: "an Aug Doc" },
            { name: "Zdeno", description: "a Corporate Spy" },
            { name: "Aziza", description: "a Corp Tracker" }
        ]
    },
    street_warrior: {
        title: "Street Warrior",
        xpTrigger: "You addressed a challenge with martial prowess and audacity",
        actions: { brawl: 2, dominate: 1 },
        items: [
            { name: "Fine Hand Weapon", load: 1 },
            { name: "Fine Long Hand-Weapon", load: 2 },
            { name: "Fine Heavy Weapon", load: 2 },
            { name: "Binds and Cables", load: 1, special: true }
        ],
        augments: [
            { tier: 2, name: "Dulled Receptors", description: "When you trade a worse position for increased effect, take +1d." },
            { tier: 2, name: "Androstenone Emitters", description: "When you unleash physical violence, it's especially frightening. When you Dominate a frightened target, take +1d." },
            { tier: 2, name: "Bladed", description: "You have a melee weapon permanently affixed to one of your limbs, it cannot be lost unless the limb is too." },
            { tier: 3, name: "Temporal Dilation", description: "Gain Special Armor to ignore harm from dodging bullets or to push yourself when traversing through danger." },
            { tier: 3, name: "Boosted Servos", description: "Your load limits are higher. Light: 5. Normal: 7. Heavy: 8." },
            { tier: 4, name: "Replaceable Parts", description: "Permanently fill 1 tick of your healing clock. Get +1d when making the Recovery downtime action." },
            { tier: 4, name: "Kodama Pacification Programming", description: "You can push yourself to do one of the following: perform a feat of physical force that verges on the superhuman - engage a small gang on equal footing in close combat." },
            { tier: 4, name: "Covert Morningstar Compartments", description: "You have a weapon hidden inside one of your limbs. It costs 0 load." }
        ],
        friends: [
            { name: "Ounce", description: "a Runner" },
            { name: "Merde", description: "a Killer For Hire" },
            { name: "Winston", description: "a Corpo Merc" },
            { name: "XOXO", description: "a Black-Mailer" },
            { name: "Swivel", description: "a Pusher" }
        ]
    }
};
// Dark City, Shining Babel - Crew Type Data
// Data structure for auto-populating crew abilities, cohorts, and upgrades
// =============================================================================
// CREW TYPE DATA
// =============================================================================
const CREW_DATA = {
    // =========================================================================
    // FIREBRANDS - The Revolution is Electric
    // Starting: Hidden, Cohort: Rooks
    // =========================================================================
    firebrands: {
        title: "Firebrands",
        xpTrigger: "You struck a blow against the Oppressors or advanced your ideology",
        abilities: [
            {
                name: "Cracks in the Tower",
                description: "Each PC may add +1 action rating to Dominate, Vandalize or Tamper."
            },
            {
                name: "True Believers",
                description: "When the crew successfully harms their Oppressor, each PC's first Indulge Vice roll gains +1d and cannot over indulge."
            },
            {
                name: "Rage Capital",
                description: "When you manipulate a person or group's long running frustration into an act of violence, take increased effect and +1d."
            },
            {
                name: "Martyrdom",
                description: "When people think a peaceful bystander is killed by your Oppressors, -2 score Heat."
            },
            {
                name: "Idealogues",
                description: "Your cohorts are willing to lay down their lives and the lives of others for the sake of The Cause, no matter what. Give them the tag Loyal. They gain +1d when acting against your Oppressor."
            },
            {
                name: "Into the Crowd",
                description: "+1d on Disengagement Rolls. On a Failed roll, choose 2 instead of all 3."
            },
            {
                name: "Patron",
                description: "When you advance your Tier, it costs half the coin it normally would. Who is your patron? Why do they help you?"
            }
        ],
        cohorts: [
            {
                name: "Rooks",
                type: "clubs",
                tags: "Thugs",
                edges: "",
                flaws: ""
            }
        ],
        upgrades: {
            checkboxes: ["lair_hidden"],
            multi: {}
        },
        typeUpgrades: [
            { name: "Beat Down but Unbroken", description: "+1 Trauma Box", levels: 3 },
            { name: "Revolutionary Rigging", description: "2 free load of documents and implements" },
            { name: "Prohibited Library", description: "Acts as a workshop for documents and provides +1d for Gathering Info rolls" },
            { name: "System Adaptation", description: "Filling Personal XP now expands a crew member's augment capacity by 2 instead of 1", levels: 2 },
            { name: "Elite Rooks", description: "Your Rooks cohort gains +1 quality" },
            { name: "Elite Thugs", description: "Your Thugs cohorts gain +1 quality" }
        ],
        contacts: [
            { name: "Bad Faith", description: "violent accelerationist" },
            { name: "Lantier", description: "corporate Saboteur" },
            { name: "Heintz", description: "info runner" },
            { name: "X", description: "controversial musician" },
            { name: "Virgil", description: "Well academic" },
            { name: "Narrow", description: "escaped Ruiner" }
        ],
        claims: [
            // Row 1: positions 1-5
            { name: "Allyship", benefit: "Your Rooks get +1 Scale" },
            { name: "Inflamatory Bar", benefit: "Roll = Tier (Highest Roll - Heat = Coin)" },
            { name: "Looting", benefit: "+2 Coin from Direct Action Scores" },
            { name: "Turf", benefit: "" },
            { name: "Believer on the Inside", benefit: "+1d to Infiltration Engagement Plans" },
            // Row 2: positions 6-7 (8 is Lair)
            { name: "Expansion", benefit: "Add Another Area of Change to your Belief" },
            { name: "Turf", benefit: "" },
            // Row 2: positions 9-10
            { name: "Turf", benefit: "" },
            { name: "Expansion", benefit: "Add Another Area of Change to your Belief" },
            // Row 3: positions 11-15
            { name: "In Every Feed", benefit: "+1 Rep on Every Score Targeting your Oppressor" },
            { name: "Static", benefit: "+1d on Reduce Heat Rolls" },
            { name: "Gathering Hall", benefit: "+1d to Dominate & Sway on site" },
            { name: "Operation Studio", benefit: "Your Cohorts get 1 free downtime action" },
            { name: "Multiple Fronts", benefit: "Add Another Area of Change to your Belief" }
        ],
        // Claim connections: [from, to] pairs (8 = Lair)
        // Firebrands: Full grid - all adjacent cells connected
        claimConnections: [
            [1, 2], [2, 3], [3, 4], [4, 5],
            [6, 7], [7, 8], [8, 9], [9, 10],
            [11, 12], [12, 13], [13, 14], [14, 15],
            [1, 6], [6, 11], [2, 7], [7, 12],
            [3, 8], [8, 13], [4, 9], [9, 14], [5, 10], [10, 15]
        ]
    },
    // =========================================================================
    // LEECHES - Vice Dealers
    // Starting: Secure, Training: Resolve
    // =========================================================================
    leeches: {
        title: "Leeches",
        xpTrigger: "You executed a deal or expanded your clientele or supply chain",
        abilities: [
            {
                name: "Silver Tongues",
                description: "Each PC may add +1 action rating to Dominate, Consort, or Sway (up to a max rating of 3)."
            },
            {
                name: "Coalition",
                description: "Sometimes friends are as good as territory. You may count up to three +3 faction statuses you hold as if they are turf."
            },
            {
                name: "The Good Stuff",
                description: "Your merchandise is exquisite. The product quality is equal to your Tier+2. When you deal with a crew or faction, the GM will tell you who among them is hooked on your product (one, a few, many, or all)."
            },
            {
                name: "Brand Recognition",
                description: "When you take heat as a consequence, your crew also gains +1 Rep."
            },
            {
                name: "High Society",
                description: "It's all about who you know. Take -1 heat during downtime and +1d to gather info about the city's elite."
            },
            {
                name: "Hooked",
                description: "Your gang members use your product. Add the savage, unreliable, or wild flaw to your gangs to give them +1 quality."
            },
            {
                name: "Patron",
                description: "When you advance your Tier, it costs half the coin it normally would. Who is your patron? Why do they help you?"
            }
        ],
        cohorts: [],
        upgrades: {
            checkboxes: ["train_resolve"],
            multi: { "lair_secure": 1 }
        },
        typeUpgrades: [
            { name: "Composed", description: "+1 Stress Box", levels: 3 },
            { name: "Leech's Rigging", description: "1 Item has no load and is concealed" },
            { name: "Friends on the Inside", description: "+1 Tier in The Slab" },
            { name: "System Adaptation", description: "Filling Personal XP now expands a crew member's augment capacity by 2 instead of 1", levels: 2 },
            { name: "Elite Rooks", description: "Your Rooks cohort gains +1 quality" },
            { name: "Elite Thugs", description: "Your Thugs cohorts gain +1 quality" }
        ],
        contacts: [
            { name: "Silk", description: "wandering vendor" },
            { name: "Astko", description: "Slab Agent" },
            { name: "Khalil", description: "Corporate Courier" },
            { name: "Rayya", description: "Flotilla Smuggler" },
            { name: "Grif", description: "Mercenary Captain" },
            { name: "Noble", description: "sleazy Marketer" }
        ],
        claims: [
            // Row 1: positions 1-5
            { name: "Turf", benefit: "" },
            { name: "Cheap Labor", benefit: "Treat Upkeep as 1 Tier Lower" },
            { name: "Local Graft", benefit: "+2 coin for show of force or socialize" },
            { name: "Turf", benefit: "" },
            { name: "Sell in the Circle", benefit: "(Tier roll) - Heat = coin in downtime" },
            // Row 2: positions 6-7 (8 is Lair)
            { name: "Lookouts", benefit: "+1d to Survey or Hunt on your turf" },
            { name: "Turf", benefit: "" },
            // Row 2: positions 9-10
            { name: "Turf", benefit: "" },
            { name: "Luxury Venue", benefit: "+1d to Consort and Sway on site" },
            // Row 3: positions 11-15
            { name: "Informants", benefit: "+1d gather info for scores" },
            { name: "Vice Den", benefit: "(Tier roll) - Heat = coin in downtime" },
            { name: "Surplus Caches", benefit: "+2 coin for product sale or supply" },
            { name: "Cover Operation", benefit: "-2 heat per score" },
            { name: "Cover Identities", benefit: "+1d engagement for deception and transport plans" }
        ],
        // Claim connections: [from, to] pairs (8 = Lair)
        // Leeches: Full grid - all adjacent cells connected
        claimConnections: [
            [1, 2], [2, 3], [3, 4], [4, 5],
            [6, 7], [7, 8], [8, 9], [9, 10],
            [11, 12], [12, 13], [13, 14], [14, 15],
            [1, 6], [6, 11], [2, 7], [7, 12],
            [3, 8], [8, 13], [4, 9], [9, 14], [5, 10], [10, 15]
        ]
    },
    // =========================================================================
    // RUNNERS - Corporate Sellouts
    // Starting: Quality: Weapons, Training: Grit
    // =========================================================================
    runners: {
        title: "Runners",
        xpTrigger: "You completed a contract or acquired new clients or resources",
        abilities: [
            {
                name: "Precision",
                description: "Each PC may add +1 action rating to Hunt, Skulk, or Brawl (up to a max rating of 3)."
            },
            {
                name: "Planned Cover-Up",
                description: "When resisting Consequences for the Heat Gauge or flashing back to reduce the Heat Gauge, take +1d."
            },
            {
                name: "Tools of the Trade",
                description: "When Acquiring an Asset take +1d and increase effect by 1."
            },
            {
                name: "No Traces",
                description: "When you keep an operation quiet or make it look like an accident, you get half the rep value of the target (round up) instead of zero. When you end downtime with zero heat, take +1 rep."
            },
            {
                name: "Clean Entry",
                description: "When you use stealth or subterfuge to \"Secure\" Personnel or Steal Info, take +1d to the engagement roll."
            },
            {
                name: "Clean Getaway",
                description: "Take +1d when rolling the Disengagement Roll."
            },
            {
                name: "Patron",
                description: "When you advance your Tier, it costs half the coin it normally would. Who is your patron? Why do they help you?"
            }
        ],
        cohorts: [],
        upgrades: {
            checkboxes: ["qual_weapons", "train_grit"],
            multi: {}
        },
        typeUpgrades: [
            { name: "Resilient", description: "+1 Trauma Box", levels: 3 },
            { name: "Runner Rigging", description: "2 free load of weapons and gear" },
            { name: "AI Backup", description: "The 1st time a PC would die or permanently trauma out, instead load their backup into a cybernetic shell. Lose 2 actions or 1 augment.", levels: 3 },
            { name: "System Adaptation", description: "Filling Personal XP now expands a crew member's augment capacity by 2 instead of 1", levels: 2 },
            { name: "Elite Thugs", description: "Your Thugs cohorts gain +1 quality" },
            { name: "Corporate Contacts", description: "+1 Tier in Prison" }
        ],
        contacts: [
            { name: "Mr. Johnson", description: "go-between" },
            { name: "Faridah", description: "Weapon Researcher" },
            { name: "Nasiff", description: "Uploaded Consciousness" },
            { name: "Gunther", description: "cybernetic veteran" },
            { name: "Kayabuki", description: "Lawyer" },
            { name: "Zhue", description: "prosthetic radical" }
        ],
        claims: [
            // Row 1: positions 1-5
            { name: "No Teams", benefit: "When doing a Gig against an Ally, gain +1d" },
            { name: "Trusting Employer", benefit: "Take the lowest result for entanglement rolls" },
            { name: "Bargaining Table", benefit: "When taking a job with a recurring client, +1d" },
            { name: "Payoff", benefit: "(Tier roll) - Heat = Coin in downtime" },
            { name: "People Disappear", benefit: "'Killing' Payout Heat is reduced by 1" },
            // Row 2: positions 6-7 (8 is Lair)
            { name: "Turf", benefit: "" },
            { name: "Turf", benefit: "" },
            // Row 2: positions 9-10
            { name: "Turf", benefit: "" },
            { name: "Media Cover Up", benefit: "-2 Heat Per Score" },
            // Row 3: positions 11-15
            { name: "Mil-Tech Plate", benefit: "Both Armor & Heavy Armor cost 1 Less Load" },
            { name: "Neuropozyne", benefit: "+1d to Healing Rolls" },
            { name: "New Gear", benefit: "+1d when designing and building cybernetics" },
            { name: "Turf", benefit: "" },
            { name: "Sensationalism", benefit: "+1 Rep per score" }
        ],
        // Claim connections: [from, to] pairs (8 = Lair)
        // Runners has gaps: no 1↔6, no 5↔10, no 6↔11
        claimConnections: [
            [1, 2], [2, 3], [3, 4], [4, 5],
            [6, 7], [7, 8], [8, 9], [9, 10],
            [11, 12], [12, 13], [13, 14], [14, 15],
            [2, 7], [7, 12],
            [3, 8], [8, 13],
            [4, 9], [9, 14],
            [10, 15]
        ]
    },
    // =========================================================================
    // ZOKUS - Midnight Riders and Street Fighters
    // Starting: Rides, Cohort of Rovers
    // =========================================================================
    zokus: {
        title: "Zokus",
        xpTrigger: "You won a race or battle, or seized territory through force",
        abilities: [
            {
                name: "Born Behind the Wheel",
                description: "Gain +1 in Finesse, Vandalize or Dominate."
            },
            {
                name: "The Hook Up",
                description: "When acquiring new augments, take +1d to the roll and increase your result level by 1 tier."
            },
            {
                name: "All Hands",
                description: "During Downtime, one of your cohorts may perform a downtime activity for the crew to acquire an asset or reduce heat; Or they can give you a relevant bonus die on your own actions."
            },
            {
                name: "Reavers",
                description: "When you fight aboard a vehicle, you gain increased effect for vehicle damage and speed. Your cohorts on bikes get Armor."
            },
            {
                name: "Like Part of the Family",
                description: "Create one of your vehicles as a cohort (use the vehicle edges and flaws, below). Its quality is equal to your Tier +1."
            },
            {
                name: "In the Cut",
                description: "+1 Downtime prior to and +1d on engagement for Scores that seize claims."
            },
            {
                name: "Smooth Ride",
                description: "Gain +1d resistance rolls involving consequences from rolls regarding vehicles."
            }
        ],
        cohorts: [
            {
                name: "Rovers",
                type: "couriers",
                tags: "Drivers, Vehicles",
                edges: "",
                flaws: ""
            }
        ],
        upgrades: {
            checkboxes: [],
            multi: { "lair_rides": 1 }
        },
        typeUpgrades: [
            { name: "Zokus Rigging", description: "2 free load of tools or weapons" },
            { name: "Contacts in The Slab", description: "Your tier counts as 1 higher when surviving The Slab" },
            { name: "System Adaptation", description: "Filling Personal XP now expands a crew member's augment capacity by 2 instead of 1", levels: 2 },
            { name: "Elite Rovers", description: "Your Rovers cohort gains +1 quality" },
            { name: "Elite Thugs", description: "Your Thugs cohorts gain +1 quality" },
            { name: "Special Ride", description: "A special vehicle with unique capabilities", levels: 2 },
            { name: "Roaring", description: "+1 Stress Box", levels: 3 }
        ],
        contacts: [
            { name: "Davi", description: "Junker" },
            { name: "Zhuan", description: "club owner" },
            { name: "Balli", description: "'doctor'" },
            { name: "Hen", description: "middle manager" },
            { name: "Kai", description: "transient" },
            { name: "Bells", description: "razer-girl" }
        ],
        claims: [
            // Row 1: positions 1-5
            { name: "Barracks", benefit: "+1 Scale for your cohorts" },
            { name: "Med Room", benefit: "+1d to healing rolls" },
            { name: "Informants", benefit: "+1d Gather Info on Scores" },
            { name: "Turf", benefit: "" },
            { name: "Scrapper Team", benefit: "+2 coin for lower class targets" },
            // Row 2: positions 6-7 (8 is Lair)
            { name: "Turf", benefit: "" },
            { name: "Turf", benefit: "" },
            // Row 2: positions 9-10
            { name: "Turf", benefit: "" },
            { name: "Gear to Go Around", benefit: "Your cohorts have their own rides" },
            // Row 3: positions 11-15
            { name: "Protection Racket", benefit: "(Tier Roll) - heat = Coin in Downtime" },
            { name: "Intimidation", benefit: "-2 Heat Per Score" },
            { name: "Clout", benefit: "+2 Coin for battle and extortion operations" },
            { name: "All Eyes", benefit: "Gain Rep in Payout = Wanted Level" },
            { name: "On Me", benefit: "Gain Crew Downtime Actions = Wanted Level" }
        ],
        // Claim connections: [from, to] pairs (8 = Lair)
        // Zokus: Full grid - all adjacent cells connected
        claimConnections: [
            [1, 2], [2, 3], [3, 4], [4, 5],
            [6, 7], [7, 8], [8, 9], [9, 10],
            [11, 12], [12, 13], [13, 14], [14, 15],
            [1, 6], [6, 11], [2, 7], [7, 12],
            [3, 8], [8, 13], [4, 9], [9, 14], [5, 10], [10, 15]
        ]
    }
};
// Dark City, Shining Babel - Faction Data
// Data structure for the Factions tab - relationships with Babel's power players
// =============================================================================
// UTILITY FUNCTIONS
// =============================================================================
/**
 * Convert numeric tier to Roman numeral display
 */
const tierToRoman = (tier) => {
    const romanNumerals = {
        1: 'I',
        2: 'II',
        3: 'III',
        4: 'IV',
        5: 'V',
        6: 'VI'
    };
    return romanNumerals[tier] || tier.toString();
};
// =============================================================================
// FACTION DATA
// =============================================================================
const FACTION_DATA = [
    // =========================================================================
    // CORPS - MAJOR (7 factions)
    // The biggest corporate players in Babel
    // =========================================================================
    {
        name: "Corps (Major)",
        key: "corpsmajor",
        factions: [
            {
                name: "The Council",
                tier: 6,
                tierDisplay: "VI",
                description: "The top 8 corps maintaining hegemony across Babel",
                category: "corps"
            },
            {
                name: "Morningstar",
                tier: 5,
                tierDisplay: "V",
                description: "Military-tech security teams, private armies for hire",
                category: "corps"
            },
            {
                name: "Cronus Construction",
                tier: 5,
                tierDisplay: "V",
                description: "Mega-scale construction and infrastructure",
                category: "corps"
            },
            {
                name: "Kodama Munitions",
                tier: 4,
                tierDisplay: "IV",
                description: "Military and prison-labor weapon manufacturer",
                category: "corps"
            },
            {
                name: "World Valley Medical",
                tier: 4,
                tierDisplay: "IV",
                description: "Microsoft-y cybernetics provider, basic replacement limbs",
                category: "corps"
            },
            {
                name: "Nobusama Logistics",
                tier: 4,
                tierDisplay: "IV",
                description: "Shipping, transport, and supply chain operations",
                category: "corps"
            },
            {
                name: "Nutrition Unlimited",
                tier: 4,
                tierDisplay: "IV",
                description: "Food production and distribution megacorp",
                category: "corps"
            }
        ]
    },
    // =========================================================================
    // CORPS - MINOR (7 factions)
    // Smaller but still significant corporate entities
    // =========================================================================
    {
        name: "Corps (Minor)",
        key: "corpsminor",
        factions: [
            {
                name: "WyndCom",
                tier: 4,
                tierDisplay: "IV",
                description: "Air and space travel leader, cheap fast and sleek",
                category: "corps"
            },
            {
                name: "NERPS!",
                tier: 3,
                tierDisplay: "III",
                description: "Tesla with flamethrowers and weed. Oxygen bars, cool kid augments",
                category: "corps"
            },
            {
                name: "Oh-Di",
                tier: 3,
                tierDisplay: "III",
                description: "Omni-Health Directional - healthcare and pharmaceuticals",
                category: "corps"
            },
            {
                name: "Zirinka Computing",
                tier: 3,
                tierDisplay: "III",
                description: "Computing and networking infrastructure",
                category: "corps"
            },
            {
                name: "Takam Housing",
                tier: 3,
                tierDisplay: "III",
                description: "Housing and property development",
                category: "corps"
            },
            {
                name: "Surma School Labs",
                tier: 3,
                tierDisplay: "III",
                description: "Education and research laboratories",
                category: "corps"
            },
            {
                name: "Kinnara Generation",
                tier: 3,
                tierDisplay: "III",
                description: "Power generation and energy infrastructure",
                category: "corps"
            }
        ]
    },
    // =========================================================================
    // THE UNDERWORLD (10 factions)
    // Criminal organizations operating in Babel's shadows
    // =========================================================================
    {
        name: "The Underworld",
        key: "underworld",
        factions: [
            {
                name: "Cyber Monday",
                tier: 3,
                tierDisplay: "III",
                description: "Thieves and brutes who steal augments from corps",
                category: "underworld"
            },
            {
                name: "134º",
                tier: 2,
                tierDisplay: "II",
                description: "Nightclub empire with drug runners in the streets",
                category: "underworld"
            },
            {
                name: "Dark Wire",
                tier: 2,
                tierDisplay: "II",
                description: "Information brokers and data thieves",
                category: "underworld"
            },
            {
                name: "Damage Inc.",
                tier: 2,
                tierDisplay: "II",
                description: "Mercenary outfit, violence for hire",
                category: "underworld"
            },
            {
                name: "Bomb Threat",
                tier: 1,
                tierDisplay: "I",
                description: "Demolitions specialists and anarchist bombers",
                category: "underworld"
            },
            {
                name: "Quicksilver",
                tier: 2,
                tierDisplay: "II",
                description: "Fast couriers and smugglers",
                category: "underworld"
            },
            {
                name: "Fleece",
                tier: 2,
                tierDisplay: "II",
                description: "Con artists and grifters",
                category: "underworld"
            },
            {
                name: "Math Squad",
                tier: 2,
                tierDisplay: "II",
                description: "Number runners and gambling operations",
                category: "underworld"
            },
            {
                name: "Red Leather",
                tier: 3,
                tierDisplay: "III",
                description: "Flesh trade and pleasure industry",
                category: "underworld"
            },
            {
                name: "High Water",
                tier: 3,
                tierDisplay: "III",
                description: "Water smugglers and flood zone operators",
                category: "underworld"
            }
        ]
    },
    // =========================================================================
    // FRINGE & LABOR (10 factions)
    // Revolutionaries, idealists, and workers' organizations
    // =========================================================================
    {
        name: "Fringe & Labor",
        key: "fringe",
        factions: [
            {
                name: "The Flotilla",
                tier: 3,
                tierDisplay: "III",
                description: "Anarcho-communist boat collective, smugglers of goods and ideas",
                category: "fringe"
            },
            {
                name: "Taxi & Transport",
                tier: 3,
                tierDisplay: "III",
                description: "Ground transportation union",
                category: "labor"
            },
            {
                name: "The Dockers",
                tier: 3,
                tierDisplay: "III",
                description: "Port workers and shipping handlers",
                category: "labor"
            },
            {
                name: "Laborers",
                tier: 3,
                tierDisplay: "III",
                description: "General workers' collective",
                category: "labor"
            },
            {
                name: "Brass Roses",
                tier: 2,
                tierDisplay: "II",
                description: "Revolutionary hacker squad",
                category: "fringe"
            },
            {
                name: "Brahmin",
                tier: 2,
                tierDisplay: "II",
                description: "Religious revivalists and spiritual resistance",
                category: "fringe"
            },
            {
                name: "The Indentured",
                tier: 2,
                tierDisplay: "II",
                description: "Debt-bound workers organizing in secret",
                category: "labor"
            },
            {
                name: "Journos",
                tier: 2,
                tierDisplay: "II",
                description: "Underground journalists and truth-seekers",
                category: "labor"
            },
            {
                name: "Kar Ptiwati",
                tier: 1,
                tierDisplay: "I",
                description: "Thai dissidents and revolutionaries against the corps",
                category: "fringe"
            },
            {
                name: "Cognitive Dissidents",
                tier: 1,
                tierDisplay: "I",
                description: "Anti-tech philosophers and luddites",
                category: "fringe"
            }
        ]
    },
    // =========================================================================
    // CITIZENS (8 factions)
    // The districts and populations of Babel itself
    // =========================================================================
    {
        name: "Citizens",
        key: "citizens",
        factions: [
            {
                name: "New World City",
                tier: 1,
                tierDisplay: "I",
                description: "Immigrant district, fresh arrivals to Babel",
                category: "citizens"
            },
            {
                name: "The Slums",
                tier: 1,
                tierDisplay: "I",
                description: "The poorest district, forgotten by the corps",
                category: "citizens"
            },
            {
                name: "The Slab",
                tier: 2,
                tierDisplay: "II",
                description: "Factory district above, gladiatorial testing below",
                category: "citizens"
            },
            {
                name: "The Kitchen",
                tier: 2,
                tierDisplay: "II",
                description: "Food processing and service district",
                category: "citizens"
            },
            {
                name: "The Town",
                tier: 3,
                tierDisplay: "III",
                description: "Middle-class residential area",
                category: "citizens"
            },
            {
                name: "The Resort",
                tier: 3,
                tierDisplay: "III",
                description: "Entertainment and leisure district",
                category: "citizens"
            },
            {
                name: "The Lux",
                tier: 4,
                tierDisplay: "IV",
                description: "Wealthy residential towers",
                category: "citizens"
            },
            {
                name: "The Corporate Center",
                tier: 5,
                tierDisplay: "V",
                description: "Gleaming towers of corporate power",
                category: "citizens"
            }
        ]
    }
];
/**
 * Get all factions as a flat array for populating the repeating section
 */
const getAllFactions = () => {
    return FACTION_DATA.flatMap(category => category.factions);
};
/**
 * Get factions by category
 */
const getFactionsByCategory = (categoryKey) => {
    const category = FACTION_DATA.find(cat => cat.key === categoryKey);
    return category ? category.factions : [];
};
// Dark City, Shining Babel - Game Data Constants
// Static data for actions, playbooks, augments, etc.
// =============================================================================
// GAME RULES CONSTANTS
// =============================================================================
// Dice system (Blades in the Dark derived)
const DICE = {
    SIZE: 6,
    ZERO_DICE_COUNT: 2,
    KEEP_HIGHEST: 'kh1',
    KEEP_LOWEST: 'kl1', // Keep lowest 1 (zero dice)
};
// Roll templates
const ROLL_TEMPLATES = {
    ACTION: 'dcsb-action',
    RESISTANCE: 'dcsb-resistance',
    FORTUNE: 'dcsb-fortune',
    VICE: 'dcsb-vice',
};
// Load settings
const LOAD = {
    LIGHT: 3,
    NORMAL: 5,
    HEAVY: 6,
    DEFAULT: 5,
};
// Heat gauge (score tracker)
const HEAT_GAUGE = {
    SEGMENTS: 8,
};
// Stress system
const STRESS = {
    MAX: 9,
    TRAUMA_THRESHOLD: 9,
};
// Trauma system
const TRAUMA = {
    MAX: 4,
};
// Augments (formerly Cybernetics) - use maintenance clocks instead of capacity
const MAINTENANCE = {
    CLOCK_SIZE: 4, // 4 ticks per maintenance clock
};
// =============================================================================
// UTILITY FUNCTIONS
// =============================================================================
/**
 * Build a roll formula for the Blades dice system
 * @param diceCount - Number of action dots (0 = disadvantage)
 * @returns Roll20 roll formula string
 */
const buildRollFormula = (diceCount) => {
    if (diceCount > 0) {
        return `${diceCount}d${DICE.SIZE}${DICE.KEEP_HIGHEST}`;
    }
    return `${DICE.ZERO_DICE_COUNT}d${DICE.SIZE}${DICE.KEEP_LOWEST}`;
};
/**
 * Capitalize first letter of string
 */
const capitalize = (s) => s.charAt(0).toUpperCase() + s.slice(1);
// =============================================================================
// CHARACTER DATA
// =============================================================================
// Attributes and their associated actions
const ATTRIBUTES = {
    acuity: ['hack', 'recon', 'scrutinize', 'tamper'],
    grit: ['brawl', 'hunt', 'skulk', 'vandalize'],
    resolve: ['consort', 'dominate', 'finesse', 'sway']
};
// All 12 actions
const ACTIONS = [
    'brawl', 'consort', 'dominate', 'finesse',
    'hack', 'hunt', 'recon', 'scrutinize',
    'skulk', 'sway', 'tamper', 'vandalize'
];
// Playbooks
const PLAYBOOKS = [
    'face', 'fixer', 'hacker', 'midnighter', 'murk', 'street_warrior'
];
// Crew types
const CREW_TYPES = [
    'firebrands', 'leeches', 'runners', 'zokus'
];
// Heritage options
const HERITAGES = [
    'babel', 'sub_cities', 'the_well', 'the_jungle', 'the_syndicate', 'labor_colonies'
];
// Background options
const BACKGROUNDS = [
    'entertainment', 'law', 'labor', 'corporate', 'underworld', 'fringe'
];
// Vice types
const VICES = [
    'faith', 'gambling', 'luxury', 'obligation', 'pleasure', 'stupor', 'weird'
];
// Augment tiers
const AUGMENT_TIERS = [2, 3, 4, 5];
// Standard item loads (fixed values) - matches The New Babel
// Maps base item name to its total load value (for reference)
const STANDARD_ITEMS = {
    item_knife: 1,
    item_large_weapon: 2,
    item_reload: 1,
    item_unusual_weapon: 1,
    item_datapad: 1,
    item_armor: 2,
    item_heavy: 1,
    item_infiltration: 1,
    item_hacking: 2,
    item_climbing: 2,
    item_demolition: 2,
    item_tampering: 1,
    item_subterfuge: 1,
    item_documents: 1,
    item_flashlight: 1,
    item_modification: 1
};
// Standard item load checkbox attributes (each checked box = 1 load)
// Generated from STANDARD_ITEMS: item_X with load N gets item_X_1 through item_X_N
const STANDARD_ITEM_LOAD_ATTRS = (() => {
    const attrs = [];
    for (const [item, load] of Object.entries(STANDARD_ITEMS)) {
        for (let i = 1; i <= load; i++) {
            attrs.push(`${item}_${i}`);
        }
    }
    return attrs;
})();
// All attribute names
const ATTRIBUTE_NAMES = ['acuity', 'grit', 'resolve'];
// =============================================================================
// CREW UPGRADE ATTRIBUTES
// =============================================================================
// Single-level upgrade checkboxes
const CREW_UPGRADES_SINGLE = [
    'lair_hidden',
    'lair_quarters',
    'lair_workshop',
    'train_acuity',
    'train_grit',
    'train_resolve',
    'train_personal',
    'qual_documents',
    'qual_gear',
    'qual_implements',
    'qual_supplies',
    'qual_tools',
    'qual_weapons'
];
// Multi-level upgrade base names (each has _1, _2, etc.)
const CREW_UPGRADES_MULTI = {
    'lair_rides': 2,
    'lair_specialty': 2,
    'lair_secure': 2,
    'lair_encryption': 2,
    'train_mastery': 4
};
/// <reference path="playbookData.ts" />
/// <reference path="crewData.ts" />
/// <reference path="factionData.ts" />
/// <reference path="constants.ts" />
// Dark City, Shining Babel - Sheet Worker Calculations
// Auto-calculation functions for derived values
// =============================================================================
// UTILITY FUNCTIONS
// =============================================================================
/**
 * Parse integer with default value
 */
const int = (val, def = 0) => parseInt(val || '') || def;
/**
 * Count sixes in a dice roll result
 * Roll20 dice array is plain numbers: [3, 6, 2, 6] per the wiki
 * @param dice - Array of die results from Roll20
 * @returns Number of 6s rolled
 */
const countSixes = (dice) => dice.filter(d => d === DICE.SIZE).length;
/**
 * Check if roll is a critical (2+ sixes)
 * @param dice - Array of die results from Roll20
 * @returns true if critical, false otherwise
 */
const isCrit = (dice) => countSixes(dice) >= 2;
/**
 * Get action roll label with typography emphasis for crits
 */
const getActionLabel = (result, crit) => {
    if (crit)
        return '!! CRITICAL !!';
    if (result >= 6)
        return 'SUCCESS';
    if (result >= 4)
        return 'PARTIAL';
    return 'FAILURE';
};
/**
 * Get fortune roll label with typography emphasis for crits
 */
const getFortuneLabel = (result, crit) => {
    if (crit)
        return '!! CRITICAL !!';
    if (result >= 6)
        return 'BEST OUTCOME';
    if (result >= 4)
        return 'MIXED RESULT';
    return 'POOR OUTCOME';
};
/**
 * Get resistance roll stress message
 */
const getStressMessage = (result, crit) => {
    if (crit)
        return '!! CRITICAL !! Clear 1 stress';
    if (result >= 6)
        return 'No stress (rolled 6)';
    const stress = 6 - result;
    return `Take ${stress} stress`;
};
/**
 * Get vice roll label
 * Overindulgence occurs when roll > current stress (would reduce below 0)
 * @param highestDie - The highest die result
 * @param stress - Current stress level
 * @param crit - Whether it was a critical (double 6s)
 */
const getViceLabel = (highestDie, stress, crit) => {
    const overindulge = highestDie > stress;
    if (crit && overindulge)
        return '!! OVERINDULGENCE (CRIT) !!';
    if (crit)
        return '!! CRITICAL !!';
    if (overindulge)
        return '!! OVERINDULGENCE !!';
    return 'CLEAR STRESS';
};
/**
 * Get disengagement roll label
 * 1-3: Bad (2 entanglements AND -2 coin)
 * 4-5: Mixed (choose one penalty)
 * 6: Clean getaway
 * Crit: Perfect escape
 */
const getDisengageLabel = (result, crit) => {
    if (crit)
        return '!! CRITICAL !! Perfect escape';
    if (result >= 6)
        return 'CLEAN GETAWAY';
    if (result >= 4)
        return 'MIXED - Choose one penalty';
    return 'BAD - Both penalties';
};
/**
 * Get engagement roll label
 * 1-3: Bad start (disadvantage)
 * 4-5: Risky start (standard)
 * 6: Controlled start (advantage)
 * Crit: Controlled + edge
 */
const getEngagementLabel = (result, crit) => {
    if (crit)
        return '!! CRITICAL !! Controlled + Edge';
    if (result >= 6)
        return 'CONTROLLED START';
    if (result >= 4)
        return 'RISKY START';
    return 'BAD START';
};
/**
 * Get maintenance failure roll label (takes LOWEST die)
 * Crit: Next downtime maintenance costs 0 BC
 * 6: Everything still working
 * 4-5: Player chooses augments to lose access to
 * 1-3: GM secretly chooses augments that will fail during score
 */
const getMaintenanceLabel = (result, crit) => {
    if (crit)
        return '!! CRITICAL !! Free maintenance next downtime';
    if (result >= 6)
        return 'STILL WORKING';
    if (result >= 4)
        return 'CHOOSE FAILURES';
    return 'GM CHOOSES FAILURES';
};
/**
 * Execute a roll with position, effect, and dice modifier applied
 * Resets all roll context to defaults after rolling
 * @param baseAttrNames - Attributes needed for the roll (excluding roll context)
 * @param getDiceCount - Function to calculate base dice from attributes
 * @param rollFn - Function that performs the roll given (finalDice, attrs, context)
 */
const rollWithModifier = (baseAttrNames, getDiceCount, rollFn) => {
    getAttrs([...baseAttrNames, 'roll_modifier', 'roll_position', 'roll_effect'], v => {
        const baseDice = getDiceCount(v);
        const mod = int(v.roll_modifier);
        const finalDice = baseDice + mod;
        // Get position and effect
        const position = v.roll_position || 'risky';
        const effect = v.roll_effect || 'standard';
        // Build modifier note for display
        let modNotes = '';
        if (mod > 0)
            modNotes = `+${mod}d`;
        else if (mod < 0)
            modNotes = `${mod}d`;
        // Reset all roll context to defaults for next roll
        setAttrs({
            roll_modifier: '0',
            roll_position: 'risky',
            roll_effect: 'standard'
        }, { silent: true });
        const context = { position, effect, diceMod: mod, modNotes };
        rollFn(finalDice, v, context);
    });
};
/**
 * Set attributes only if they've changed (reduces API calls)
 */
const mySetAttrs = (setting, v, options, callback) => {
    const finalSetting = {};
    for (const key in setting) {
        if (String(v[key]) !== String(setting[key])) {
            finalSetting[key] = setting[key];
        }
    }
    if (Object.keys(finalSetting).length > 0) {
        setAttrs(finalSetting, options, callback);
    }
    else if (callback) {
        callback();
    }
};
// =============================================================================
// PLAYBOOK POPULATION FUNCTIONS
// =============================================================================
/**
 * Set starting action dots for a playbook (only if currently 0)
 */
const setStartingActions = (actions) => {
    const actionNames = Object.keys(actions);
    getAttrs(actionNames, v => {
        const updates = {};
        for (const [action, dots] of Object.entries(actions)) {
            // Only set if action is currently 0 or undefined
            if (!v[action] || parseInt(v[action]) === 0) {
                updates[action] = dots;
            }
        }
        if (Object.keys(updates).length > 0) {
            setAttrs(updates);
        }
    });
};
/**
 * Clear auto-generated rows and populate new ones
 * Uses "autogen" flag to distinguish from user-created rows
 */
const clearAndPopulateRepeatingSection = (section, items, formatter) => {
    getSectionIDs(`repeating_${section}`, ids => {
        // Get all autogen flags
        const autogenAttrs = ids.map(id => `repeating_${section}_${id}_autogen`);
        getAttrs(autogenAttrs, v => {
            // Remove only auto-generated rows
            ids.forEach(id => {
                if (v[`repeating_${section}_${id}_autogen`] === "1") {
                    removeRepeatingRow(`repeating_${section}_${id}`);
                }
            });
            // Add new items with autogen flag
            items.forEach(item => {
                const rowId = generateRowID();
                const attrs = formatter(item, rowId);
                attrs[`repeating_${section}_${rowId}_autogen`] = "1";
                setAttrs(attrs);
            });
        });
    });
};
/**
 * Format a playbook item for the repeating_items section
 * Sets visibility for load box 2 based on item load value
 * Special items (italicized in rulebook) are free - don't count toward load
 */
const formatPlaybookItem = (item, rowId) => {
    return {
        [`repeating_items_${rowId}_item_name`]: item.name,
        [`repeating_items_${rowId}_item_load_1`]: "0",
        [`repeating_items_${rowId}_item_load_2`]: "0",
        // Show load box 2 only for items with load >= 2
        [`repeating_items_${rowId}_item_show_load_2`]: item.load >= 2 ? "1" : "0",
        // Special items are free (don't count toward load) - marked for CSS styling
        [`repeating_items_${rowId}_item_special`]: item.special ? "1" : "0"
    };
};
/**
 * Format an augment for the repeating section
 */
const formatAugment = (augment, rowId) => {
    return {
        [`repeating_augments_${rowId}_augment_tier`]: augment.tier.toString(),
        [`repeating_augments_${rowId}_augment_name`]: augment.name,
        [`repeating_augments_${rowId}_augment_desc`]: augment.description
    };
};
/**
 * Populate friend slots from playbook data
 * Friends are fixed attributes (friend_1_name, etc.) not a repeating section
 */
const populateFriends = (friends) => {
    const updates = {};
    // Populate up to 5 friend slots
    for (let i = 0; i < 5; i++) {
        const friendNum = i + 1;
        if (friends[i]) {
            updates[`friend_${friendNum}_name`] = friends[i].name;
            updates[`friend_${friendNum}_desc`] = friends[i].description;
        }
        else {
            // Clear slot if no friend data
            updates[`friend_${friendNum}_name`] = '';
            updates[`friend_${friendNum}_desc`] = '';
        }
    }
    setAttrs(updates);
};
/**
 * Reset friend relations to neutral (used on playbook reset)
 */
const resetFriendRelations = () => {
    const updates = {};
    for (let i = 1; i <= 5; i++) {
        updates[`friend_${i}_relation`] = 'neutral';
    }
    setAttrs(updates);
};
/**
 * Handle playbook change - populate XP trigger, items, augments, friends (NOT actions)
 * Actions are only set via explicit reset to preserve advanced characters
 */
const handlePlaybookChange = (newPlaybook) => {
    if (!newPlaybook || !PLAYBOOK_DATA[newPlaybook])
        return;
    const data = PLAYBOOK_DATA[newPlaybook];
    // 1. Set XP trigger and playbook-specific visibility flags
    setAttrs({
        xp_trigger: data.xpTrigger,
        // Show chipsets section only for Hacker playbook
        show_chipsets: newPlaybook === 'hacker' ? '1' : '0'
    });
    // 2. Clear old autogen items, populate new ones
    clearAndPopulateRepeatingSection("items", data.items, formatPlaybookItem);
    // 3. Clear old autogen augments, populate new ones
    clearAndPopulateRepeatingSection("augments", data.augments, formatAugment);
    // 4. Populate friends from playbook data
    populateFriends(data.friends);
    // Note: Actions are NOT set here - use Reset to Playbook Defaults for that
};
/**
 * Reset character to playbook defaults - clears everything and sets starting actions
 * Used for new characters or when explicitly resetting
 */
const resetToPlaybookDefaults = () => {
    getAttrs(['playbook', 'character_name'], v => {
        const playbook = v.playbook;
        const charName = v.character_name || 'Character';
        if (!playbook || !PLAYBOOK_DATA[playbook]) {
            // No playbook selected - notify via chat
            startRoll(`&{template:dcsb-fortune} {{charname=${charName}}} {{roll=[[0d6]]}} {{notes=Select a playbook first before resetting.}}`, results => finishRoll(results.rollId, {}));
            return;
        }
        const data = PLAYBOOK_DATA[playbook];
        // 1. Reset all 12 actions to 0
        const actionReset = {};
        ACTIONS.forEach(action => {
            actionReset[action] = 0;
        });
        setAttrs(actionReset);
        // 2. Set starting actions for this playbook
        setAttrs(data.actions);
        // 3. Set XP trigger and playbook-specific visibility flags
        setAttrs({
            xp_trigger: data.xpTrigger,
            show_chipsets: playbook === 'hacker' ? '1' : '0'
        });
        // 4. Clear ALL items (autogen and user-created) and repopulate
        clearAllAndPopulateRepeatingSection("items", data.items, formatPlaybookItem);
        // 5. Clear ALL augments (autogen and user-created) and repopulate
        clearAllAndPopulateRepeatingSection("augments", data.augments, formatAugment);
        // 6. Populate friends and reset their relations
        populateFriends(data.friends);
        resetFriendRelations();
        // 7. Notify success via chat
        startRoll(`&{template:dcsb-fortune} {{charname=${charName}}} {{roll=[[0d6]]}} {{notes=Reset to ${data.title} defaults complete.}}`, results => finishRoll(results.rollId, {}));
    });
};
/**
 * Clear ALL rows in a repeating section (not just autogen) and populate new ones
 * Used for full reset
 */
const clearAllAndPopulateRepeatingSection = (section, items, formatter) => {
    getSectionIDs(`repeating_${section}`, ids => {
        // Remove ALL rows
        ids.forEach(id => {
            removeRepeatingRow(`repeating_${section}_${id}`);
        });
        // Add new items with autogen flag
        items.forEach(item => {
            const rowId = generateRowID();
            const attrs = formatter(item, rowId);
            attrs[`repeating_${section}_${rowId}_autogen`] = "1";
            setAttrs(attrs);
        });
    });
};
// =============================================================================
// ATTRIBUTE RATING CALCULATIONS
// =============================================================================
/**
 * Calculate attribute rating as count of actions with at least 1 dot
 */
const calculateAttributeRating = (attribute) => {
    const actions = ATTRIBUTES[attribute];
    if (!actions)
        return;
    const actionList = [...actions];
    const attrs = [...actionList, `${attribute}_rating`];
    getAttrs(attrs, v => {
        const count = actionList.filter(a => int(v[a]) > 0).length;
        mySetAttrs({ [`${attribute}_rating`]: count }, v);
    });
};
/**
 * Recalculate all attribute ratings
 */
const calculateAllAttributeRatings = () => {
    Object.keys(ATTRIBUTES).forEach(attr => calculateAttributeRating(attr));
};
// =============================================================================
// LOAD CALCULATIONS
// =============================================================================
/**
 * Calculate current load from checked items
 * Each checked load box = 1 load
 * Standard items: item_knife_1, item_large_weapon_1, item_large_weapon_2, etc.
 * Playbook items: item_load_1, item_load_2 per repeating row
 * Special items (italicized) are FREE - don't count toward load
 */
const calculateLoad = () => {
    getSectionIDs('repeating_items', ids => {
        // Playbook items have item_load_1, item_load_2, and item_special per row
        const repeatAttrs = ids.flatMap(id => [
            `repeating_items_${id}_item_load_1`,
            `repeating_items_${id}_item_load_2`,
            `repeating_items_${id}_item_special`
        ]);
        getAttrs([...STANDARD_ITEM_LOAD_ATTRS, ...repeatAttrs, 'load', 'load_current', 'load_max'], v => {
            // Sum standard items - each checked checkbox = 1 load
            let total = STANDARD_ITEM_LOAD_ATTRS.reduce((sum, attr) => sum + (v[attr] === '1' ? 1 : 0), 0);
            // Sum playbook items - each checked load box = 1 load
            // BUT skip special items (they're free)
            ids.forEach(id => {
                const isSpecial = v[`repeating_items_${id}_item_special`] === '1';
                if (!isSpecial) {
                    if (v[`repeating_items_${id}_item_load_1`] === '1')
                        total += 1;
                    if (v[`repeating_items_${id}_item_load_2`] === '1')
                        total += 1;
                }
            });
            // Load max from selection (3=Light, 5=Normal, 6=Heavy)
            const loadMax = int(v.load, LOAD.DEFAULT);
            mySetAttrs({
                load_current: total,
                load_max: loadMax
            }, v);
        });
    });
};
// =============================================================================
// AUGMENT MAINTENANCE CALCULATIONS
// =============================================================================
/**
 * Calculate augment maintenance ticks and clocks
 * Total ticks = sum of installed augment tiers
 * Full clocks = floor(total ticks / 4) = BC owed at downtime
 */
const calculateAugmentMaintenance = () => {
    getSectionIDs('repeating_augments', ids => {
        const installedAttrs = ids.map(id => `repeating_augments_${id}_augment_installed`);
        const tierAttrs = ids.map(id => `repeating_augments_${id}_augment_tier`);
        getAttrs([...installedAttrs, ...tierAttrs, 'maintenance_ticks', 'maintenance_clocks'], v => {
            // Sum tiers of installed augments
            let totalTicks = 0;
            ids.forEach(id => {
                if (v[`repeating_augments_${id}_augment_installed`] === '1') {
                    totalTicks += int(v[`repeating_augments_${id}_augment_tier`], 2);
                }
            });
            // Full clocks = BC owed
            const fullClocks = Math.floor(totalTicks / MAINTENANCE.CLOCK_SIZE);
            mySetAttrs({
                maintenance_ticks: totalTicks,
                maintenance_clocks: fullClocks
            }, v);
        });
    });
};
// =============================================================================
// HEAT GAUGE CALCULATIONS (Crew Sheet)
// =============================================================================
/**
 * Calculate heat gauge dice (unticked segments)
 * Uses fakeradio pattern: score_heat stores 0-8 (number of filled segments)
 * Disengage dice = 8 - filled segments
 */
const calculateHeatDice = () => {
    getAttrs(['score_heat', 'score_heat_dice'], v => {
        const filled = int(v.score_heat);
        const dice = HEAT_GAUGE.SEGMENTS - filled;
        mySetAttrs({ score_heat_dice: dice }, v);
    });
};
// =============================================================================
// CREW TYPE POPULATION FUNCTIONS
// =============================================================================
/**
 * Format a crew ability for the repeating_crewabilities section
 */
const formatCrewAbility = (ability, rowId) => {
    return {
        [`repeating_crewabilities_${rowId}_crew_ability_name`]: ability.name,
        [`repeating_crewabilities_${rowId}_crew_ability_desc`]: ability.description,
        [`repeating_crewabilities_${rowId}_crew_ability_taken`]: "0"
    };
};
/**
 * Format a crew cohort for the repeating_cohorts section
 */
const formatCrewCohort = (cohort, rowId) => {
    return {
        [`repeating_cohorts_${rowId}_cohort_name`]: cohort.name,
        [`repeating_cohorts_${rowId}_cohort_type`]: cohort.type,
        [`repeating_cohorts_${rowId}_cohort_tags`]: cohort.tags || "",
        [`repeating_cohorts_${rowId}_cohort_edges`]: cohort.edges || "",
        [`repeating_cohorts_${rowId}_cohort_flaws`]: cohort.flaws || ""
    };
};
/**
 * Format a crew type upgrade for the repeating_crewtypeupgrades section
 */
const formatCrewTypeUpgrade = (upgrade, rowId) => {
    const levels = upgrade.levels || 1;
    return {
        [`repeating_crewtypeupgrades_${rowId}_upgrade_name`]: upgrade.name,
        [`repeating_crewtypeupgrades_${rowId}_upgrade_desc`]: upgrade.description,
        [`repeating_crewtypeupgrades_${rowId}_upgrade_levels`]: String(levels),
        [`repeating_crewtypeupgrades_${rowId}_upgrade_level_1`]: "0",
        [`repeating_crewtypeupgrades_${rowId}_upgrade_level_2`]: "0",
        [`repeating_crewtypeupgrades_${rowId}_upgrade_level_3`]: "0",
        // Control visibility of level 2 and 3 boxes
        [`repeating_crewtypeupgrades_${rowId}_upgrade_show_2`]: levels >= 2 ? "1" : "0",
        [`repeating_crewtypeupgrades_${rowId}_upgrade_show_3`]: levels >= 3 ? "1" : "0"
    };
};
/**
 * Populate crew contact slots from crew type data
 * Contacts are fixed attributes (crew_contact_1_name, etc.) not a repeating section
 */
const populateCrewContacts = (contacts) => {
    const updates = {};
    // Populate up to 6 contact slots
    for (let i = 0; i < 6; i++) {
        const contactNum = i + 1;
        if (contacts[i]) {
            updates[`crew_contact_${contactNum}_name`] = contacts[i].name;
            updates[`crew_contact_${contactNum}_desc`] = contacts[i].description;
        }
        else {
            // Clear slot if no contact data
            updates[`crew_contact_${contactNum}_name`] = '';
            updates[`crew_contact_${contactNum}_desc`] = '';
        }
        // Reset relation to neutral when populating
        updates[`crew_contact_${contactNum}_relation`] = 'neutral';
    }
    setAttrs(updates);
};
/**
 * Populate crew claims from crew type data
 * Claims are fixed attributes (claim_1_name, etc.) in a 5×3 grid
 * Positions 1-7 and 9-15 (position 8 is the Lair, not an attribute)
 */
const populateCrewClaims = (claims) => {
    const updates = {};
    // Map claims array indices to attribute position numbers
    // Array indices 0-6 → positions 1-7
    // Array indices 7-13 → positions 9-15
    const positionMap = [1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15];
    positionMap.forEach((position, index) => {
        if (claims[index]) {
            updates[`claim_${position}_name`] = claims[index].name;
            updates[`claim_${position}_benefit`] = claims[index].benefit;
        }
        else {
            // Clear slot if no claim data
            updates[`claim_${position}_name`] = '';
            updates[`claim_${position}_benefit`] = '';
        }
        // Reset held checkbox when populating
        updates[`claim_${position}_held`] = '0';
    });
    setAttrs(updates);
};
/**
 * Populate claim connection checkboxes based on crew type data
 * Connections are pairs [from, to] where:
 * - |diff| === 1 → horizontal (lower position gets conn_right)
 * - |diff| === 5 → vertical (lower position gets conn_bottom)
 * Position layout:
 *   [1]  [2]  [3]  [4]  [5]
 *   [6]  [7]  [8]  [9]  [10]   (8 = Lair)
 *   [11] [12] [13] [14] [15]
 */
const populateCrewClaimConnections = (connections) => {
    const updates = {};
    // All positions that could have connectors
    const allPositions = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];
    // Clear all connectors first
    allPositions.forEach(pos => {
        updates[`claim_${pos}_conn_right`] = '0';
        updates[`claim_${pos}_conn_bottom`] = '0';
    });
    // Set connectors based on connection pairs
    connections.forEach(([a, b]) => {
        const lower = Math.min(a, b);
        const diff = Math.abs(b - a);
        if (diff === 1) {
            // Horizontal connection - lower position gets right connector
            updates[`claim_${lower}_conn_right`] = '1';
        }
        else if (diff === 5) {
            // Vertical connection - lower position gets bottom connector
            updates[`claim_${lower}_conn_bottom`] = '1';
        }
        // Note: diff of other values would be diagonal or non-adjacent
    });
    setAttrs(updates);
};
/**
 * Clear all crew upgrade checkboxes
 */
const clearCrewUpgrades = (callback) => {
    const updates = {};
    // Clear single-level upgrades
    CREW_UPGRADES_SINGLE.forEach(attr => {
        updates[attr] = "0";
    });
    // Clear multi-level upgrades
    Object.entries(CREW_UPGRADES_MULTI).forEach(([baseName, levels]) => {
        for (let i = 1; i <= levels; i++) {
            updates[`${baseName}_${i}`] = "0";
        }
    });
    setAttrs(updates, { silent: true }, callback);
};
/**
 * Set crew upgrades based on crew type data
 */
const setCrewUpgrades = (upgrades) => {
    const updates = {};
    // Set single-level upgrades
    upgrades.checkboxes.forEach(attr => {
        updates[attr] = "1";
    });
    // Set multi-level upgrades (check up to the specified level)
    Object.entries(upgrades.multi).forEach(([baseName, level]) => {
        for (let i = 1; i <= level; i++) {
            updates[`${baseName}_${i}`] = "1";
        }
    });
    if (Object.keys(updates).length > 0) {
        setAttrs(updates);
    }
};
/**
 * Handle crew type change - populate abilities, cohorts, upgrades, type-specific upgrades, and contacts
 */
const handleCrewTypeChange = (newCrewType) => {
    if (!newCrewType || !CREW_DATA[newCrewType])
        return;
    const data = CREW_DATA[newCrewType];
    // 1. Clear and populate crew abilities
    clearAndPopulateRepeatingSection("crewabilities", data.abilities, formatCrewAbility);
    // 2. Clear and populate cohorts
    clearAndPopulateRepeatingSection("cohorts", data.cohorts, formatCrewCohort);
    // 3. Clear and populate crew type-specific upgrades
    clearAndPopulateRepeatingSection("crewtypeupgrades", data.typeUpgrades, formatCrewTypeUpgrade);
    // 4. Clear all general upgrades, then set the starting ones
    clearCrewUpgrades(() => {
        setCrewUpgrades(data.upgrades);
    });
    // 5. Populate crew contacts from crew type data
    populateCrewContacts(data.contacts);
    // 6. Populate crew claims from crew type data
    populateCrewClaims(data.claims);
    // 7. Populate claim connections from crew type data
    populateCrewClaimConnections(data.claimConnections);
    // 8. Set crew-specific XP trigger
    setAttrs({
        crew_xp_trigger: data.xpTrigger
    });
};
// =============================================================================
// FACTION POPULATION FUNCTIONS
// =============================================================================
/**
 * Map faction category keys to repeating section names
 */
const FACTION_SECTION_MAP = {
    'corpsmajor': 'factionscorpsmajor',
    'corpsminor': 'factionscorpsminor',
    'underworld': 'factionsunderworld',
    'fringe': 'factionsfringe',
    'citizens': 'factionscitizens'
};
/**
 * Clear all factions from all faction sections
 */
const clearAllFactions = () => {
    const sectionNames = Object.values(FACTION_SECTION_MAP);
    sectionNames.forEach(sectionName => {
        getSectionIDs(sectionName, ids => {
            ids.forEach(id => {
                removeRepeatingRow(`repeating_${sectionName}_${id}`);
            });
        });
    });
};
/**
 * Populate all faction sections in a single batched setAttrs call
 * This avoids issues with multiple rapid setAttrs calls
 */
const populateDefaultFactions = () => {
    // Build a single attrs object with all factions
    const attrs = {};
    FACTION_DATA.forEach(category => {
        const sectionName = FACTION_SECTION_MAP[category.key];
        if (sectionName && category.factions) {
            category.factions.forEach(faction => {
                const rowId = generateRowID();
                attrs[`repeating_${sectionName}_${rowId}_faction_name`] = faction.name;
                attrs[`repeating_${sectionName}_${rowId}_faction_tier`] = faction.tier.toString();
                attrs[`repeating_${sectionName}_${rowId}_faction_tier_display`] = faction.tierDisplay;
                attrs[`repeating_${sectionName}_${rowId}_faction_category`] = faction.category;
                attrs[`repeating_${sectionName}_${rowId}_faction_status`] = "0";
                attrs[`repeating_${sectionName}_${rowId}_faction_desc`] = faction.description;
                attrs[`repeating_${sectionName}_${rowId}_autogen`] = "1";
            });
        }
    });
    // Single setAttrs call with all faction data
    setAttrs(attrs);
};
// =============================================================================
// INITIALIZATION
// =============================================================================
/**
 * Initialize all calculations on sheet open
 */
const initializeSheet = () => {
    calculateAllAttributeRatings();
    calculateLoad();
    calculateAugmentMaintenance();
    calculateHeatDice();
};
// Dark City, Shining Babel - Sheet Worker Event Handlers
// Event bindings for sheet interactivity
// =============================================================================
// SHEET INITIALIZATION
// =============================================================================
on("sheet:opened", () => {
    initializeSheet();
});
// =============================================================================
// ATTRIBUTE CALCULATIONS - Trigger when actions change
// =============================================================================
// Acuity = max(hack, recon, scrutinize, tamper)
on("change:hack change:recon change:scrutinize change:tamper", () => {
    calculateAttributeRating('acuity');
});
// Grit = max(brawl, hunt, skulk, vandalize)
on("change:brawl change:hunt change:skulk change:vandalize", () => {
    calculateAttributeRating('grit');
});
// Resolve = max(consort, dominate, finesse, sway)
on("change:consort change:dominate change:finesse change:sway", () => {
    calculateAttributeRating('resolve');
});
// =============================================================================
// ACTION ROLL HANDLERS (12 total)
// =============================================================================
ACTIONS.forEach(action => {
    on(`clicked:roll_${action}`, () => {
        rollWithModifier([action, 'character_name'], v => int(v[action]), (dice, v, context) => {
            const charName = v.character_name || 'Unknown';
            const actionName = capitalize(action);
            const rollFormula = buildRollFormula(dice);
            // Build position and effect display (capitalize first letter)
            const posDisplay = context.position.charAt(0).toUpperCase() + context.position.slice(1);
            const effDisplay = context.effect.charAt(0).toUpperCase() + context.effect.slice(1);
            // Build notes section with modifier if present
            const notesSection = context.modNotes ? ` {{notes=${context.modNotes}}}` : '';
            startRoll(`&{template:${ROLL_TEMPLATES.ACTION}} {{charname=${charName}}} {{title=${actionName}}} {{roll=[[${rollFormula}]]}} {{label=[[0]]}} {{position=${posDisplay}}} {{effect=${effDisplay}}}${notesSection}`, results => {
                const diceArray = results.results.roll.dice;
                const rollResult = results.results.roll.result;
                const crit = isCrit(diceArray);
                const label = getActionLabel(rollResult, crit);
                finishRoll(results.rollId, { label });
            });
        });
    });
});
// =============================================================================
// RESISTANCE ROLL HANDLERS (3 total)
// =============================================================================
ATTRIBUTE_NAMES.forEach(attr => {
    on(`clicked:roll_${attr}_resist`, () => {
        rollWithModifier([`${attr}_rating`, 'character_name'], v => int(v[`${attr}_rating`]), (dice, v, context) => {
            const charName = v.character_name || 'Unknown';
            const attrName = capitalize(attr);
            const rollFormula = buildRollFormula(dice);
            const notesSection = context.modNotes ? ` {{notes=${context.modNotes}}}` : '';
            startRoll(`&{template:${ROLL_TEMPLATES.RESISTANCE}} {{charname=${charName}}} {{attribute=${attrName}}} {{roll=[[${rollFormula}]]}} {{stressmsg=[[0]]}}${notesSection}`, results => {
                const diceArray = results.results.roll.dice;
                const rollResult = results.results.roll.result;
                const crit = isCrit(diceArray);
                const stressmsg = getStressMessage(rollResult, crit);
                finishRoll(results.rollId, { stressmsg });
            });
        });
    });
});
// =============================================================================
// LOAD TRACKING
// =============================================================================
// Load selection changes max
on("change:load", calculateLoad);
// Standard item load checkboxes (item_knife_1, item_large_weapon_1, item_large_weapon_2, etc.)
STANDARD_ITEM_LOAD_ATTRS.forEach(attr => {
    on(`change:${attr}`, calculateLoad);
});
// Playbook items (repeating section) - load boxes: item_load_1, item_load_2
on("change:repeating_items:item_load_1 change:repeating_items:item_load_2 remove:repeating_items", calculateLoad);
// =============================================================================
// AUGMENT MAINTENANCE
// =============================================================================
on("change:repeating_augments remove:repeating_augments", calculateAugmentMaintenance);
// Maintenance failure roll (when you can't pay BC owed)
on("clicked:roll_maintenance", () => {
    getAttrs(['maintenance_clocks', 'character_name'], v => {
        const clocks = int(v.maintenance_clocks);
        const charName = v.character_name || 'Unknown';
        // No roll needed if no clocks owed
        if (clocks <= 0) {
            startRoll(`&{template:${ROLL_TEMPLATES.FORTUNE}} {{charname=${charName}}} {{title=Maintenance}} {{roll=[[0d6]]}} {{label=NO MAINTENANCE DUE}} {{notes=You have no unpaid maintenance clocks.}}`, results => finishRoll(results.rollId, {}));
            return;
        }
        // Roll Xd6 take LOWEST where X = unpaid maintenance clocks
        const rollFormula = `${clocks}d${DICE.SIZE}${DICE.KEEP_LOWEST}`;
        const notes = 'Crit: Free next downtime. 6: Still working. 4-5: YOU choose augments to disable. 1-3: GM secretly chooses failures.';
        startRoll(`&{template:${ROLL_TEMPLATES.FORTUNE}} {{charname=${charName}}} {{title=Maintenance Failure (${clocks} unpaid)}} {{roll=[[${rollFormula}]]}} {{label=[[0]]}} {{notes=${notes}}}`, results => {
            const diceArray = results.results.roll.dice;
            const rollResult = results.results.roll.result;
            const crit = isCrit(diceArray);
            const label = getMaintenanceLabel(rollResult, crit);
            finishRoll(results.rollId, { label });
        });
    });
});
// =============================================================================
// HEAT GAUGE (Crew Sheet)
// =============================================================================
on("change:score_heat", calculateHeatDice);
// =============================================================================
// DISENGAGEMENT ROLL (Crew Sheet)
// =============================================================================
on("clicked:disengage_roll", () => {
    rollWithModifier(['score_heat', 'crew_name'], v => HEAT_GAUGE.SEGMENTS - int(v.score_heat), (dice, v, context) => {
        const crewName = v.crew_name || 'Crew';
        const rollFormula = buildRollFormula(dice);
        // Combine dice modifier with existing notes
        let notes = '1-3: 2 entanglements AND -2 coin. 4-5: -2 coin OR 2 entanglements. 6+: Clean getaway.';
        if (context.modNotes)
            notes = `${context.modNotes} | ${notes}`;
        startRoll(`&{template:${ROLL_TEMPLATES.FORTUNE}} {{charname=${crewName}}} {{title=Disengagement}} {{roll=[[${rollFormula}]]}} {{label=[[0]]}} {{notes=${notes}}}`, results => {
            const diceArray = results.results.roll.dice;
            const rollResult = results.results.roll.result;
            const crit = isCrit(diceArray);
            const label = getDisengageLabel(rollResult, crit);
            finishRoll(results.rollId, { label });
        });
    });
});
// =============================================================================
// ENGAGEMENT ROLL (Crew Sheet)
// =============================================================================
on("clicked:engagement_roll", () => {
    rollWithModifier(['crew_name'], () => 0, // Base dice = 0, relies on modifier
    (dice, v, context) => {
        const crewName = v.crew_name || 'Crew';
        const rollFormula = buildRollFormula(dice);
        // Combine dice modifier with existing notes
        let notes = '1-3: Bad start. 4-5: Risky start. 6: Controlled start. Crit: Controlled + edge.';
        if (context.modNotes)
            notes = `${context.modNotes} | ${notes}`;
        startRoll(`&{template:${ROLL_TEMPLATES.FORTUNE}} {{charname=${crewName}}} {{title=Engagement}} {{roll=[[${rollFormula}]]}} {{label=[[0]]}} {{notes=${notes}}}`, results => {
            const diceArray = results.results.roll.dice;
            const rollResult = results.results.roll.result;
            const crit = isCrit(diceArray);
            const label = getEngagementLabel(rollResult, crit);
            finishRoll(results.rollId, { label });
        });
    });
});
// =============================================================================
// FORTUNE ROLL (Header - generic fortune roll with position/effect)
// =============================================================================
on("clicked:fortune_roll", () => {
    rollWithModifier(['character_name', 'crew_name'], () => 0, // Base dice = 0, relies on modifier
    (dice, v, context) => {
        const name = v.character_name || v.crew_name || 'Unknown';
        const rollFormula = buildRollFormula(dice);
        // Build position and effect display
        const posDisplay = context.position.charAt(0).toUpperCase() + context.position.slice(1);
        const effDisplay = context.effect.charAt(0).toUpperCase() + context.effect.slice(1);
        // Build notes section
        let notes = '1-3: Bad outcome. 4-5: Mixed outcome. 6: Good outcome. Crit: Exceptional.';
        if (context.modNotes)
            notes = `${context.modNotes} | ${notes}`;
        startRoll(`&{template:${ROLL_TEMPLATES.FORTUNE}} {{charname=${name}}} {{title=Fortune}} {{roll=[[${rollFormula}]]}} {{label=[[0]]}} {{position=${posDisplay}}} {{effect=${effDisplay}}} {{notes=${notes}}}`, results => {
            const diceArray = results.results.roll.dice;
            const rollResult = results.results.roll.result;
            const crit = isCrit(diceArray);
            const label = getFortuneLabel(rollResult, crit);
            finishRoll(results.rollId, { label });
        });
    });
});
// =============================================================================
// PLAYBOOK SELECTION
// =============================================================================
on("change:playbook", eventInfo => {
    const newPlaybook = eventInfo.newValue;
    handlePlaybookChange(newPlaybook);
});
// Reset to Playbook Defaults button
on("clicked:reset_to_playbook", () => {
    resetToPlaybookDefaults();
});
// =============================================================================
// CREW TYPE SELECTION
// =============================================================================
on("change:crew_type", eventInfo => {
    const newCrewType = eventInfo.newValue;
    handleCrewTypeChange(newCrewType);
});
// =============================================================================
// FACTION POPULATION (Factions Tab)
// =============================================================================
on("clicked:populate_factions", () => {
    populateDefaultFactions();
});
on("clicked:clear_factions", () => {
    clearAllFactions();
});
// =============================================================================
// INDULGE VICE ROLL
// =============================================================================
on("clicked:indulge_vice", () => {
    rollWithModifier(['acuity_rating', 'grit_rating', 'resolve_rating', 'character_name', 'vice_type', 'stress'], v => {
        const acuity = int(v.acuity_rating);
        const grit = int(v.grit_rating);
        const resolve = int(v.resolve_rating);
        // Roll lowest attribute (BitD rules)
        return Math.min(acuity, grit, resolve);
    }, (dice, v, context) => {
        const charName = v.character_name || 'Unknown';
        const currentStress = int(v.stress);
        const rollFormula = buildRollFormula(dice);
        // Combine dice modifier with existing notes
        let notes = `Clear stress equal to highest die (current: ${currentStress}). Overindulge if roll > stress.`;
        if (context.modNotes)
            notes = `${context.modNotes} | ${notes}`;
        startRoll(`&{template:${ROLL_TEMPLATES.VICE}} {{charname=${charName}}} {{roll=[[${rollFormula}]]}} {{label=[[0]]}} {{notes=${notes}}}`, results => {
            const diceArray = results.results.roll.dice;
            const highestDie = Math.max(...diceArray);
            const crit = isCrit(diceArray);
            const label = getViceLabel(highestDie, currentStress, crit);
            finishRoll(results.rollId, { label });
        });
    });
});
// =============================================================================
// COHORT ROLL (Repeating Section)
// Gang: Tier dice, Expert: Tier+1 dice, Elite: +1d, Harm: -1d per level
// =============================================================================
on("clicked:repeating_cohorts:cohortroll", () => {
    getAttrs([
        'crew_tier',
        'crew_name',
        'repeating_cohorts_cohort_name',
        'repeating_cohorts_cohort_type',
        'repeating_cohorts_cohort_elite',
        'repeating_cohorts_cohort_harm',
        'roll_modifier'
    ], v => {
        const tier = int(v.crew_tier);
        const crewName = v.crew_name || 'Crew';
        const cohortName = v.repeating_cohorts_cohort_name || 'Cohort';
        const cohortType = v.repeating_cohorts_cohort_type || 'gang';
        const isElite = v.repeating_cohorts_cohort_elite === '1';
        const harm = int(v.repeating_cohorts_cohort_harm);
        const rollMod = int(v.roll_modifier);
        // Reset modifier immediately
        setAttrs({ roll_modifier: '0' }, { silent: true });
        // Check if cohort can act (broken=3, dead=4)
        if (harm >= 3) {
            const harmLabel = harm >= 4 ? 'DEAD' : 'BROKEN';
            const harmNote = harm >= 4 ? 'Cohort is dead.' : 'Cohort is broken and cannot act.';
            startRoll(`&{template:${ROLL_TEMPLATES.FORTUNE}} {{charname=${crewName}}} {{title=${cohortName}}} {{roll=[[0d6]]}} {{label=${harmLabel}}} {{notes=${harmNote}}}`, results => finishRoll(results.rollId, {}));
            return;
        }
        // Calculate dice pool
        // Gang: Tier, Expert: Tier+1, Elite: +1d, Harm: -1d per level, Position modifier
        let dice = tier;
        if (cohortType === 'expert')
            dice += 1;
        if (isElite)
            dice += 1;
        dice -= harm;
        dice += rollMod;
        // Build notes showing modifiers
        const mods = [];
        if (rollMod > 0)
            mods.push(`+${rollMod}d Position`);
        if (rollMod < 0)
            mods.push(`${rollMod}d Position`);
        mods.push(`Tier ${tier}`);
        if (cohortType === 'expert')
            mods.push('+1d Expert');
        if (isElite)
            mods.push('+1d Elite');
        if (harm === 1)
            mods.push('-1d Weak');
        if (harm === 2)
            mods.push('-2d Impaired');
        const rollFormula = buildRollFormula(dice);
        const typeLabel = cohortType === 'expert' ? 'Expert' : 'Gang';
        startRoll(`&{template:${ROLL_TEMPLATES.FORTUNE}} {{charname=${crewName}}} {{title=${cohortName} (${typeLabel})}} {{roll=[[${rollFormula}]]}} {{label=[[0]]}} {{notes=${mods.join(', ')}}}`, results => {
            const diceArray = results.results.roll.dice;
            const rollResult = results.results.roll.result;
            const crit = isCrit(diceArray);
            const label = getFortuneLabel(rollResult, crit);
            finishRoll(results.rollId, { label });
        });
    });
});
// =============================================================================
// CUSTOM CLOCKS - Size Change Handlers
// =============================================================================
// Character clocks - update visibility flags when size changes
on("change:repeating_clocks:clock_size", (eventInfo) => {
    const size = parseInt(eventInfo.newValue) || 6;
    // Get the repeating row prefix from the source attribute
    // e.g., "repeating_clocks_-ABC123_clock_size" -> "repeating_clocks_-ABC123"
    const match = eventInfo.sourceAttribute.match(/^(repeating_clocks_[^_]+)_/);
    if (!match)
        return;
    const prefix = match[1];
    setAttrs({
        [`${prefix}_clock_show_5_6`]: size >= 6 ? "1" : "0",
        [`${prefix}_clock_show_7_8`]: size >= 8 ? "1" : "0",
        [`${prefix}_clock_show_9_10`]: size >= 10 ? "1" : "0",
        [`${prefix}_clock_show_11_12`]: size >= 12 ? "1" : "0"
    });
});
// Crew clocks - update visibility flags when size changes
on("change:repeating_crewclocks:clock_size", (eventInfo) => {
    const size = parseInt(eventInfo.newValue) || 6;
    // Get the repeating row prefix from the source attribute
    const match = eventInfo.sourceAttribute.match(/^(repeating_crewclocks_[^_]+)_/);
    if (!match)
        return;
    const prefix = match[1];
    setAttrs({
        [`${prefix}_clock_show_5_6`]: size >= 6 ? "1" : "0",
        [`${prefix}_clock_show_7_8`]: size >= 8 ? "1" : "0",
        [`${prefix}_clock_show_9_10`]: size >= 10 ? "1" : "0",
        [`${prefix}_clock_show_11_12`]: size >= 12 ? "1" : "0"
    });
});
// =============================================================================
// HEALING FORTUNE ROLL
// =============================================================================
on("clicked:roll_healing", () => {
    rollWithModifier(['character_name'], () => 1, // Base healing roll is 1d
    (dice, v, context) => {
        const charName = v.character_name || 'Unknown';
        const rollFormula = buildRollFormula(dice);
        // Combine dice modifier with existing notes
        let notes = '1-3: 1 tick, 4-5: 2 ticks, 6: 3 ticks, Crit: 5 ticks. Fill clock to heal 1 harm level.';
        if (context.modNotes)
            notes = `${context.modNotes} | ${notes}`;
        startRoll(`&{template:${ROLL_TEMPLATES.FORTUNE}} {{charname=${charName}}} {{title=Recovery}} {{roll=[[${rollFormula}]]}} {{label=[[0]]}} {{notes=${notes}}}`, results => {
            const diceArray = results.results.roll.dice;
            const rollResult = results.results.roll.result;
            const crit = isCrit(diceArray);
            const label = getFortuneLabel(rollResult, crit);
            finishRoll(results.rollId, { label });
        });
    });
});
})();</script>