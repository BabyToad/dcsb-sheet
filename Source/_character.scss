// =============================================================================
// CHARACTER - Character sheet specific sections
// =============================================================================

@use 'tokens' as *;
@use 'mixins' as *;

.charsheet {
    // =========================================================================
    // ACTION RATINGS - Fakeradio Checkbox Pattern (Inverse Fill)
    // =========================================================================

    // Attribute blocks (vertical stack in right column)
    .attribute-block {
        margin-bottom: $spacing-sm;
        padding: $spacing-sm;
        border-left: 3px solid $zine-ink;
        background: rgba(0,0,0,0.02);

        .attribute-header-row {
            @include flex-row($spacing-sm);
            margin-bottom: $spacing-sm;

            .attr-name {
                margin: 0;
                font-size: 11px;
                font-weight: bold;
                font-family: $font-typewriter;
                text-transform: uppercase;
                min-width: 55px;
                background: transparent;
                border: none;
                padding: 0;
                cursor: pointer;
                color: $zine-ink;
                text-align: left;
                @include transition(color);

                &:hover {
                    color: $zine-accent;
                }
            }
        }

        .attribute-xp {
            @include flex-row($spacing-xs);
            margin-bottom: $spacing-sm;

            .xp-label {
                @include uppercase-label(9px, $zine-grey, 0.5px);
                font-weight: normal;
                min-width: 20px;
            }
        }
    }

    // Attribute rating track (fakeradio inverse-fill)
    .attribute-track {
        @include flex-row(2px);
        @include fakeradio-hidden();

        .attr-dot {
            @include square-box(12px);
            border: 1px solid $zine-grey;
            border-radius: 1px;
            cursor: pointer;
            display: block;
            flex-grow: 0;
            background: $zine-grey;
            @include transition(background);
            line-height: 0;
            font-size: 0;
            padding: 0;
            margin: 0;
        }

        // Inverse fill: dots AFTER checked become empty
        @include fakeradio-inverse-fill(attr-dot);
    }

    .action-list {
        @include flex-column($spacing-xs);
    }

    // Action row (clickable name + dots)
    .action-row {
        @include flex-row($spacing-sm);

        .action-name {
            width: 75px;
            font-family: $font-typewriter;
            font-size: 10px;
            font-weight: normal;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            text-align: left;
            // Remove button styling
            background: transparent;
            border: none;
            padding: 0;
            margin: 0;
            cursor: pointer;
            color: $zine-ink;
            @include transition(color);

            &:hover {
                color: $zine-accent;
            }
        }

        .action-dots {
            @include flex-row(2px);
            @include fakeradio-hidden();

            .dot {
                @include square-box(16px);
                border: 2px solid $zine-ink;
                border-radius: 1px;
                display: block;
                cursor: pointer;
                @include transition();
                flex-grow: 0;
                background: $zine-ink;
                line-height: 0;
                font-size: 0;
                padding: 0;
                margin: 0;
            }

            // Inverse fill: dots AFTER checked become empty
            @include fakeradio-inverse-fill(dot);
        }
    }

    // Playbook XP block (at bottom of section)
    .playbook-xp-block {
        margin-top: $spacing-md;
        padding: $spacing-sm;
        border: 1px dashed $zine-grey;
        background: rgba(0,0,0,0.02);

        .xp-label-row {
            margin-bottom: $spacing-xs;

            .xp-label {
                @include uppercase-label(10px, inherit, 0.5px);
            }
        }

        .xp-trigger-row {
            margin-bottom: $spacing-sm;
        }

        .xp-trigger-text {
            display: block;
            font-size: $type-sm;
            font-style: italic;
            color: $zine-grey;
            font-family: $font-typewriter;
            line-height: 1.4;
            padding: $spacing-xs 0;
            border-left: 2px solid $terminal-amber;
            padding-left: $spacing-sm;

            &:empty::after {
                content: 'XP trigger not set...';
                color: $form-grey-light;
            }
        }
    }

    // =========================================================================
    // HARM SECTION
    // =========================================================================

    .harm-section {
        margin-bottom: $spacing-md;
        padding: $spacing-sm;
        border: 1px dashed $zine-grey;
        background: rgba(0,0,0,0.02);
    }

    .harm-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: $spacing-sm;
        padding-bottom: $spacing-sm;
        border-bottom: 1px solid $zine-light-grey;
    }

    .healing-clock-group {
        display: flex;
        align-items: center;
        gap: $spacing-sm;

        .healing-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;

            .clock-label {
                @include uppercase-label(8px, $zine-grey, 0.5px);
                font-weight: normal;
            }
        }

        .healing-roll-btn {
            font-size: 14px;
            padding: 2px 6px;
            cursor: pointer;
            background: transparent;
            border: 1px solid $zine-grey;
            color: $zine-grey;
            @include transition();

            &:hover {
                border-color: $terminal-amber;
                color: $terminal-amber;
                background: rgba($terminal-amber, 0.1);
            }
        }
    }

    .harm-track {
        .harm-level {
            display: flex;
            align-items: stretch;
            gap: $spacing-sm;
            margin-bottom: $spacing-sm;
            padding-bottom: $spacing-sm;
            border-bottom: 1px dotted $zine-light-grey;

            &:last-child {
                margin-bottom: 0;
                padding-bottom: 0;
                border-bottom: none;
            }

            .level-indicator {
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 50px;

                .level-num {
                    font-size: 18px;
                    font-weight: bold;
                    line-height: 1;
                }

                .level-label {
                    font-size: 7px;
                    text-transform: uppercase;
                    letter-spacing: 0.5px;
                    color: $zine-grey;
                }
            }

            &.severe .level-num {
                color: $status-danger;
            }

            &.moderate .level-num {
                color: $status-warning;
            }

            &.lesser .level-num {
                color: $zine-grey;
            }

            .harm-inputs {
                flex: 1;
                min-width: 0;  // Allow shrinking in flex context
                display: flex;
                gap: $spacing-sm;
            }

            .harm-input {
                flex: 1;
                min-width: 0;  // Allow shrinking in flex context
                font-size: $type-sm;
                font-family: $font-typewriter;
                padding: $spacing-xs $spacing-sm;
                background: $form-paper;
                border: 1px solid $zine-light-grey;
                min-height: 28px;

                &::placeholder {
                    color: $form-grey-light;
                    font-style: italic;
                    font-size: 9px;
                }

                &:focus {
                    outline: none;
                    border-color: $terminal-amber;
                }
            }

            // Single input for severe harm
            > .harm-input {
                flex: 1;
            }
        }
    }

    // =========================================================================
    // ARMOR ROW
    // =========================================================================

    .armor-row {
        display: flex;
        align-items: center;
        gap: $spacing-md;
        padding-top: $spacing-sm;
        border-top: 1px dashed $zine-grey;
    }

    // Armor track (inside armor-row)
    .armor-track {
        display: flex;
        gap: $spacing-md;
    }

    .armor-checkbox {
        @include flex-row($spacing-xs);
        cursor: pointer;
        font-size: 10px;
        text-transform: uppercase;

        .armor-box {
            @include square-box(14px);
            border: 2px solid $zine-ink;
            display: inline-block;
        }

        input[type="checkbox"] {
            @include hidden-checkbox-base();

            &:checked + .armor-box {
                @include checkbox-checked-fill($terminal-amber);
            }
        }
    }

    // =========================================================================
    // EQUIPMENT
    // =========================================================================

    .load-selector {
        margin-bottom: $spacing-sm;

        .load-options {
            @include flex-row($spacing-md, stretch);
        }

        .load-option {
            @include flex-row($spacing-xs);
            cursor: pointer;
            font-size: 10px;

            .load-box {
                @include square-box(12px);
                border: 2px solid $zine-ink;
                border-radius: 1px;
            }

            input[type="radio"] {
                @include hidden-checkbox-base();

                &:checked + .load-box {
                    @include checkbox-checked-fill($zine-accent, $zine-accent);
                }
            }
        }
    }

    .load-tracker {
        font-size: 10px;
        margin-bottom: $spacing-sm;
        color: $zine-grey;

        .load-num {
            width: 25px;
            text-align: center;
            font-weight: bold;
        }
    }

    .equipment-columns {
        @include grid(1fr 1fr, $spacing-md);
    }

    // Standard item checkbox (fixed items like Blade, Pistol, etc.)
    .item-checkbox {
        @include flex-row($spacing-xs);
        cursor: pointer;
        font-size: $type-sm;
        padding: $spacing-xs 0;
        color: $form-ink;

        .item-box {
            @include square-box(12px);
            border: 1px solid $zine-ink;
            flex-shrink: 0;
        }

        input[type="checkbox"] {
            @include hidden-checkbox-base();

            &:checked + .item-box {
                @include checkbox-checked-fill($terminal-amber);
            }

            // Bold when carried, not strikethrough
            &:checked ~ .item-name {
                font-weight: bold;
            }
        }

        .item-load {
            color: $zine-grey;
            margin-left: auto;
        }
    }

    // =========================================================================
    // AUGMENTS
    // =========================================================================

    .augment-capacity {
        font-size: 11px;
        margin-bottom: $spacing-sm;
        padding: $spacing-xs $spacing-sm;
        background: rgba(0,0,0,0.03);
        border-left: 3px solid $zine-accent;

        .augment-used,
        .augment-max {
            width: 30px;
            text-align: center;
            font-weight: bold;
        }
    }

    // =========================================================================
    // VICE - Indulge button styling
    // =========================================================================

    .vice-roll-btn {
        font-family: $font-mono;
        font-size: $type-sm;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 1px;
        background: $form-ink;
        color: $form-paper;
        border: none;
        padding: $spacing-xs $spacing-md;
        cursor: pointer;
        @include transition();

        &:hover {
            background: $terminal-amber;
            color: $form-ink;
        }
    }

    .vice-hint {
        font-family: $font-mono;
        font-size: $type-xs;
        color: $form-grey;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    // =========================================================================
    // CIRCLES (Contacts) - Rolodex card aesthetic
    // =========================================================================

    .circles-intro {
        font-family: $font-mono;
        font-style: italic;
        color: $zine-grey;
        margin-bottom: $spacing-md;
        font-size: 11px;
    }

    .contacts-grid {
        display: flex;
        flex-direction: column;
        gap: $spacing-sm;
    }

    .contact-card {
        position: relative;
        background: $form-paper;
        border: 1px solid $form-ink;
        border-left: 3px solid $zine-grey;
        padding: $spacing-sm $spacing-md;
        font-family: $font-mono;

        // Slight alternating rotation for rolodex feel
        &:nth-child(odd) {
            transform: rotate(-0.3deg);
        }
        &:nth-child(even) {
            transform: rotate(0.2deg);
        }

        // Status controls at top right
        .contact-status {
            position: absolute;
            top: $spacing-xs;
            right: $spacing-xs;
            display: flex;
            gap: 2px;

            .status-option {
                cursor: pointer;

                input[type="radio"] {
                    @include hidden-checkbox-base();
                }

                .status-badge {
                    @include square-box(18px);
                    border: 1px solid $zine-grey;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 10px;
                    background: $form-paper;
                    @include transition();
                }

                &:hover .status-badge {
                    border-color: $form-ink;
                }
            }

            // Friend - amber accent (flagged as useful)
            .status-friend input:checked + .status-badge {
                background: $terminal-amber;
                border-color: $terminal-amber;
                color: $form-ink;
            }

            // Neutral - grey (standard contact)
            .status-neutral input:checked + .status-badge {
                background: $zine-grey;
                border-color: $zine-grey;
                color: white;
            }

            // Rival - dark/ink (marked as hostile)
            .status-rival input:checked + .status-badge {
                background: $form-ink;
                border-color: $form-ink;
                color: white;
            }
        }

        // Update left border color based on selection
        &:has(.status-friend input:checked) {
            border-left-color: $terminal-amber;
        }
        &:has(.status-rival input:checked) {
            border-left-color: $form-ink;
        }

        // Display mode content
        .contact-display {
            padding-right: 60px; // Space for status badges

            .contact-name {
                display: block;
                font-weight: bold;
                font-size: $type-md;
                margin-bottom: 2px;

                &:empty::after {
                    content: 'Contact name...';
                    color: $form-grey-light;
                    font-weight: normal;
                    font-style: italic;
                }
            }

            .contact-desc {
                display: block;
                font-size: $type-sm;
                color: $zine-grey;

                &:empty {
                    display: none;
                }
            }
        }

        // Edit mode content - NO display property here (let mode toggle handle it)
        .contact-edit {
            padding-right: 60px;

            .contact-name-input {
                width: 100%;
                font-weight: bold;
                font-size: $type-md;
                margin-bottom: $spacing-xs;
            }

            .contact-desc-input {
                width: 100%;
                font-size: $type-sm;
            }
        }
    }

    // =========================================================================
    // NOTES
    // =========================================================================

    .notes-area {
        width: 100%;
        min-height: 100px;
        font-family: $font-typewriter;
        font-size: 11px;
        line-height: 1.5;
        padding: $spacing-sm;
        border: 1px dashed $zine-grey;
        background: repeating-linear-gradient(
            transparent,
            transparent 18px,
            $zine-light-grey 18px,
            $zine-light-grey 19px
        );
    }

    // =========================================================================
    // BUTTONS
    // =========================================================================

    .reset-btn {
        padding: $spacing-xs $spacing-md;
        font-family: $font-typewriter;
        font-size: 10px;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        background: transparent;
        border: 1px solid $status-warning;
        color: $status-warning;
        cursor: pointer;
        @include transition();

        &:hover {
            background: $status-warning;
            color: $zine-paper;
        }
    }

    .reset-hint {
        font-size: 9px;
        font-style: italic;
        color: $zine-grey;
    }

    .disengage-btn {
        width: 100%;
        padding: $spacing-sm;
        margin-top: $spacing-sm;
        font-family: $font-typewriter;
        font-size: 11px;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 1px;
        background: $zine-paper;
        border: 2px solid $zine-ink;
        cursor: pointer;
        @include transition();

        &:hover {
            background: $zine-ink;
            color: $zine-paper;
        }
    }
}
