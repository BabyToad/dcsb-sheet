//- Dark City, Shining Babel - Character Sheet Content
//- Layout: Two-column with Actions+XP on right
//- Information Architecture: Runner Dossier framing

.sheet-columns
    //- ═══════════════════════════════════════════════════════════════
    //- LEFT COLUMN
    //- ═══════════════════════════════════════════════════════════════
    .left-column

        //- ───────────────────────────────────────────────────────────
        //- SECTION 1: SUBJECT IDENTIFICATION
        //- Framing: Corporate intake form / employee file
        //- ───────────────────────────────────────────────────────────
        .section.identity
            +section-header-editable("identity", "SUBJECT IDENTIFICATION", "01")

            //- ═══════════════════════════════════════════════════════════
            //- DISPLAY MODE - Unified dossier view
            //- ═══════════════════════════════════════════════════════════
            .display.identity-display
                .identity-name-line
                    span.char-name(name="attr_character_name")
                    span.alias-wrapper
                        span.quote "
                        span.alias-value(name="attr_alias")
                        span.quote "
                span.identity-look(name="attr_look")
                .identity-classification
                    span.playbook-value(name="attr_playbook")
                    span.sep |
                    span.heritage-value(name="attr_heritage")
                    span.detail-value(name="attr_heritage_detail")
                    span.sep |
                    span.background-value(name="attr_background")
                    span.detail-value(name="attr_background_detail")

                //- Vice integrated into display
                .identity-vice
                    .vice-header
                        span.vice-label VICE:
                        span.vice-type-value(name="attr_vice_type")
                    .vice-body
                        span.vice-purveyor-value(name="attr_vice_purveyor")
                        span.vice-details-value(name="attr_vice_details")

            //- ═══════════════════════════════════════════════════════════
            //- EDIT MODE - Full form with all fields
            //- ═══════════════════════════════════════════════════════════
            .edit.identity-grid
                .identity-row.primary
                    +text-input("character_name", "LEGAL_NAME")
                    +text-input("alias", "ALIAS")

                .identity-row.secondary
                    +text-input("look", "PHYSICAL_DESCRIPTION")

                .identity-row.classification
                    .select-field
                        label
                            span.field-label(data-i18n="PLAYBOOK") Playbook
                            select(name="attr_playbook")
                                option(value="") --
                                option(value="face", data-i18n="FACE") Face
                                option(value="fixer", data-i18n="FIXER") Fixer
                                option(value="hacker", data-i18n="HACKER") Hacker
                                option(value="midnighter", data-i18n="MIDNIGHTER") MidNighter
                                option(value="murk", data-i18n="MURK") Murk
                                option(value="street_warrior", data-i18n="STREET_WARRIOR") Street Warrior

                    .select-field.with-detail
                        label
                            span.field-label(data-i18n="HERITAGE") Heritage
                            select(name="attr_heritage")
                                option(value="") --
                                option(value="babel", data-i18n="BABEL") Babel
                                option(value="sub_cities", data-i18n="SUB_CITIES") Sub Cities
                                option(value="the_well", data-i18n="THE_WELL") The Well
                                option(value="the_jungle", data-i18n="THE_JUNGLE") The Jungle
                                option(value="the_syndicate", data-i18n="THE_SYNDICATE") The Syndicate
                                option(value="labor_colonies", data-i18n="LABOR_COLONIES") Labor Colonies
                        input.detail-input(type="text", name="attr_heritage_detail", placeholder="e.g. political dissident")

                    .select-field.with-detail
                        label
                            span.field-label(data-i18n="BACKGROUND") Background
                            select(name="attr_background")
                                option(value="") --
                                option(value="entertainment", data-i18n="ENTERTAINMENT") Entertainment
                                option(value="law", data-i18n="LAW") Law
                                option(value="labor", data-i18n="LABOR") Labor
                                option(value="corporate", data-i18n="CORPORATE") Corporate
                                option(value="underworld", data-i18n="UNDERWORLD") Underworld
                                option(value="fringe", data-i18n="FRINGE") Fringe
                        input.detail-input(type="text", name="attr_background_detail", placeholder="e.g. hydroponics farmer")

                //- Vice fields in edit mode
                .identity-row.vice-row
                    .select-field.vice-type-field
                        label
                            span.field-label Vice
                            select(name="attr_vice_type")
                                option(value="") --
                                option(value="Faith") Faith
                                option(value="Gambling") Gambling
                                option(value="Luxury") Luxury
                                option(value="Obligation") Obligation
                                option(value="Pleasure") Pleasure
                                option(value="Stupor") Stupor
                                option(value="Weird") Weird
                    +text-input("vice_purveyor", "PURVEYOR")
                    +text-input("vice_details", "DETAILS")

                .identity-row.reset-row
                    button.reset-btn(type="action", name="act_reset_to_playbook") Reset to Playbook Defaults
                    span.reset-hint Clears items, abilities, and actions

            //- Indulge Vice button - always visible (it's an action)
            .vice-action
                button.vice-roll-btn(type="action", name="act_indulge_vice") Indulge Vice
                span.vice-hint Clears mental harm

        //- ───────────────────────────────────────────────────────────
        //- SECTION 3: CONDITION REPORT
        //- Framing: Medical chart / trauma assessment
        //- All elements always interactive (no edit/display split)
        //- ───────────────────────────────────────────────────────────
        .section.condition
            .section-header
                .section-stamp CONDITION REPORT
                .section-number 03

            //- Top row: Stress and Trauma side by side
            .condition-tracks
                .stress-block
                    .track-label(data-i18n="STRESS") STRESS
                    .stress-track
                        +fakeradio-track("stress", 9, "stress-box")

                .trauma-block
                    .track-label(data-i18n="TRAUMA") TRAUMA
                    .trauma-track
                        +fakeradio-track("trauma", 4, "trauma-box")

            //- Trauma conditions below tracks
            .trauma-conditions-row
                input.trauma-conditions-input(type="text", name="attr_trauma_conditions", placeholder="Trauma conditions...")

            //- Harm Section with healing clock
            .harm-section
                .harm-header
                    .track-label(data-i18n="HARM") HARM
                    .healing-clock-group
                        .clock-circle(data-segments="4")
                            - for (var i = 1; i <= 4; i++)
                                input(type="checkbox", name=`attr_healing_${i}`, value="1", id=`healing_seg_${i}`)
                                label.clock-wedge(for=`healing_seg_${i}`, data-segment=i)
                        .healing-controls
                            span.clock-label Healing
                            button.healing-roll-btn(type="action", name="act_roll_healing") ⚄

                //- Harm track with larger fields
                .harm-track
                    .harm-level.severe
                        .level-indicator
                            span.level-num 3
                            span.level-label SEVERE
                        input.harm-input(type="text", name="attr_harm_3", placeholder="Need Help")
                    .harm-level.moderate
                        .level-indicator
                            span.level-num 2
                            span.level-label MODERATE
                        .harm-inputs
                            input.harm-input(type="text", name="attr_harm_2a", placeholder="-1d")
                            input.harm-input(type="text", name="attr_harm_2b", placeholder="-1d")
                    .harm-level.lesser
                        .level-indicator
                            span.level-num 1
                            span.level-label LESSER
                        .harm-inputs
                            input.harm-input(type="text", name="attr_harm_1a", placeholder="Less Effect")
                            input.harm-input(type="text", name="attr_harm_1b", placeholder="Less Effect")

            //- Armor row
            .armor-row
                .track-label(data-i18n="ARMOR") ARMOR
                .armor-track
                    label.armor-checkbox
                        input(type="checkbox", name="attr_armor", value="1")
                        span.armor-box
                        span Armor
                    label.armor-checkbox
                        input(type="checkbox", name="attr_heavy_armor", value="1")
                        span.armor-box
                        span +Heavy
                    label.armor-checkbox
                        input(type="checkbox", name="attr_special_armor", value="1")
                        span.armor-box
                        span Special

        //- ───────────────────────────────────────────────────────────
        //- SECTION 4: AUGMENTATION RECORD
        //- Framing: Tech spec sheet / warranty documentation
        //- In DC,SB, Augments replace Special Abilities from BitD
        //- Description always visible (you need to know what your augs do)
        //- ───────────────────────────────────────────────────────────
        .section.augments
            +section-header-editable("augment", "AUGMENTATION RECORD", "04")

            .augment-maintenance
                span.maintenance-label MAINTENANCE:
                span.maintenance-ticks(name="attr_maintenance_ticks") 0
                span.maintenance-sep ticks →
                span.maintenance-clocks(name="attr_maintenance_clocks") 0
                span.maintenance-sep clocks =
                span.maintenance-bc-owed
                    span.bc-value(name="attr_maintenance_clocks") 0
                    span  BC owed

            +repeating("augments")
                .augment-entry
                    //- Installed checkbox - standard Roll20 pattern: input inside label
                    label.augment-installed
                        input.augment-check(type="checkbox", name="attr_augment_installed", value="1")
                        span.installed-box

                    //- Content wrapper
                    .augment-content
                            //- Display mode - full card with description visible
                            .display.augment-display
                                .augment-header-display
                                    span.augment-tier-badge
                                        span T
                                        span.augment-tier-value(name="attr_augment_tier")
                                    span.augment-name-display(name="attr_augment_name")
                                span.augment-desc-display(name="attr_augment_desc")

                            //- Edit mode - full editable form
                            .edit.augment-edit
                                .augment-header-edit
                                    .augment-tier-select
                                        select(name="attr_augment_tier")
                                            option(value="2") T2
                                            option(value="3") T3
                                            option(value="4") T4
                                            option(value="5") T5
                                    input(type="text", name="attr_augment_name", placeholder="Augment Name").augment-name
                                textarea(name="attr_augment_desc", placeholder="Description & effects - what does this augment let you do?").augment-desc

        //- ───────────────────────────────────────────────────────────
        //- SECTION 6: FRIENDS & RIVALS
        //- Framing: Contact cards from playbook
        //- Each playbook has 5 friends; player marks one as Friend, one as Rival
        //- ───────────────────────────────────────────────────────────
        .section.friends
            +section-header-editable("friends", "FRIENDS & RIVALS", "06")

            .friends-intro Mark one ↑ as your Friend, one ↓ as your Rival

            .friends-list
                //- 5 fixed friend slots (populated from playbook data)
                - for (var i = 1; i <= 5; i++)
                    .friend-card
                        //- Relation selector: up arrow (friend), circle (neutral), down arrow (rival)
                        .friend-relation
                            label.relation-option.relation-friend(title="Friend")
                                input(type="radio", name=`attr_friend_${i}_relation`, value="friend")
                                span.relation-badge ↑
                            label.relation-option.relation-neutral(title="Neutral")
                                input(type="radio", name=`attr_friend_${i}_relation`, value="neutral", checked)
                                span.relation-badge ○
                            label.relation-option.relation-rival(title="Rival")
                                input(type="radio", name=`attr_friend_${i}_relation`, value="rival")
                                span.relation-badge ↓

                        //- Display mode - name and description from playbook
                        .friend-display.display
                            span.friend-name(name=`attr_friend_${i}_name`)
                            span.friend-desc(name=`attr_friend_${i}_desc`)

                        //- Edit mode - allow customization
                        .friend-edit.edit
                            input.friend-name-input(type="text", name=`attr_friend_${i}_name`, placeholder="Contact name")
                            input.friend-desc-input(type="text", name=`attr_friend_${i}_desc`, placeholder="Role / description")

    //- ═══════════════════════════════════════════════════════════════
    //- RIGHT COLUMN
    //- ═══════════════════════════════════════════════════════════════
    .right-column

        //- ───────────────────────────────────────────────────────────
        //- SECTION 2: CAPABILITY ASSESSMENT
        //- Framing: Psychometric evaluation / skills matrix
        //- Actions grouped by attribute with integrated XP
        //- ───────────────────────────────────────────────────────────
        .section.actions
            .section-header
                .section-stamp CAPABILITY ASSESSMENT
                .section-number 02

            //- ACUITY Attribute Block
            .attribute-block.acuity
                .attribute-header-row
                    button.attr-name(type="action", name="act_roll_acuity_resist", data-i18n="ACUITY") ACUITY
                    +attribute-track("acuity")
                .action-list
                    +action-row("hack", "HACK")
                    +action-row("recon", "RECON")
                    +action-row("scrutinize", "SCRUTINIZE")
                    +action-row("tamper", "TAMPER")

            //- GRIT Attribute Block
            .attribute-block.grit
                .attribute-header-row
                    button.attr-name(type="action", name="act_roll_grit_resist", data-i18n="GRIT") GRIT
                    +attribute-track("grit")
                .action-list
                    +action-row("brawl", "BRAWL")
                    +action-row("hunt", "HUNT")
                    +action-row("skulk", "SKULK")
                    +action-row("vandalize", "VANDALIZE")

            //- RESOLVE Attribute Block
            .attribute-block.resolve
                .attribute-header-row
                    button.attr-name(type="action", name="act_roll_resolve_resist", data-i18n="RESOLVE") RESOLVE
                    +attribute-track("resolve")
                .action-list
                    +action-row("consort", "CONSORT")
                    +action-row("dominate", "DOMINATE")
                    +action-row("finesse", "FINESSE")
                    +action-row("sway", "SWAY")

            //- Deep Cuts Advancement Clocks
            //- Replaces playbook XP and attribute XP with 4× 6-segment clocks
            .advancement-block
                .advancement-header
                    span.advancement-label ADVANCEMENT
                    span.advancement-hint (mark when you do your XP trigger)
                .xp-trigger-row
                    span.xp-trigger-text(name="attr_xp_trigger")
                .advancement-clocks
                    - for (var c = 1; c <= 4; c++)
                        .adv-clock
                            +fakeradio-track(`adv_clock_${c}`, 6, "adv-segment")
                .advancement-costs
                    .cost-row
                        span.cost-label New Augment/Ability
                        span.cost-value 2 clocks
                    .cost-row
                        span.cost-label Veteran Augment
                        span.cost-value 3 clocks
                    .cost-row
                        span.cost-label Crew Upgrade
                        span.cost-value 1 clock
                    .cost-row
                        span.cost-label Action/Attribute Dot
                        span.cost-value = new rating

        //- ───────────────────────────────────────────────────────────
        //- SECTION 5: EQUIPMENT MANIFEST
        //- Framing: Quartermaster checklist / gear loadout
        //- ───────────────────────────────────────────────────────────
        .section.equipment
            +section-header-editable("equipment", "EQUIPMENT MANIFEST", "05")

            .load-selector
                .load-label(data-i18n="LOAD") LOAD
                .load-options
                    label.load-option
                        input(type="radio", name="attr_load", value="3")
                        span.load-box
                        span(data-i18n="LIGHT") Light (3)
                    label.load-option
                        input(type="radio", name="attr_load", value="5", checked)
                        span.load-box
                        span(data-i18n="NORMAL") Normal (5)
                    label.load-option
                        input(type="radio", name="attr_load", value="6")
                        span.load-box
                        span(data-i18n="HEAVY") Heavy (6)

            .load-tracker
                span.load-current(data-i18n="CURRENT") Current:
                input(type="number", name="attr_load_current", value="0", readonly).load-num
                span /
                input(type="number", name="attr_load_max", value="5", readonly).load-num

            .equipment-columns
                .equipment-column.standard
                    h4(data-i18n="STANDARD_ITEMS") Standard Items
                    +item-checkbox("item_blade", "Blade or club", 1)
                    +item-checkbox("item_pistol", "Pistol", 1)
                    +item-checkbox("item_ammo", "Extra ammo", 1)
                    +item-checkbox("item_armor", "Armor", 2)
                    +item-checkbox("item_heavy", "+Heavy", 3)
                    +item-checkbox("item_tools", "Burglary tools", 1)
                    +item-checkbox("item_climbing", "Climbing gear", 2)
                    +item-checkbox("item_documents", "Documents", 1)

                .equipment-column.playbook
                    h4(data-i18n="PLAYBOOK_ITEMS") Playbook Items
                    +repeating("items")
                        label.item-checkbox
                            //- Checkbox (hidden, controls visual box)
                            input(type="checkbox", name="attr_item_carried", value="1")
                            span.item-box

                            //- Display mode - name and load as text
                            span.display.item-name(name="attr_item_name")
                            span.display.item-load (
                                span(name="attr_item_load")
                                | )

                            //- Edit mode - editable inputs
                            .edit.item-edit
                                input(type="text", name="attr_item_name", placeholder="Item name")
                                input(type="number", name="attr_item_load", value="1", min="0", max="6")

        //- ───────────────────────────────────────────────────────────
        //- SECTION 7: NOTES
        //- Framing: Margin scrawl / personal annotations
        //- ───────────────────────────────────────────────────────────
        .section.notes
            +section-header-editable("notes", "NOTES", "07")

            //- Display mode - read-only text
            span.display.notes-display(name="attr_notes")

            //- Edit mode - textarea
            textarea.edit.notes-area(name="attr_notes", placeholder="Personal notes, background details, mission logs...")
